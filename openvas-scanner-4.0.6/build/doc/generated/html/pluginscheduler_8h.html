<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OpenVAS Scanner: src/pluginscheduler.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_1c445093eb429e71cff849a5afa0a294.html">src</a>
  </div>
</div>
<div class="contents">
<h1>pluginscheduler.h File Reference</h1><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dynsection">
</div>

<p><a href="pluginscheduler_8h_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structscheduler__plugin.html">scheduler_plugin</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structwatch__list.html">watch_list</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structhash.html">hash</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlist.html">list</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplist.html">plist</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structplugins__scheduler__struct.html">plugins_scheduler_struct</a></td></tr>
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pluginscheduler_8h.html#af8e652e00c7282bbced045f3a6df21e6">LAUNCH_DISABLED</a>&nbsp;&nbsp;&nbsp;0</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">States of <a class="el" href="structscheduler__plugin.html">scheduler_plugin</a>.  <a href="#af8e652e00c7282bbced045f3a6df21e6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pluginscheduler_8h.html#a4b235aba53f546569516cf546ce4a4f2">LAUNCH_RUN</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pluginscheduler_8h.html#acecedc546dd6874231d0a3a7b8b2efc1">PLUG_RUNNING</a>&nbsp;&nbsp;&nbsp;((struct <a class="el" href="structscheduler__plugin.html">scheduler_plugin</a>*)0x02)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pluginscheduler_8h.html#aca736cb6b0319a12bbc4c668d6422eee">PLUGIN_STATUS_UNRUN</a>&nbsp;&nbsp;&nbsp;1</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pluginscheduler_8h.html#a38c038dee89b59d1c35b89fa1975d1b8">PLUGIN_STATUS_RUNNING</a>&nbsp;&nbsp;&nbsp;2</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pluginscheduler_8h.html#aaeac17a54597641bba55b1cc58d0d512">PLUGIN_STATUS_DONE</a>&nbsp;&nbsp;&nbsp;3</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pluginscheduler_8h.html#a80c6adef8193e7aff1ea19b90cf0b0d9">PLUGIN_STATUS_DONE_AND_CLEANED</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td colspan="2"><h2>Typedefs</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">typedef struct <br class="typebreak"/>
<a class="el" href="structplugins__scheduler__struct.html">plugins_scheduler_struct</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pluginscheduler_8h.html#a326165b6cfcc8bc1da7b9d354703156f">plugins_scheduler_t</a></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pluginscheduler_8h.html#a56cd3e3e38771e73c520a61321aec65c">plugin_set_running_state</a> (struct <a class="el" href="structscheduler__plugin.html">scheduler_plugin</a> *, int)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structplugins__scheduler__struct.html">plugins_scheduler_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pluginscheduler_8h.html#a047bbec7dd509b89da69e03d2716e808">plugins_scheduler_init</a> (struct arglist *, int, int)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structscheduler__plugin.html">scheduler_plugin</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pluginscheduler_8h.html#a10384fae06ada4c648c98590b2b22f93">plugins_scheduler_next</a> (<a class="el" href="structplugins__scheduler__struct.html">plugins_scheduler_t</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="pluginscheduler_8h.html#ab59be063fcceeec7ca3da44593ebec36">plugins_scheduler_free</a> (<a class="el" href="structplugins__scheduler__struct.html">plugins_scheduler_t</a>)</td></tr>
</table>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="af8e652e00c7282bbced045f3a6df21e6"></a><!-- doxytag: member="pluginscheduler.h::LAUNCH_DISABLED" ref="af8e652e00c7282bbced045f3a6df21e6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LAUNCH_DISABLED&nbsp;&nbsp;&nbsp;0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>States of <a class="el" href="structscheduler__plugin.html">scheduler_plugin</a>. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>Consider creating an enumeration. </dd></dl>

<p>Definition at line <a class="el" href="pluginscheduler_8h_source.html#l00039">39</a> of file <a class="el" href="pluginscheduler_8h_source.html">pluginscheduler.h</a>.</p>

<p>Referenced by <a class="el" href="comm_8c_source.html#l00453">comm_setup_plugins()</a>, <a class="el" href="utils_8c_source.html#l00187">get_active_plugins_number()</a>, <a class="el" href="nasl__plugins_8c_source.html#l00080">nasl_plugin_add()</a>, and <a class="el" href="pluginscheduler_8c_source.html#l00502">plugins_scheduler_init()</a>.</p>

</div>
</div>
<a class="anchor" id="a4b235aba53f546569516cf546ce4a4f2"></a><!-- doxytag: member="pluginscheduler.h::LAUNCH_RUN" ref="a4b235aba53f546569516cf546ce4a4f2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LAUNCH_RUN&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pluginscheduler_8h_source.html#l00040">40</a> of file <a class="el" href="pluginscheduler_8h_source.html">pluginscheduler.h</a>.</p>

<p>Referenced by <a class="el" href="comm_8c_source.html#l00453">comm_setup_plugins()</a>.</p>

</div>
</div>
<a class="anchor" id="acecedc546dd6874231d0a3a7b8b2efc1"></a><!-- doxytag: member="pluginscheduler.h::PLUG_RUNNING" ref="acecedc546dd6874231d0a3a7b8b2efc1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PLUG_RUNNING&nbsp;&nbsp;&nbsp;((struct <a class="el" href="structscheduler__plugin.html">scheduler_plugin</a>*)0x02)</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pluginscheduler_8h_source.html#l00105">105</a> of file <a class="el" href="pluginscheduler_8h_source.html">pluginscheduler.h</a>.</p>

<p>Referenced by <a class="el" href="pluginscheduler_8c_source.html#l00400">plugin_next_unrun_dependencie()</a>, and <a class="el" href="pluginscheduler_8c_source.html#l00629">plugins_scheduler_next()</a>.</p>

</div>
</div>
<a class="anchor" id="aaeac17a54597641bba55b1cc58d0d512"></a><!-- doxytag: member="pluginscheduler.h::PLUGIN_STATUS_DONE" ref="aaeac17a54597641bba55b1cc58d0d512" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PLUGIN_STATUS_DONE&nbsp;&nbsp;&nbsp;3</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pluginscheduler_8h_source.html#l00108">108</a> of file <a class="el" href="pluginscheduler_8h_source.html">pluginscheduler.h</a>.</p>

<p>Referenced by <a class="el" href="pluginscheduler_8c_source.html#l00400">plugin_next_unrun_dependencie()</a>, <a class="el" href="pluginlaunch_8c_source.html#l00441">pluginlaunch_stop()</a>, <a class="el" href="pluginscheduler_8c_source.html#l00629">plugins_scheduler_next()</a>, and <a class="el" href="pluginlaunch_8c_source.html#l00167">process_mgr_sighand_term()</a>.</p>

</div>
</div>
<a class="anchor" id="a80c6adef8193e7aff1ea19b90cf0b0d9"></a><!-- doxytag: member="pluginscheduler.h::PLUGIN_STATUS_DONE_AND_CLEANED" ref="a80c6adef8193e7aff1ea19b90cf0b0d9" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PLUGIN_STATUS_DONE_AND_CLEANED&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pluginscheduler_8h_source.html#l00109">109</a> of file <a class="el" href="pluginscheduler_8h_source.html">pluginscheduler.h</a>.</p>

<p>Referenced by <a class="el" href="pluginscheduler_8c_source.html#l00400">plugin_next_unrun_dependencie()</a>, and <a class="el" href="pluginscheduler_8c_source.html#l00629">plugins_scheduler_next()</a>.</p>

</div>
</div>
<a class="anchor" id="a38c038dee89b59d1c35b89fa1975d1b8"></a><!-- doxytag: member="pluginscheduler.h::PLUGIN_STATUS_RUNNING" ref="a38c038dee89b59d1c35b89fa1975d1b8" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PLUGIN_STATUS_RUNNING&nbsp;&nbsp;&nbsp;2</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pluginscheduler_8h_source.html#l00107">107</a> of file <a class="el" href="pluginscheduler_8h_source.html">pluginscheduler.h</a>.</p>

<p>Referenced by <a class="el" href="pluginscheduler_8c_source.html#l00400">plugin_next_unrun_dependencie()</a>, and <a class="el" href="pluginscheduler_8c_source.html#l00629">plugins_scheduler_next()</a>.</p>

</div>
</div>
<a class="anchor" id="aca736cb6b0319a12bbc4c668d6422eee"></a><!-- doxytag: member="pluginscheduler.h::PLUGIN_STATUS_UNRUN" ref="aca736cb6b0319a12bbc4c668d6422eee" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define PLUGIN_STATUS_UNRUN&nbsp;&nbsp;&nbsp;1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pluginscheduler_8h_source.html#l00106">106</a> of file <a class="el" href="pluginscheduler_8h_source.html">pluginscheduler.h</a>.</p>

<p>Referenced by <a class="el" href="pluginlaunch_8c_source.html#l00473">plugin_launch()</a>, <a class="el" href="pluginscheduler_8c_source.html#l00400">plugin_next_unrun_dependencie()</a>, <a class="el" href="pluginscheduler_8c_source.html#l00502">plugins_scheduler_init()</a>, and <a class="el" href="pluginscheduler_8c_source.html#l00629">plugins_scheduler_next()</a>.</p>

</div>
</div>
<hr/><h2>Typedef Documentation</h2>
<a class="anchor" id="a326165b6cfcc8bc1da7b9d354703156f"></a><!-- doxytag: member="pluginscheduler.h::plugins_scheduler_t" ref="a326165b6cfcc8bc1da7b9d354703156f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structplugins__scheduler__struct.html">plugins_scheduler_struct</a>* <a class="el" href="structplugins__scheduler__struct.html">plugins_scheduler_t</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pluginscheduler_8h_source.html#l00100">100</a> of file <a class="el" href="pluginscheduler_8h_source.html">pluginscheduler.h</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a56cd3e3e38771e73c520a61321aec65c"></a><!-- doxytag: member="pluginscheduler.h::plugin_set_running_state" ref="a56cd3e3e38771e73c520a61321aec65c" args="(struct scheduler_plugin *, int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plugin_set_running_state </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structscheduler__plugin.html">scheduler_plugin</a> *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pluginscheduler_8c_source.html#l00079">79</a> of file <a class="el" href="pluginscheduler_8c_source.html">pluginscheduler.c</a>.</p>

<p>References <a class="el" href="pluginscheduler_8h_source.html#l00044">scheduler_plugin::running_state</a>.</p>

<p>Referenced by <a class="el" href="pluginlaunch_8c_source.html#l00473">plugin_launch()</a>, <a class="el" href="pluginscheduler_8c_source.html#l00400">plugin_next_unrun_dependencie()</a>, <a class="el" href="pluginlaunch_8c_source.html#l00441">pluginlaunch_stop()</a>, <a class="el" href="pluginscheduler_8c_source.html#l00629">plugins_scheduler_next()</a>, and <a class="el" href="pluginlaunch_8c_source.html#l00167">process_mgr_sighand_term()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00080"></a>00080 {
<a name="l00081"></a>00081   <span class="keywordflow">if</span> (plugin == NULL)
<a name="l00082"></a>00082     <span class="keywordflow">return</span>;
<a name="l00083"></a>00083 
<a name="l00084"></a>00084   plugin-&gt;running_state = state;
<a name="l00085"></a>00085 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ab59be063fcceeec7ca3da44593ebec36"></a><!-- doxytag: member="pluginscheduler.h::plugins_scheduler_free" ref="ab59be063fcceeec7ca3da44593ebec36" args="(plugins_scheduler_t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void plugins_scheduler_free </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structplugins__scheduler__struct.html">plugins_scheduler_t</a>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pluginscheduler_8c_source.html#l00773">773</a> of file <a class="el" href="pluginscheduler_8c_source.html">pluginscheduler.c</a>.</p>

<p>References <a class="el" href="pluginscheduler_8h_source.html#l00095">plugins_scheduler_struct::hash</a>, <a class="el" href="pluginscheduler_8h_source.html#l00096">plugins_scheduler_struct::list</a>, and <a class="el" href="pluginscheduler_8c_source.html#l00761">list_destroy()</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l01145">attack_network()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00774"></a>00774 {
<a name="l00775"></a>00775   <span class="keywordtype">int</span> i;
<a name="l00776"></a>00776   hash_destroy (sched-&gt;hash);
<a name="l00777"></a>00777   <span class="keywordflow">for</span> (i = ACT_FIRST; i &lt; ACT_LAST; i++)
<a name="l00778"></a>00778     <a class="code" href="pluginscheduler_8c.html#a643c6e4de6363b980f3642d41a19fe78">list_destroy</a> (sched-&gt;list[i]);
<a name="l00779"></a>00779   efree (&amp;sched);
<a name="l00780"></a>00780 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a047bbec7dd509b89da69e03d2716e808"></a><!-- doxytag: member="pluginscheduler.h::plugins_scheduler_init" ref="a047bbec7dd509b89da69e03d2716e808" args="(struct arglist *, int, int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structplugins__scheduler__struct.html">plugins_scheduler_t</a> plugins_scheduler_init </td>
          <td>(</td>
          <td class="paramtype">struct arglist *&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>: Valgrind reports a possible memleak in the str2arglist usage. </dd></dl>
</p>

<p>Definition at line <a class="el" href="pluginscheduler_8c_source.html#l00502">502</a> of file <a class="el" href="pluginscheduler_8c_source.html">pluginscheduler.c</a>.</p>

<p>References <a class="el" href="pluginscheduler_8h_source.html#l00052">scheduler_plugin::arglist</a>, <a class="el" href="pluginscheduler_8h_source.html#l00045">scheduler_plugin::category</a>, <a class="el" href="pluginscheduler_8h_source.html#l00051">scheduler_plugin::excluded_keys</a>, <a class="el" href="pluginscheduler_8h_source.html#l00095">plugins_scheduler_struct::hash</a>, <a class="el" href="pluginscheduler_8c_source.html#l00067">HASH_MAX</a>, <a class="el" href="pluginscheduler_8h_source.html#l00039">LAUNCH_DISABLED</a>, <a class="el" href="pluginscheduler_8h_source.html#l00096">plugins_scheduler_struct::list</a>, <a class="el" href="pluginscheduler_8h_source.html#l00050">scheduler_plugin::mandatory_keys</a>, <a class="el" href="pluginscheduler_8h_source.html#l00068">hash::name</a>, <a class="el" href="pluginscheduler_8h_source.html#l00079">list::name</a>, <a class="el" href="pluginscheduler_8h_source.html#l00074">hash::next</a>, <a class="el" href="pluginscheduler_8h_source.html#l00081">list::next</a>, <a class="el" href="pluginscheduler_8h_source.html#l00080">list::plugin</a>, <a class="el" href="pluginscheduler_8h_source.html#l00106">PLUGIN_STATUS_UNRUN</a>, <a class="el" href="pluginscheduler_8h_source.html#l00082">list::prev</a>, <a class="el" href="pluginscheduler_8h_source.html#l00049">scheduler_plugin::required_keys</a>, <a class="el" href="pluginscheduler_8h_source.html#l00047">scheduler_plugin::required_ports</a>, <a class="el" href="pluginscheduler_8h_source.html#l00048">scheduler_plugin::required_udp_ports</a>, <a class="el" href="pluginscheduler_8h_source.html#l00044">scheduler_plugin::running_state</a>, and <a class="el" href="pluginscheduler_8h_source.html#l00046">scheduler_plugin::timeout</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l01145">attack_network()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00504"></a>00504 {
<a name="l00505"></a>00505   <a class="code" href="structplugins__scheduler__struct.html">plugins_scheduler_t</a> ret = emalloc (<span class="keyword">sizeof</span> (*ret));
<a name="l00506"></a>00506   <span class="keyword">struct </span>arglist *arg;
<a name="l00507"></a>00507   <span class="keywordtype">int</span> i;
<a name="l00508"></a>00508   <span class="keyword">struct </span><a class="code" href="structhash.html">hash</a> *l;
<a name="l00509"></a>00509 
<a name="l00510"></a>00510   <span class="keywordflow">if</span> (plugins == NULL)
<a name="l00511"></a>00511     {
<a name="l00512"></a>00512       efree (ret);
<a name="l00513"></a>00513       <span class="keywordflow">return</span> NULL;
<a name="l00514"></a>00514     }
<a name="l00515"></a>00515 
<a name="l00516"></a>00516   <span class="comment">/* Fill our lists */</span>
<a name="l00517"></a>00517   ret-&gt;<a class="code" href="structplugins__scheduler__struct.html#a41c25c435ba066ae4943940c61cbdba3">hash</a> = hash_init ();
<a name="l00518"></a>00518   arg = plugins;
<a name="l00519"></a>00519   <span class="keywordflow">while</span> (arg-&gt;next != NULL)
<a name="l00520"></a>00520     {
<a name="l00521"></a>00521       <span class="keyword">struct </span><a class="code" href="structscheduler__plugin.html">scheduler_plugin</a> *<a class="code" href="structscheduler__plugin.html">scheduler_plugin</a>;
<a name="l00522"></a>00522       <span class="keyword">struct </span><a class="code" href="structlist.html">list</a> *dup;
<a name="l00523"></a>00523       <span class="keywordtype">char</span> *oid = (<span class="keywordtype">char</span> *)arg_get_value (arg-&gt;value, <span class="stringliteral">&quot;OID&quot;</span>);
<a name="l00524"></a>00524       <span class="keywordflow">if</span> (! oid) <span class="keywordflow">continue</span>; <span class="comment">// This would be a serious problem as it shouldn&apos;t be</span>
<a name="l00525"></a>00525       nvticache_t *nvticache = (nvticache_t *)arg_get_value (
<a name="l00526"></a>00526         arg_get_value (arg-&gt;value, <span class="stringliteral">&quot;preferences&quot;</span>), <span class="stringliteral">&quot;nvticache&quot;</span>);
<a name="l00527"></a>00527       nvti_t *nvti = (oid == NULL ? NULL : nvticache_get_by_oid (nvticache, oid));
<a name="l00528"></a>00528       <span class="keywordtype">int</span> category = nvti_category (nvti);
<a name="l00529"></a>00529 
<a name="l00530"></a>00530       scheduler_plugin = emalloc (<span class="keyword">sizeof</span> (<span class="keyword">struct</span> scheduler_plugin));
<a name="l00531"></a>00531       scheduler_plugin-&gt;<a class="code" href="structscheduler__plugin.html#a59c91d46136c4a0d21c0f7937515dfff">arglist</a> = arg;
<a name="l00532"></a>00532       scheduler_plugin-&gt;<a class="code" href="structscheduler__plugin.html#ada0afb1fdf8a2e681ff7568225fe803b">running_state</a> = <a class="code" href="pluginscheduler_8h.html#aca736cb6b0319a12bbc4c668d6422eee">PLUGIN_STATUS_UNRUN</a>;
<a name="l00533"></a>00533       scheduler_plugin-&gt;<a class="code" href="structscheduler__plugin.html#a777794ec935070a82a48a56f3c90e94d">category</a> = category;
<a name="l00534"></a>00534       scheduler_plugin-&gt;<a class="code" href="structscheduler__plugin.html#a4ed593441d2c19a2d02909ad108df1a2">timeout</a> = nvti_timeout (nvti);
<a name="l00535"></a>00535 
<a name="l00539"></a>00539       scheduler_plugin-&gt;<a class="code" href="structscheduler__plugin.html#a2012d4e11669f42b4c03c601958c565b">required_ports</a> = str2arglist (nvti_required_ports (nvti));
<a name="l00540"></a>00540       scheduler_plugin-&gt;<a class="code" href="structscheduler__plugin.html#a1bba16c530813d7fdb7bbdfc9ada12c7">required_udp_ports</a> = str2arglist (nvti_required_udp_ports (nvti));
<a name="l00541"></a>00541       scheduler_plugin-&gt;<a class="code" href="structscheduler__plugin.html#a41947d81358b2b598306124027893acd">required_keys</a> = str2arglist (nvti_required_keys (nvti));
<a name="l00542"></a>00542       scheduler_plugin-&gt;<a class="code" href="structscheduler__plugin.html#ad57d2c0ea7d71e10865f8578adc41043">mandatory_keys</a> = str2arglist (nvti_mandatory_keys (nvti));
<a name="l00543"></a>00543       scheduler_plugin-&gt;<a class="code" href="structscheduler__plugin.html#a9e2b7c2c9e9bb660400d168660394a46">excluded_keys</a> = str2arglist (nvti_excluded_keys (nvti));
<a name="l00544"></a>00544 
<a name="l00545"></a>00545       nvti_free (nvti);
<a name="l00546"></a>00546 
<a name="l00547"></a>00547       <span class="keywordflow">if</span> (category &gt; ACT_LAST)
<a name="l00548"></a>00548         category = ACT_LAST;
<a name="l00549"></a>00549       dup = emalloc (<span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structlist.html">list</a>));
<a name="l00550"></a>00550       dup-&gt;<a class="code" href="structlist.html#ae50ae628ef9cb3e3eaa2a2ab9a045e8b">name</a> = scheduler_plugin-&gt;<a class="code" href="structscheduler__plugin.html#a59c91d46136c4a0d21c0f7937515dfff">arglist</a>-&gt;name;
<a name="l00551"></a>00551       dup-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a> = scheduler_plugin;
<a name="l00552"></a>00552       dup-&gt;<a class="code" href="structlist.html#a73a574e77e33196672eccba15cd1b9ec">prev</a> = NULL;
<a name="l00553"></a>00553       dup-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a> = ret-&gt;<a class="code" href="structplugins__scheduler__struct.html#a8a43e1a8fde31daffb8f9d294e8e45c0">list</a>[category];
<a name="l00554"></a>00554       <span class="keywordflow">if</span> (ret-&gt;<a class="code" href="structplugins__scheduler__struct.html#a8a43e1a8fde31daffb8f9d294e8e45c0">list</a>[category] != NULL)
<a name="l00555"></a>00555         ret-&gt;<a class="code" href="structplugins__scheduler__struct.html#a8a43e1a8fde31daffb8f9d294e8e45c0">list</a>[category]-&gt;<a class="code" href="structlist.html#a73a574e77e33196672eccba15cd1b9ec">prev</a> = dup;
<a name="l00556"></a>00556       ret-&gt;<a class="code" href="structplugins__scheduler__struct.html#a8a43e1a8fde31daffb8f9d294e8e45c0">list</a>[category] = dup;
<a name="l00557"></a>00557 
<a name="l00558"></a>00558       hash_add (ret-&gt;<a class="code" href="structplugins__scheduler__struct.html#a41c25c435ba066ae4943940c61cbdba3">hash</a>, arg-&gt;<a class="code" href="structhash.html#af12b22b8b50d209af99ff88aa7646304">name</a>, scheduler_plugin);
<a name="l00559"></a>00559       arg = arg-&gt;next;
<a name="l00560"></a>00560     }
<a name="l00561"></a>00561 
<a name="l00562"></a>00562   <span class="keywordflow">for</span> (i = 0; i &lt; <a class="code" href="pluginscheduler_8c.html#aab1b90f59dc5a2902b083c30abd7ff36">HASH_MAX</a>; i++)
<a name="l00563"></a>00563     {
<a name="l00564"></a>00564       l = &amp;ret-&gt;<a class="code" href="structplugins__scheduler__struct.html#a41c25c435ba066ae4943940c61cbdba3">hash</a>[i];
<a name="l00565"></a>00565       <span class="keywordflow">while</span> (l != NULL)
<a name="l00566"></a>00566         {
<a name="l00567"></a>00567           hash_fill_deps (ret-&gt;<a class="code" href="structplugins__scheduler__struct.html#a41c25c435ba066ae4943940c61cbdba3">hash</a>, l);
<a name="l00568"></a>00568           l = l-&gt;<a class="code" href="structhash.html#a7f2b3b9848204aabd742caaeb79a992f">next</a>;
<a name="l00569"></a>00569         }
<a name="l00570"></a>00570     }
<a name="l00571"></a>00571 
<a name="l00572"></a>00572   <span class="keywordflow">if</span> (autoload != 0)
<a name="l00573"></a>00573     {
<a name="l00574"></a>00574       arg = plugins;
<a name="l00575"></a>00575       <span class="keywordflow">while</span> (arg-&gt;next != NULL)
<a name="l00576"></a>00576         {
<a name="l00577"></a>00577           <span class="comment">/* deps_table is used to prevent circular dependencies. */</span>
<a name="l00578"></a>00578           GHashTable *deps_table;
<a name="l00579"></a>00579 
<a name="l00580"></a>00580           deps_table = g_hash_table_new_full (g_str_hash, g_str_equal, g_free,
<a name="l00581"></a>00581                                               NULL);
<a name="l00582"></a>00582           <span class="keywordflow">if</span> (plug_get_launch (arg-&gt;value) != <a class="code" href="pluginscheduler_8h.html#af8e652e00c7282bbced045f3a6df21e6" title="States of scheduler_plugin.">LAUNCH_DISABLED</a>)
<a name="l00583"></a>00583             enable_plugin_and_dependencies (ret, arg-&gt;value, arg-&gt;name,
<a name="l00584"></a>00584                                             deps_table);
<a name="l00585"></a>00585           arg = arg-&gt;next;
<a name="l00586"></a>00586           g_hash_table_destroy (deps_table);
<a name="l00587"></a>00587         }
<a name="l00588"></a>00588     }
<a name="l00589"></a>00589 
<a name="l00590"></a>00590   <span class="comment">/* Now, remove the plugins that won&apos;t be launched */</span>
<a name="l00591"></a>00591   <span class="keywordflow">for</span> (i = ACT_FIRST; i &lt;= ACT_LAST; i++)
<a name="l00592"></a>00592     {
<a name="l00593"></a>00593       <span class="keyword">struct </span><a class="code" href="structlist.html">list</a> *l = ret-&gt;<a class="code" href="structplugins__scheduler__struct.html#a8a43e1a8fde31daffb8f9d294e8e45c0">list</a>[i];
<a name="l00594"></a>00594       <span class="keywordflow">while</span> (l != NULL)
<a name="l00595"></a>00595         {
<a name="l00596"></a>00596           <span class="keywordflow">if</span> (plug_get_launch (l-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a>-&gt;<a class="code" href="structscheduler__plugin.html#a59c91d46136c4a0d21c0f7937515dfff">arglist</a>-&gt;value) == <a class="code" href="pluginscheduler_8h.html#af8e652e00c7282bbced045f3a6df21e6" title="States of scheduler_plugin.">LAUNCH_DISABLED</a>)
<a name="l00597"></a>00597             {
<a name="l00598"></a>00598               <span class="keyword">struct </span><a class="code" href="structlist.html">list</a> *old = l-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a>;
<a name="l00599"></a>00599 
<a name="l00600"></a>00600               <span class="keywordflow">if</span> (l-&gt;<a class="code" href="structlist.html#a73a574e77e33196672eccba15cd1b9ec">prev</a> != NULL)
<a name="l00601"></a>00601                 l-&gt;<a class="code" href="structlist.html#a73a574e77e33196672eccba15cd1b9ec">prev</a>-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a> = l-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a>;
<a name="l00602"></a>00602               <span class="keywordflow">else</span>
<a name="l00603"></a>00603                 ret-&gt;<a class="code" href="structplugins__scheduler__struct.html#a8a43e1a8fde31daffb8f9d294e8e45c0">list</a>[i] = l-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a>;
<a name="l00604"></a>00604 
<a name="l00605"></a>00605               <span class="keywordflow">if</span> (l-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a> != NULL)
<a name="l00606"></a>00606                 l-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a>-&gt;<a class="code" href="structlist.html#a73a574e77e33196672eccba15cd1b9ec">prev</a> = l-&gt;<a class="code" href="structlist.html#a73a574e77e33196672eccba15cd1b9ec">prev</a>;
<a name="l00607"></a>00607 
<a name="l00608"></a>00608               efree (&amp;l);
<a name="l00609"></a>00609               l = old;
<a name="l00610"></a>00610               <span class="keywordflow">continue</span>;
<a name="l00611"></a>00611             }
<a name="l00612"></a>00612           l = l-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a>;
<a name="l00613"></a>00613         }
<a name="l00614"></a>00614     }
<a name="l00615"></a>00615 
<a name="l00616"></a>00616   <span class="keywordflow">if</span> (only_network)
<a name="l00617"></a>00617     {
<a name="l00618"></a>00618       <span class="keywordflow">for</span> (i = ACT_GATHER_INFO; i &lt;= ACT_LAST; i++)
<a name="l00619"></a>00619         {
<a name="l00620"></a>00620           ret-&gt;<a class="code" href="structplugins__scheduler__struct.html#a8a43e1a8fde31daffb8f9d294e8e45c0">list</a>[i] = NULL;
<a name="l00621"></a>00621         }
<a name="l00622"></a>00622     }
<a name="l00623"></a>00623   <span class="keywordflow">return</span> ret;
<a name="l00624"></a>00624 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a10384fae06ada4c648c98590b2b22f93"></a><!-- doxytag: member="pluginscheduler.h::plugins_scheduler_next" ref="a10384fae06ada4c648c98590b2b22f93" args="(plugins_scheduler_t)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structscheduler__plugin.html">scheduler_plugin</a>* plugins_scheduler_next </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structplugins__scheduler__struct.html">plugins_scheduler_t</a>&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [read]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="pluginscheduler_8c_source.html#l00629">629</a> of file <a class="el" href="pluginscheduler_8c_source.html">pluginscheduler.c</a>.</p>

<p>References <a class="el" href="pluginscheduler_8h_source.html#l00045">scheduler_plugin::category</a>, <a class="el" href="pluginscheduler_8h_source.html#l00072">hash::dependencies_ptr</a>, <a class="el" href="pluginscheduler_8h_source.html#l00096">plugins_scheduler_struct::list</a>, <a class="el" href="pluginscheduler_8h_source.html#l00081">list::next</a>, <a class="el" href="pluginscheduler_8h_source.html#l00053">scheduler_plugin::parent_hash</a>, <a class="el" href="pluginscheduler_8h_source.html#l00105">PLUG_RUNNING</a>, <a class="el" href="pluginscheduler_8h_source.html#l00080">list::plugin</a>, <a class="el" href="pluginscheduler_8c_source.html#l00073">plugin_get_running_state()</a>, <a class="el" href="pluginscheduler_8c_source.html#l00400">plugin_next_unrun_dependencie()</a>, <a class="el" href="pluginscheduler_8c_source.html#l00079">plugin_set_running_state()</a>, <a class="el" href="pluginscheduler_8h_source.html#l00108">PLUGIN_STATUS_DONE</a>, <a class="el" href="pluginscheduler_8h_source.html#l00109">PLUGIN_STATUS_DONE_AND_CLEANED</a>, <a class="el" href="pluginscheduler_8h_source.html#l00107">PLUGIN_STATUS_RUNNING</a>, <a class="el" href="pluginscheduler_8h_source.html#l00106">PLUGIN_STATUS_UNRUN</a>, <a class="el" href="pluginlaunch_8c_source.html#l00428">pluginlaunch_disable_parrallel_checks()</a>, <a class="el" href="pluginlaunch_8c_source.html#l00434">pluginlaunch_enable_parrallel_checks()</a>, <a class="el" href="pluginlaunch_8c_source.html#l00557">pluginlaunch_wait_for_free_process()</a>, <a class="el" href="pluginscheduler_8h_source.html#l00082">list::prev</a>, <a class="el" href="pluginscheduler_8c_source.html#l00331">scheduler_mark_running_ports()</a>, and <a class="el" href="pluginscheduler_8c_source.html#l00361">scheduler_rm_running_ports()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00630"></a>00630 {
<a name="l00631"></a>00631   <span class="keyword">struct </span><a class="code" href="structlist.html">list</a> *l;
<a name="l00632"></a>00632   <span class="keywordtype">int</span> category;
<a name="l00633"></a>00633   <span class="keywordtype">int</span> running_category = ACT_LAST;
<a name="l00634"></a>00634   <span class="keywordtype">int</span> flag = 0;
<a name="l00635"></a>00635 
<a name="l00636"></a>00636   <span class="keywordflow">if</span> (h == NULL)
<a name="l00637"></a>00637     <span class="keywordflow">return</span> NULL;
<a name="l00638"></a>00638 
<a name="l00639"></a>00639   <span class="keywordflow">for</span> (category = ACT_FIRST; category &lt;= ACT_LAST; category++)
<a name="l00640"></a>00640     {
<a name="l00641"></a>00641       l = h-&gt;list[category];
<a name="l00642"></a>00642 
<a name="l00643"></a>00643       <span class="comment">/*</span>
<a name="l00644"></a>00644 <span class="comment">       * Scanners (and DoS) must not be run in parallel</span>
<a name="l00645"></a>00645 <span class="comment">       */</span>
<a name="l00646"></a>00646       <span class="keywordflow">if</span> ((category == ACT_SCANNER) || (category == ACT_KILL_HOST)
<a name="l00647"></a>00647           || (category == ACT_FLOOD) || (category == ACT_DENIAL))
<a name="l00648"></a>00648         <a class="code" href="pluginlaunch_8c.html#a663965b54ec6d1d1e0a3542c1101401f">pluginlaunch_disable_parrallel_checks</a> ();
<a name="l00649"></a>00649       <span class="keywordflow">else</span>
<a name="l00650"></a>00650         <a class="code" href="pluginlaunch_8c.html#aed481b716e1b4a222d0f3f4cbae7d3aa">pluginlaunch_enable_parrallel_checks</a> ();
<a name="l00651"></a>00651 
<a name="l00652"></a>00652       <span class="keywordflow">while</span> (l != NULL)
<a name="l00653"></a>00653         {
<a name="l00654"></a>00654           <span class="keywordtype">int</span> state;
<a name="l00655"></a>00655 
<a name="l00656"></a>00656           state = <a class="code" href="pluginscheduler_8c.html#a1327a8b5ad2cf52ed74f69b0c2ad35da">plugin_get_running_state</a> (l-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a>);
<a name="l00657"></a>00657 
<a name="l00658"></a>00658           <span class="keywordflow">switch</span> (state)
<a name="l00659"></a>00659             {
<a name="l00660"></a>00660             <span class="keywordflow">case</span> <a class="code" href="pluginscheduler_8h.html#aca736cb6b0319a12bbc4c668d6422eee">PLUGIN_STATUS_UNRUN</a>:
<a name="l00661"></a>00661               {
<a name="l00662"></a>00662                 <span class="keyword">struct </span><a class="code" href="structhash.html">hash</a> **deps_ptr =
<a name="l00663"></a>00663                   l-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a>-&gt;<a class="code" href="structscheduler__plugin.html#a272e99837c57ec46da1ab45b0234f877">parent_hash</a>-&gt;<a class="code" href="structhash.html#a91510ec77e4855486dd6b5002df984b6">dependencies_ptr</a>;
<a name="l00664"></a>00664 
<a name="l00665"></a>00665                 <span class="keywordflow">if</span> (deps_ptr != NULL)
<a name="l00666"></a>00666                   {
<a name="l00667"></a>00667                     <span class="keyword">struct </span><a class="code" href="structscheduler__plugin.html">scheduler_plugin</a> *p =
<a name="l00668"></a>00668                       <a class="code" href="pluginscheduler_8c.html#ab8f94ad31e3c0272e1b035cedf241c9c">plugin_next_unrun_dependencie</a> (h, deps_ptr);
<a name="l00669"></a>00669 
<a name="l00670"></a>00670                     <span class="keywordflow">switch</span> (GPOINTER_TO_SIZE (p))
<a name="l00671"></a>00671                       {
<a name="l00672"></a>00672                       <span class="keywordflow">case</span> GPOINTER_TO_SIZE (NULL):
<a name="l00673"></a>00673                         <a class="code" href="pluginscheduler_8c.html#a7052f46503eccd2e8c61edeb9a6f738e">scheduler_mark_running_ports</a> (h, l-&gt;plugin);
<a name="l00674"></a>00674                         <a class="code" href="pluginscheduler_8c.html#a0009aa6c7d451e7c50fd5589dcc5a998">plugin_set_running_state</a> (l-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a>,
<a name="l00675"></a>00675                                                   <a class="code" href="pluginscheduler_8h.html#a38c038dee89b59d1c35b89fa1975d1b8">PLUGIN_STATUS_RUNNING</a>);
<a name="l00676"></a>00676                         <span class="keywordflow">return</span> l-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a>;
<a name="l00677"></a>00677 
<a name="l00678"></a>00678                         <span class="keywordflow">break</span>;
<a name="l00679"></a>00679                       <span class="keywordflow">case</span> GPOINTER_TO_SIZE (<a class="code" href="pluginscheduler_8h.html#acecedc546dd6874231d0a3a7b8b2efc1">PLUG_RUNNING</a>):
<a name="l00680"></a>00680                         {
<a name="l00681"></a>00681                           <span class="comment">/* One of the dependencie is still running  -  we write down its category */</span>
<a name="l00682"></a>00682                           <span class="keywordflow">if</span> (l-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a>-&gt;<a class="code" href="structscheduler__plugin.html#a777794ec935070a82a48a56f3c90e94d">category</a> &lt; running_category)
<a name="l00683"></a>00683                             running_category = l-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a>-&gt;<a class="code" href="structscheduler__plugin.html#a777794ec935070a82a48a56f3c90e94d">category</a>;
<a name="l00684"></a>00684                           flag++;
<a name="l00685"></a>00685                         }
<a name="l00686"></a>00686                         <span class="keywordflow">break</span>;
<a name="l00687"></a>00687                       <span class="keywordflow">default</span>:
<a name="l00688"></a>00688                         {
<a name="l00689"></a>00689                           <span class="comment">/* Launch a dependencie  - don&apos;t pay attention to the type */</span>
<a name="l00690"></a>00690                           <a class="code" href="pluginscheduler_8c.html#a7052f46503eccd2e8c61edeb9a6f738e">scheduler_mark_running_ports</a> (h, p);
<a name="l00691"></a>00691                           <a class="code" href="pluginscheduler_8c.html#a0009aa6c7d451e7c50fd5589dcc5a998">plugin_set_running_state</a> (p, <a class="code" href="pluginscheduler_8h.html#a38c038dee89b59d1c35b89fa1975d1b8">PLUGIN_STATUS_RUNNING</a>);
<a name="l00692"></a>00692                           <span class="keywordflow">return</span> p;
<a name="l00693"></a>00693                         }
<a name="l00694"></a>00694                       }
<a name="l00695"></a>00695                   }
<a name="l00696"></a>00696                 <span class="keywordflow">else</span>            <span class="comment">/* No dependencies */</span>
<a name="l00697"></a>00697                   {
<a name="l00698"></a>00698                     <a class="code" href="pluginscheduler_8c.html#a7052f46503eccd2e8c61edeb9a6f738e">scheduler_mark_running_ports</a> (h, l-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a>);
<a name="l00699"></a>00699                     <a class="code" href="pluginscheduler_8c.html#a0009aa6c7d451e7c50fd5589dcc5a998">plugin_set_running_state</a> (l-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a>, <a class="code" href="pluginscheduler_8h.html#a38c038dee89b59d1c35b89fa1975d1b8">PLUGIN_STATUS_RUNNING</a>);
<a name="l00700"></a>00700                     <span class="keywordflow">return</span> l-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a>;
<a name="l00701"></a>00701                   }
<a name="l00702"></a>00702               }
<a name="l00703"></a>00703               <span class="keywordflow">break</span>;
<a name="l00704"></a>00704             <span class="keywordflow">case</span> <a class="code" href="pluginscheduler_8h.html#a38c038dee89b59d1c35b89fa1975d1b8">PLUGIN_STATUS_RUNNING</a>:
<a name="l00705"></a>00705               {
<a name="l00706"></a>00706                 <span class="keywordflow">if</span> (l-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a>-&gt;<a class="code" href="structscheduler__plugin.html#a777794ec935070a82a48a56f3c90e94d">category</a> &lt; running_category)
<a name="l00707"></a>00707                   running_category = l-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a>-&gt;<a class="code" href="structscheduler__plugin.html#a777794ec935070a82a48a56f3c90e94d">category</a>;
<a name="l00708"></a>00708                 flag++;
<a name="l00709"></a>00709               }
<a name="l00710"></a>00710               <span class="keywordflow">break</span>;
<a name="l00711"></a>00711 
<a name="l00712"></a>00712             <span class="keywordflow">case</span> <a class="code" href="pluginscheduler_8h.html#aaeac17a54597641bba55b1cc58d0d512">PLUGIN_STATUS_DONE</a>:
<a name="l00713"></a>00713               <a class="code" href="pluginscheduler_8c.html#a3b2be4a743db575b34c6bcc8d6ea4a12">scheduler_rm_running_ports</a> (h, l-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a>);
<a name="l00714"></a>00714               <a class="code" href="pluginscheduler_8c.html#a0009aa6c7d451e7c50fd5589dcc5a998">plugin_set_running_state</a> (l-&gt;<a class="code" href="structlist.html#aa44727f25774053498ac12c1a01c4d3a">plugin</a>,
<a name="l00715"></a>00715                                         <a class="code" href="pluginscheduler_8h.html#a80c6adef8193e7aff1ea19b90cf0b0d9">PLUGIN_STATUS_DONE_AND_CLEANED</a>);
<a name="l00716"></a>00716               <span class="comment">/* no break - we remove it right away */</span>
<a name="l00717"></a>00717             <span class="keywordflow">case</span> <a class="code" href="pluginscheduler_8h.html#a80c6adef8193e7aff1ea19b90cf0b0d9">PLUGIN_STATUS_DONE_AND_CLEANED</a>:
<a name="l00718"></a>00718               {
<a name="l00719"></a>00719                 <span class="keyword">struct </span><a class="code" href="structlist.html">list</a> *old = l-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a>;
<a name="l00720"></a>00720 
<a name="l00721"></a>00721                 <span class="keywordflow">if</span> (l-&gt;<a class="code" href="structlist.html#a73a574e77e33196672eccba15cd1b9ec">prev</a> != NULL)
<a name="l00722"></a>00722                   l-&gt;<a class="code" href="structlist.html#a73a574e77e33196672eccba15cd1b9ec">prev</a>-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a> = l-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a>;
<a name="l00723"></a>00723                 <span class="keywordflow">else</span>
<a name="l00724"></a>00724                   h-&gt;list[category] = l-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a>;
<a name="l00725"></a>00725 
<a name="l00726"></a>00726                 <span class="keywordflow">if</span> (l-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a> != NULL)
<a name="l00727"></a>00727                   l-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a>-&gt;<a class="code" href="structlist.html#a73a574e77e33196672eccba15cd1b9ec">prev</a> = l-&gt;<a class="code" href="structlist.html#a73a574e77e33196672eccba15cd1b9ec">prev</a>;
<a name="l00728"></a>00728 
<a name="l00729"></a>00729                 efree (&amp;l);
<a name="l00730"></a>00730                 l = old;
<a name="l00731"></a>00731 
<a name="l00732"></a>00732                 <span class="keywordflow">continue</span>;
<a name="l00733"></a>00733               }
<a name="l00734"></a>00734               <span class="keywordflow">break</span>;
<a name="l00735"></a>00735             }
<a name="l00736"></a>00736           l = l-&gt;<a class="code" href="structlist.html#a1900fe79e875e2838625b2eb60837f8f">next</a>;
<a name="l00737"></a>00737         }
<a name="l00738"></a>00738 
<a name="l00739"></a>00739 
<a name="l00740"></a>00740       <span class="comment">/* Could not find anything */</span>
<a name="l00741"></a>00741       <span class="keywordflow">if</span> ((category == ACT_SCANNER || category == ACT_INIT
<a name="l00742"></a>00742            || category == ACT_SETTINGS) &amp;&amp; flag != 0)
<a name="l00743"></a>00743         {
<a name="l00744"></a>00744           <a class="code" href="pluginlaunch_8c.html#a58c9370449452d4bfbc694686c5f2646" title="Waits and &amp;#39;pushes&amp;#39; processes until the number of running processes has changed...">pluginlaunch_wait_for_free_process</a> ();
<a name="l00745"></a>00745           flag = 0;
<a name="l00746"></a>00746           category--;
<a name="l00747"></a>00747         }
<a name="l00748"></a>00748 
<a name="l00749"></a>00749       <span class="keywordflow">if</span> (category + 1 &gt;= ACT_DENIAL &amp;&amp; flag &amp;&amp; running_category &lt; ACT_DENIAL)
<a name="l00750"></a>00750         {
<a name="l00751"></a>00751           <span class="keywordflow">return</span> <a class="code" href="pluginscheduler_8h.html#acecedc546dd6874231d0a3a7b8b2efc1">PLUG_RUNNING</a>;
<a name="l00752"></a>00752         }
<a name="l00753"></a>00753     }
<a name="l00754"></a>00754 
<a name="l00755"></a>00755 
<a name="l00756"></a>00756   <span class="keywordflow">return</span> flag != 0 ? <a class="code" href="pluginscheduler_8h.html#acecedc546dd6874231d0a3a7b8b2efc1">PLUG_RUNNING</a> : NULL;
<a name="l00757"></a>00757 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 23 Oct 2015 for OpenVAS Scanner by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
