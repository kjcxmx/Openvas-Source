<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OpenVAS Scanner: src/hosts.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_1c445093eb429e71cff849a5afa0a294.html">src</a>
  </div>
</div>
<div class="contents">
<h1>hosts.c File Reference</h1><code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &lt;signal.h&gt;</code><br/>
<code>#include &lt;sys/wait.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;openvas/misc/network.h&gt;</code><br/>
<code>#include &lt;openvas/misc/internal_com.h&gt;</code><br/>
<code>#include &lt;openvas/misc/system.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="utils_8h_source.html">utils.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="log_8h_source.html">log.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="preferences_8h_source.html">preferences.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="hosts_8h_source.html">hosts.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ntp_8h_source.html">ntp.h</a>&quot;</code><br/>
<div class="dynheader">
Include dependency graph for hosts.c:</div>
<div class="dynsection">
</div>

<p><a href="hosts_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structhost.html">host</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Host information, implemented as doubly linked <a class="el" href="structlist.html">list</a>.  <a href="structhost.html#_details">More...</a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hosts_8c.html#a7413f12d00b4b8ca23573d3ab195cf32">hosts_init</a> (int soc, int max_hosts)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hosts_8c.html#a6e08b50d1588bf6e1ab7b12e07ad5bca">hosts_new</a> (struct arglist *globals, char *name)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hosts_8c.html#a96e234b46b5336ef5c238cb3d5c9cd96">hosts_set_pid</a> (char *name, pid_t pid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hosts_8c.html#a47c3825c4cb0c8ceee834d39f0f0d785">hosts_stop_host</a> (char *name)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hosts_8c.html#a335840ff579312c5f8530e4227266064">hosts_stop_all</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hosts_8c.html#a4dfb511e9d48e7403d1647c1cee1b72a">hosts_pause_all</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pause all hosts.  <a href="#a4dfb511e9d48e7403d1647c1cee1b72a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hosts_8c.html#a1b1754a01a119e1111587a66c1a1dbdc">hosts_resume_all</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resume all hosts.  <a href="#a1b1754a01a119e1111587a66c1a1dbdc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="hosts_8c.html#af5191588fd4d428e7b8dbd6c821cd979">hosts_read</a> (struct arglist *globals)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns -1 if client asked to stop all tests or connection was lost or error. 0 otherwise.  <a href="#af5191588fd4d428e7b8dbd6c821cd979"></a><br/></td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a7413f12d00b4b8ca23573d3ab195cf32"></a><!-- doxytag: member="hosts.c::hosts_init" ref="a7413f12d00b4b8ca23573d3ab195cf32" args="(int soc, int max_hosts)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hosts_init </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>soc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>max_hosts</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="hosts_8c_source.html#l00204">204</a> of file <a class="el" href="hosts_8c_source.html">hosts.c</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l01145">attack_network()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00205"></a>00205 {
<a name="l00206"></a>00206   g_soc = soc;
<a name="l00207"></a>00207   g_max_hosts = max_hosts;
<a name="l00208"></a>00208   signal (SIGCHLD, sigchld_handler);
<a name="l00209"></a>00209   <span class="keywordflow">return</span> 0;
<a name="l00210"></a>00210 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a6e08b50d1588bf6e1ab7b12e07ad5bca"></a><!-- doxytag: member="hosts.c::hosts_new" ref="a6e08b50d1588bf6e1ab7b12e07ad5bca" args="(struct arglist *globals, char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hosts_new </td>
          <td>(</td>
          <td class="paramtype">struct arglist *&nbsp;</td>
          <td class="paramname"> <em>globals</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="hosts_8c_source.html#l00213">213</a> of file <a class="el" href="hosts_8c_source.html">hosts.c</a>.</p>

<p>References <a class="el" href="hosts_8c_source.html#l00433">hosts_read()</a>, <a class="el" href="hosts_8c_source.html#l00050">host::name</a>, <a class="el" href="hosts_8c_source.html#l00054">host::next</a>, <a class="el" href="hosts_8c_source.html#l00053">host::pid</a>, <a class="el" href="hosts_8c_source.html#l00055">host::prev</a>, <a class="el" href="hosts_8c_source.html#l00052">host::psoc</a>, and <a class="el" href="hosts_8c_source.html#l00051">host::soc</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l01145">attack_network()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00214"></a>00214 {
<a name="l00215"></a>00215   <span class="keyword">struct </span><a class="code" href="structhost.html" title="Host information, implemented as doubly linked list.">host</a> *h;
<a name="l00216"></a>00216   <span class="keywordtype">int</span> <a class="code" href="structhost.html#adcabb2be51b88fc26244a23b46e1daad">soc</a>[2];
<a name="l00217"></a>00217 
<a name="l00218"></a>00218   <span class="keywordflow">while</span> (hosts_num () &gt;= g_max_hosts)
<a name="l00219"></a>00219     {
<a name="l00220"></a>00220       <span class="keywordflow">if</span> (<a class="code" href="hosts_8c.html#af5191588fd4d428e7b8dbd6c821cd979" title="Returns -1 if client asked to stop all tests or connection was lost or error. 0 otherwise...">hosts_read</a> (globals) &lt; 0)
<a name="l00221"></a>00221         <span class="keywordflow">return</span> -1;
<a name="l00222"></a>00222     }
<a name="l00223"></a>00223 
<a name="l00224"></a>00224   <span class="keywordflow">if</span> (socketpair (AF_UNIX, SOCK_STREAM, 0, soc) &lt; 0)
<a name="l00225"></a>00225     <span class="keywordflow">return</span> -1;
<a name="l00226"></a>00226 
<a name="l00227"></a>00227   h = emalloc (<span class="keyword">sizeof</span> (<span class="keyword">struct</span> <a class="code" href="structhost.html" title="Host information, implemented as doubly linked list.">host</a>));
<a name="l00228"></a>00228   h-&gt;<a class="code" href="structhost.html#ae29a96977a9350ec0d4323ccd38ebc9b">name</a> = estrdup (<a class="code" href="structhost.html#ae29a96977a9350ec0d4323ccd38ebc9b">name</a>);
<a name="l00229"></a>00229   h-&gt;<a class="code" href="structhost.html#a5dc18682cf9cb873f299045b6508bef1">pid</a> = 0;
<a name="l00230"></a>00230   h-&gt;<a class="code" href="structhost.html#adcabb2be51b88fc26244a23b46e1daad">soc</a> = soc[1];
<a name="l00231"></a>00231   h-&gt;<a class="code" href="structhost.html#a909d95952e9fa5214ae0ba7da28d3bc5">psoc</a> = soc[0];
<a name="l00232"></a>00232   <span class="keywordflow">if</span> (hosts != NULL)
<a name="l00233"></a>00233     hosts-&gt;<a class="code" href="structhost.html#a07994995b5f5b56c13edac8b3467bb9d">prev</a> = h;
<a name="l00234"></a>00234   h-&gt;<a class="code" href="structhost.html#a8b3715c80264a12748b7f656f956d769">next</a> = hosts;
<a name="l00235"></a>00235   h-&gt;<a class="code" href="structhost.html#a07994995b5f5b56c13edac8b3467bb9d">prev</a> = NULL;
<a name="l00236"></a>00236   hosts = h;
<a name="l00237"></a>00237   <span class="keywordflow">return</span> soc[0];
<a name="l00238"></a>00238 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a4dfb511e9d48e7403d1647c1cee1b72a"></a><!-- doxytag: member="hosts.c::hosts_pause_all" ref="a4dfb511e9d48e7403d1647c1cee1b72a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hosts_pause_all </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Pause all hosts. </p>

<p>Definition at line <a class="el" href="hosts_8c_source.html#l00287">287</a> of file <a class="el" href="hosts_8c_source.html">hosts.c</a>.</p>

<p>References <a class="el" href="hosts_8c_source.html#l00054">host::next</a>, and <a class="el" href="hosts_8c_source.html#l00053">host::pid</a>.</p>

<p>Referenced by <a class="el" href="ntp_8c_source.html#l00065">ntp_parse_input()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00288"></a>00288 {
<a name="l00289"></a>00289   <span class="keyword">struct </span><a class="code" href="structhost.html" title="Host information, implemented as doubly linked list.">host</a> *<a class="code" href="structhost.html" title="Host information, implemented as doubly linked list.">host</a> = hosts;
<a name="l00290"></a>00290   <span class="keywordflow">while</span> (host != NULL)
<a name="l00291"></a>00291     {
<a name="l00292"></a>00292       kill (host-&gt;<a class="code" href="structhost.html#a5dc18682cf9cb873f299045b6508bef1">pid</a>, SIGUSR1);
<a name="l00293"></a>00293       host = host-&gt;<a class="code" href="structhost.html#a8b3715c80264a12748b7f656f956d769">next</a>;
<a name="l00294"></a>00294     }
<a name="l00295"></a>00295 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="af5191588fd4d428e7b8dbd6c821cd979"></a><!-- doxytag: member="hosts.c::hosts_read" ref="af5191588fd4d428e7b8dbd6c821cd979" args="(struct arglist *globals)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hosts_read </td>
          <td>(</td>
          <td class="paramtype">struct arglist *&nbsp;</td>
          <td class="paramname"> <em>globals</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns -1 if client asked to stop all tests or connection was lost or error. 0 otherwise. </p>

<p>Definition at line <a class="el" href="hosts_8c_source.html#l00433">433</a> of file <a class="el" href="hosts_8c_source.html">hosts.c</a>.</p>

<p>References <a class="el" href="hosts_8c_source.html#l00273">hosts_stop_all()</a>, and <a class="el" href="log_8c_source.html#l00147">log_write()</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l01145">attack_network()</a>, and <a class="el" href="hosts_8c_source.html#l00213">hosts_new()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00434"></a>00434 {
<a name="l00435"></a>00435   <span class="keywordflow">if</span> (hosts_read_client (globals) &lt; 0)
<a name="l00436"></a>00436     {
<a name="l00437"></a>00437       <a class="code" href="hosts_8c.html#a335840ff579312c5f8530e4227266064">hosts_stop_all</a> ();
<a name="l00438"></a>00438       <a class="code" href="log_8c.html#aebd780cf62bc3eed16f852bd30250a3a">log_write</a> (<span class="stringliteral">&quot;Client abruptly closed the communication&quot;</span>);
<a name="l00439"></a>00439       <span class="keywordflow">return</span> -1;
<a name="l00440"></a>00440     }
<a name="l00441"></a>00441 
<a name="l00442"></a>00442   <span class="keywordflow">if</span> (hosts == NULL)
<a name="l00443"></a>00443     <span class="keywordflow">return</span> -1;
<a name="l00444"></a>00444 
<a name="l00445"></a>00445   hosts_read_data ();
<a name="l00446"></a>00446 
<a name="l00447"></a>00447   <span class="keywordflow">return</span> 0;
<a name="l00448"></a>00448 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a1b1754a01a119e1111587a66c1a1dbdc"></a><!-- doxytag: member="hosts.c::hosts_resume_all" ref="a1b1754a01a119e1111587a66c1a1dbdc" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hosts_resume_all </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Resume all hosts. </p>

<p>Definition at line <a class="el" href="hosts_8c_source.html#l00301">301</a> of file <a class="el" href="hosts_8c_source.html">hosts.c</a>.</p>

<p>References <a class="el" href="hosts_8c_source.html#l00054">host::next</a>, and <a class="el" href="hosts_8c_source.html#l00053">host::pid</a>.</p>

<p>Referenced by <a class="el" href="ntp_8c_source.html#l00065">ntp_parse_input()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00302"></a>00302 {
<a name="l00303"></a>00303   <span class="keyword">struct </span><a class="code" href="structhost.html" title="Host information, implemented as doubly linked list.">host</a> *<a class="code" href="structhost.html" title="Host information, implemented as doubly linked list.">host</a> = hosts;
<a name="l00304"></a>00304   <span class="keywordflow">while</span> (host != NULL)
<a name="l00305"></a>00305     {
<a name="l00306"></a>00306       kill (host-&gt;<a class="code" href="structhost.html#a5dc18682cf9cb873f299045b6508bef1">pid</a>, SIGUSR2);
<a name="l00307"></a>00307       host = host-&gt;<a class="code" href="structhost.html#a8b3715c80264a12748b7f656f956d769">next</a>;
<a name="l00308"></a>00308     }
<a name="l00309"></a>00309 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a96e234b46b5336ef5c238cb3d5c9cd96"></a><!-- doxytag: member="hosts.c::hosts_set_pid" ref="a96e234b46b5336ef5c238cb3d5c9cd96" args="(char *name, pid_t pid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hosts_set_pid </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">pid_t&nbsp;</td>
          <td class="paramname"> <em>pid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="hosts_8c_source.html#l00242">242</a> of file <a class="el" href="hosts_8c_source.html">hosts.c</a>.</p>

<p>References <a class="el" href="log_8c_source.html#l00147">log_write()</a>, <a class="el" href="hosts_8c_source.html#l00053">host::pid</a>, and <a class="el" href="hosts_8c_source.html#l00052">host::psoc</a>.</p>

<p>Referenced by <a class="el" href="attack_8c_source.html#l01145">attack_network()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00243"></a>00243 {
<a name="l00244"></a>00244   <span class="keyword">struct </span><a class="code" href="structhost.html" title="Host information, implemented as doubly linked list.">host</a> *h = hosts_get (<a class="code" href="structhost.html#ae29a96977a9350ec0d4323ccd38ebc9b">name</a>);
<a name="l00245"></a>00245   <span class="keywordflow">if</span> (h == NULL)
<a name="l00246"></a>00246     {
<a name="l00247"></a>00247       <a class="code" href="log_8c.html#aebd780cf62bc3eed16f852bd30250a3a">log_write</a> (<span class="stringliteral">&quot;host_set_pid() failed!\n&quot;</span>);
<a name="l00248"></a>00248       <span class="keywordflow">return</span> -1;
<a name="l00249"></a>00249     }
<a name="l00250"></a>00250 
<a name="l00251"></a>00251   h-&gt;<a class="code" href="structhost.html#a5dc18682cf9cb873f299045b6508bef1">pid</a> = <a class="code" href="structhost.html#a5dc18682cf9cb873f299045b6508bef1">pid</a>;
<a name="l00252"></a>00252   close (h-&gt;<a class="code" href="structhost.html#a909d95952e9fa5214ae0ba7da28d3bc5">psoc</a>);              <span class="comment">/* Close the socket used by our son */</span>
<a name="l00253"></a>00253   h-&gt;<a class="code" href="structhost.html#a909d95952e9fa5214ae0ba7da28d3bc5">psoc</a> = 0;
<a name="l00254"></a>00254   <span class="keywordflow">return</span> 0;
<a name="l00255"></a>00255 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a335840ff579312c5f8530e4227266064"></a><!-- doxytag: member="hosts.c::hosts_stop_all" ref="a335840ff579312c5f8530e4227266064" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hosts_stop_all </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="hosts_8c_source.html#l00273">273</a> of file <a class="el" href="hosts_8c_source.html">hosts.c</a>.</p>

<p>References <a class="el" href="hosts_8c_source.html#l00259">hosts_stop_host()</a>, and <a class="el" href="hosts_8c_source.html#l00050">host::name</a>.</p>

<p>Referenced by <a class="el" href="hosts_8c_source.html#l00433">hosts_read()</a>, and <a class="el" href="ntp_8c_source.html#l00065">ntp_parse_input()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00274"></a>00274 {
<a name="l00275"></a>00275   <span class="keywordflow">while</span> (hosts != NULL)
<a name="l00276"></a>00276     {
<a name="l00277"></a>00277       <a class="code" href="hosts_8c.html#a47c3825c4cb0c8ceee834d39f0f0d785">hosts_stop_host</a> (hosts-&gt;<a class="code" href="structhost.html#ae29a96977a9350ec0d4323ccd38ebc9b">name</a>);
<a name="l00278"></a>00278     }
<a name="l00279"></a>00279 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a47c3825c4cb0c8ceee834d39f0f0d785"></a><!-- doxytag: member="hosts.c::hosts_stop_host" ref="a47c3825c4cb0c8ceee834d39f0f0d785" args="(char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int hosts_stop_host </td>
          <td>(</td>
          <td class="paramtype">char *&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="hosts_8c_source.html#l00259">259</a> of file <a class="el" href="hosts_8c_source.html">hosts.c</a>.</p>

<p>References <a class="el" href="hosts_8c_source.html#l00053">host::pid</a>, and <a class="el" href="hosts_8c_source.html#l00051">host::soc</a>.</p>

<p>Referenced by <a class="el" href="hosts_8c_source.html#l00273">hosts_stop_all()</a>, and <a class="el" href="ntp_8c_source.html#l00065">ntp_parse_input()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00260"></a>00260 {
<a name="l00261"></a>00261   <span class="keyword">struct </span><a class="code" href="structhost.html" title="Host information, implemented as doubly linked list.">host</a> *h = hosts_get (<a class="code" href="structhost.html#ae29a96977a9350ec0d4323ccd38ebc9b">name</a>);
<a name="l00262"></a>00262   <span class="keywordflow">if</span> (h == NULL)
<a name="l00263"></a>00263     <span class="keywordflow">return</span> -1;
<a name="l00264"></a>00264 
<a name="l00265"></a>00265   shutdown (h-&gt;<a class="code" href="structhost.html#adcabb2be51b88fc26244a23b46e1daad">soc</a>, 2);
<a name="l00266"></a>00266   kill (h-&gt;<a class="code" href="structhost.html#a5dc18682cf9cb873f299045b6508bef1">pid</a>, SIGTERM);
<a name="l00267"></a>00267   waitpid (h-&gt;<a class="code" href="structhost.html#a5dc18682cf9cb873f299045b6508bef1">pid</a>, NULL, 0);
<a name="l00268"></a>00268   hosts = host_rm (hosts, h);
<a name="l00269"></a>00269   <span class="keywordflow">return</span> 0;
<a name="l00270"></a>00270 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 23 Oct 2015 for OpenVAS Scanner by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
