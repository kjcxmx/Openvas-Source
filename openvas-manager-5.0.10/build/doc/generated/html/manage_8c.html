<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OpenVAS Manager: src/manage.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.6.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs">
    <ul>
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
  <div class="navpath"><a class="el" href="dir_2e42f16cd70e299165562ff45749e93d.html">src</a>
  </div>
</div>
<div class="contents">
<h1>manage.c File Reference</h1>
<p>The OpenVAS Manager management library.  
<a href="#_details">More...</a></p>
<code>#include &quot;<a class="el" href="manage_8h_source.html">manage.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="sql_8h_source.html">sql.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="manage__sql_8h_source.html">manage_sql.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="ovas-mngr-comm_8h_source.html">ovas-mngr-comm.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="tracef_8h_source.html">tracef.h</a>&quot;</code><br/>
<code>#include &lt;assert.h&gt;</code><br/>
<code>#include &lt;ctype.h&gt;</code><br/>
<code>#include &lt;errno.h&gt;</code><br/>
<code>#include &lt;dirent.h&gt;</code><br/>
<code>#include &lt;fcntl.h&gt;</code><br/>
<code>#include &lt;glib.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;locale.h&gt;</code><br/>
<code>#include &lt;stdio.h&gt;</code><br/>
<code>#include &lt;stdlib.h&gt;</code><br/>
<code>#include &lt;string.h&gt;</code><br/>
<code>#include &lt;strings.h&gt;</code><br/>
<code>#include &lt;sys/stat.h&gt;</code><br/>
<code>#include &lt;sys/types.h&gt;</code><br/>
<code>#include &lt;sys/wait.h&gt;</code><br/>
<code>#include &lt;time.h&gt;</code><br/>
<code>#include &lt;unistd.h&gt;</code><br/>
<code>#include &lt;openvas/base/openvas_string.h&gt;</code><br/>
<code>#include &lt;openvas/omp/omp.h&gt;</code><br/>
<code>#include &lt;openvas/misc/openvas_server.h&gt;</code><br/>
<code>#include &lt;openvas/misc/nvt_categories.h&gt;</code><br/>
<code>#include &lt;openvas/misc/openvas_uuid.h&gt;</code><br/>
<div class="dynheader">
Include dependency graph for manage.c:</div>
<div class="dynsection">
</div>

<p><a href="manage_8c_source.html">Go to the source code of this file.</a></p>
<table border="0" cellpadding="0" cellspacing="0">
<tr><td colspan="2"><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a78c99ffd76a7bb3c8c74db76207e9ab4">_XOPEN_SOURCE</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a1810a09af583816ca6b4ccf01ae848f7">G_LOG_DOMAIN</a>&nbsp;&nbsp;&nbsp;&quot;md manage&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">GLib log domain.  <a href="#a1810a09af583816ca6b4ccf01ae848f7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ad5aa949d6f37d98f569e82752bdfac74">CPE_GETBYNAME_XSL</a>&nbsp;&nbsp;&nbsp;SCAP_RES_DIR &quot;/cpe_getbyname.xsl&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">CPE selection stylesheet location.  <a href="#ad5aa949d6f37d98f569e82752bdfac74"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#af7a8b4a77cbff90ef63f261c6281eba6">CVE_GETBYNAME_XSL</a>&nbsp;&nbsp;&nbsp;SCAP_RES_DIR &quot;/cve_getbyname.xsl&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">CVE selection stylesheet location.  <a href="#af7a8b4a77cbff90ef63f261c6281eba6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a3d9ac0eebf166f2e60a60b4e4ff86393">OVALDEF_GETBYNAME_XSL</a>&nbsp;&nbsp;&nbsp;SCAP_RES_DIR &quot;/ovaldef_getbyname.xsl&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">OVALDEF selection stylesheet location.  <a href="#a3d9ac0eebf166f2e60a60b4e4ff86393"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#aeabba2575a41385027b6e379f3dbb712">DFN_CERT_ADV_GETBYNAME_XSL</a>&nbsp;&nbsp;&nbsp;CERT_RES_DIR &quot;/dfn_cert_getbyname.xsl&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">DFN_CERT_ADV selection stylesheet location.  <a href="#aeabba2575a41385027b6e379f3dbb712"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#abe0bf315a8d20f43a913bb2f8734dffa">CPE_DICT_FILENAME</a>&nbsp;&nbsp;&nbsp;SCAP_DATA_DIR &quot;/official-cpe-dictionary_v2.2.xml&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">CPE dictionary location.  <a href="#abe0bf315a8d20f43a913bb2f8734dffa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a53fa8b306e67607ae3149702bc9912ea">CVE_FILENAME_FMT</a>&nbsp;&nbsp;&nbsp;SCAP_DATA_DIR &quot;/nvdcve-2.0-%d.xml&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">CVE data files location format string.  <a href="#a53fa8b306e67607ae3149702bc9912ea"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#af7f2e0eb7ca156e42b05b3ee1625496e">DFN_CERT_ADV_FILENAME_FMT</a>&nbsp;&nbsp;&nbsp;CERT_DATA_DIR &quot;/dfn-cert-%04d.xml&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">DFN-CERT data files location format string.  <a href="#af7f2e0eb7ca156e42b05b3ee1625496e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a6829ef55fec66a0b53ff57cbfab63b8d">SCAP_TIMESTAMP_FILENAME</a>&nbsp;&nbsp;&nbsp;SCAP_DATA_DIR &quot;/timestamp&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">SCAP timestamp location.  <a href="#a6829ef55fec66a0b53ff57cbfab63b8d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a5f29c7a2f0601dd34b481375d6645d96">CERT_TIMESTAMP_FILENAME</a>&nbsp;&nbsp;&nbsp;CERT_DATA_DIR &quot;/timestamp&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">CERT timestamp location.  <a href="#a5f29c7a2f0601dd34b481375d6645d96"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ad86f058e7e83daa79168f4a2e21cf771">MAX_CHECKS_DEFAULT</a>&nbsp;&nbsp;&nbsp;&quot;4&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default for Scanner max_checks preference.  <a href="#ad86f058e7e83daa79168f4a2e21cf771"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a7e3bd54f9e039bd4b7f8084be09116a5">MAX_HOSTS_DEFAULT</a>&nbsp;&nbsp;&nbsp;&quot;20&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default for Scanner max_hosts preference.  <a href="#a7e3bd54f9e039bd4b7f8084be09116a5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a7c415f3910ecba64f28a551e5063de6b">ZERO_SEVERITY_INDEX</a>&nbsp;&nbsp;&nbsp;4</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a0b6a3f0e2281112fa8f4cc5d0491157c">RUN_SLAVE_TASK_SLEEP_SECONDS</a>&nbsp;&nbsp;&nbsp;25</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Number of seconds to sleep between polls to slave.  <a href="#a0b6a3f0e2281112fa8f4cc5d0491157c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ab0d87e07831e7e4943caef187872123e">COMMAND</a>&nbsp;&nbsp;&nbsp;&quot;openvasmr 0 titles&quot;</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Command called by get_system_report_types.  <a href="#ab0d87e07831e7e4943caef187872123e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#af6e390f828fc5640de75627d993a623e">FALLBACK_SYSTEM_REPORT_HEADER</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Header for fallback system report.  <a href="#af6e390f828fc5640de75627d993a623e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a14992bf8bee7c290dd716d865c47ae42">DEF</a>(x)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Define a code snippet for get_nvti_xml.  <a href="#a14992bf8bee7c290dd716d865c47ae42"></a><br/></td></tr>
<tr><td colspan="2"><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a3025e3f96eee294cc832e2be0629cb86">threat_message_type</a> (const char *threat)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the message type of a threat.  <a href="#a3025e3f96eee294cc832e2be0629cb86"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a66adb3baa17b97367ce9e3db83c15f37">message_type_threat</a> (const char *type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the threat of a message type.  <a href="#a66adb3baa17b97367ce9e3db83c15f37"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a866a1eadfc6d61cbec217a99bcf59a8c">severity_in_level</a> (double severity, const char *level)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check whether a severity falls within a threat level.  <a href="#a866a1eadfc6d61cbec217a99bcf59a8c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ab10de498a6cf575c242ac2e96b8c3cc5">level_min_severity</a> (const char *level, const gchar *class)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the minimum severity for a severity level and class.  <a href="#ab10de498a6cf575c242ac2e96b8c3cc5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a944bb9ece423240e59690aa700f35845">level_max_severity</a> (const char *level, const gchar *class)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the minimum severity for a severity level and class.  <a href="#a944bb9ece423240e59690aa700f35845"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a54b9ae46bf85a6d47ffd7da4a970ac79">severity_matches_type</a> (double severity, const char *type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check whether a severity matches a message type.  <a href="#a54b9ae46bf85a6d47ffd7da4a970ac79"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a1bebf56dccfcb24db071cee1ce6616fc">severity_matches_ov</a> (double severity, double ov_severity)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check whether a severity matches an override's severity.  <a href="#a1bebf56dccfcb24db071cee1ce6616fc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a9d6184775d3a4c03153ff143c3dd92fc">severity_to_level</a> (double severity, int mode)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the threat level matching a severity score.  <a href="#a9d6184775d3a4c03153ff143c3dd92fc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ad88f5b1cdc66952af48fb4f3d43260f9">severity_to_type</a> (double severity)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the message type matching a severity score.  <a href="#ad88f5b1cdc66952af48fb4f3d43260f9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ade0e864e3b072af900232a13f5ae8d3e">delete_reports</a> (<a class="el" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a> task)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delete all the reports for a task.  <a href="#ade0e864e3b072af900232a13f5ae8d3e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ad30783278158eec63de2c1ba5a8eebda">manage_result_type_threat</a> (const char *type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the threat associated with a result type.  <a href="#ad30783278158eec63de2c1ba5a8eebda"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ac77914453335560ec3ce361eea01aaba">severity_data_index</a> (double severity)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert a severity value into an index in the counts array.  <a href="#ac77914453335560ec3ce361eea01aaba"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a30a93f1f17b47c6d2607c35b34fc5093">severity_data_value</a> (int index)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Convert an index in the counts array to a severity value.  <a href="#a30a93f1f17b47c6d2607c35b34fc5093"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#acb2679535c63506b5f7890afb4f455ae">init_severity_data</a> (<a class="el" href="structseverity__data__t.html">severity_data_t</a> *data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialize a severity data structure.  <a href="#acb2679535c63506b5f7890afb4f455ae"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ab34995fe7b61c71b10f1943d18ee2ff7">cleanup_severity_data</a> (<a class="el" href="structseverity__data__t.html">severity_data_t</a> *data)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clean up a severity data structure.  <a href="#ab34995fe7b61c71b10f1943d18ee2ff7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a6e9c4ce80d279c9c1166456a28f70f10">severity_data_add</a> (<a class="el" href="structseverity__data__t.html">severity_data_t</a> *severity_data, double severity)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a severity occurence to the counts of a <a class="el" href="structseverity__data__t.html">severity_data_t</a>.  <a href="#a6e9c4ce80d279c9c1166456a28f70f10"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#adcf0703cc28d8a982332adf6f0f1b206">severity_data_add_count</a> (<a class="el" href="structseverity__data__t.html">severity_data_t</a> *severity_data, double severity, int count)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Add a multiple severity occurences to the counts of a <a class="el" href="structseverity__data__t.html">severity_data_t</a>.  <a href="#adcf0703cc28d8a982332adf6f0f1b206"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a7cdfefbfa5c806c959d26a8b87c13c66">severity_data_range_count</a> (const <a class="el" href="structseverity__data__t.html">severity_data_t</a> *severity_data, double min_severity, double max_severity)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate the total of severity counts in a range.  <a href="#a7cdfefbfa5c806c959d26a8b87c13c66"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a5eed77b72694d0371fa8f6480ad0a6f0">severity_data_level_counts</a> (const <a class="el" href="structseverity__data__t.html">severity_data_t</a> *severity_data, const gchar *severity_class, int *errors, int *debugs, int *false_positives, int *logs, int *lows, int *mediums, int *highs)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Count the occurrences of severities in the levels.  <a href="#a5eed77b72694d0371fa8f6480ad0a6f0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#aaf325a9591faa1e5f2c891946aabfdc4">alert_condition_name</a> (<a class="el" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71d">alert_condition_t</a> condition)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the name of an alert condition.  <a href="#aaf325a9591faa1e5f2c891946aabfdc4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a5bfdf19a40b56addb2b0d9cf061d6f17">event_name</a> (<a class="el" href="manage_8h.html#a2fb9b58e4e5f14f40af8b4a1425841f8">event_t</a> event)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the name of an alert event.  <a href="#a5bfdf19a40b56addb2b0d9cf061d6f17"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gchar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ab0857e60d922fc8f0e93e77e05f2739a">alert_condition_description</a> (<a class="el" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71d">alert_condition_t</a> condition, <a class="el" href="manage_8h.html#ab8f49b57d1efa085106917a33ea8993c">alert_t</a> alert)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a description of an alert condition.  <a href="#ab0857e60d922fc8f0e93e77e05f2739a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gchar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#aef51ca9de1b1ef35454f451584de9df3">event_description</a> (<a class="el" href="manage_8h.html#a2fb9b58e4e5f14f40af8b4a1425841f8">event_t</a> event, const void *event_data, const char *task_name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a description of an alert event.  <a href="#aef51ca9de1b1ef35454f451584de9df3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a56441bd475c89375dd71bb34750f6b31">alert_method_name</a> (<a class="el" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dc">alert_method_t</a> method)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the name of an alert method.  <a href="#a56441bd475c89375dd71bb34750f6b31"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71d">alert_condition_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a8b5128bc5d3c2280e35793b23dfdb5e7">alert_condition_from_name</a> (const char *name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get an alert condition from a name.  <a href="#a8b5128bc5d3c2280e35793b23dfdb5e7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="manage_8h.html#a2fb9b58e4e5f14f40af8b4a1425841f8">event_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a7ce585eed4a3949bb5d225e3387fbd28">event_from_name</a> (const char *name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get an event from a name.  <a href="#a7ce585eed4a3949bb5d225e3387fbd28"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dc">alert_method_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a82a0807b99c0dfdc0e377b3562c348d9">alert_method_from_name</a> (const char *name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get an alert method from a name.  <a href="#a82a0807b99c0dfdc0e377b3562c348d9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a8fd61b9a4fc00435cccfc0a13dba3378">run_status_name</a> (<a class="el" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65">task_status_t</a> status)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the name of a run status.  <a href="#a8fd61b9a4fc00435cccfc0a13dba3378"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a7aa3fd189aa1f5d634dff8fd4ed526d6">run_status_name_internal</a> (<a class="el" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65">task_status_t</a> status)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the unique name of a run status.  <a href="#a7aa3fd189aa1f5d634dff8fd4ed526d6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ae6f33f854d5742a72848fca30dc68ed7">task_run_status_name</a> (<a class="el" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a> task)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the name of the status of a task.  <a href="#ae6f33f854d5742a72848fca30dc68ed7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a4177e98f768a761e753eaf016926a511">rc_preference</a> (const char *desc, const char *name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return a preference from an RC.  <a href="#a4177e98f768a761e753eaf016926a511"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ad162ca53e5660127a25bf3d01fed8f62">slist_free</a> (GSList *list)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Free an slist of pointers, including the pointers.  <a href="#ad162ca53e5660127a25bf3d01fed8f62"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ada9c01647f06bfa0d9c95fff5cb3cc7b">update_slave_progress</a> (entity_t get_tasks)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Update the locally cached task progress from the slave.  <a href="#ada9c01647f06bfa0d9c95fff5cb3cc7b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a08629059dbccb26c5e10d44ef08e9b58">slave_authenticate</a> (gnutls_session_t *session, <a class="el" href="manage_8h.html#a0a96f61bb2eb4c7ea77e2a88dc34fec5">slave_t</a> slave)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Authenticate with a slave.  <a href="#a08629059dbccb26c5e10d44ef08e9b58"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a1b50d91884982550b4483e02f6f044ae">buffer_config_preference_xml</a> (GString *, <a class="el" href="structiterator__t.html">iterator_t</a> *, <a class="el" href="manage_8h.html#a02ae852d74ff91bf9a6884d76e2a5902">config_t</a>, int)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Buffer XML for the NVT preference of a config.  <a href="#a1b50d91884982550b4483e02f6f044ae"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a6d207b7a94d8a3346afd34a4ba99a5d0">start_task</a> (const char *task_id, char **report_id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Start a task.  <a href="#a6d207b7a94d8a3346afd34a4ba99a5d0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#aa652f44f6165e1ecbaa2aef72aec3842">stop_task_internal</a> (<a class="el" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a> task)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initiate stopping a task.  <a href="#aa652f44f6165e1ecbaa2aef72aec3842"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a4662ba38f27cc9cd636ec67dda59e256">stop_task</a> (const char *task_id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initiate stopping a task.  <a href="#a4662ba38f27cc9cd636ec67dda59e256"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#aa4623de8fbd13a0ea5818a68b59774d1">pause_task</a> (const char *task_id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initiate pausing of a task.  <a href="#aa4623de8fbd13a0ea5818a68b59774d1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a47934e18995a389f8186527ccb09745a">resume_paused_task</a> (const char *task_id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initiate resuming of a task.  <a href="#a47934e18995a389f8186527ccb09745a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a5913ba5511f7c1b97b81a5e3ec243412">resume_stopped_task</a> (const char *task_id, char **report_id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resume a stopped task.  <a href="#a5913ba5511f7c1b97b81a5e3ec243412"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a9533a90e24d2872b28730986918e3fb4">resume_or_start_task</a> (const char *task_id, char **report_id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Resume task if stopped, else start task.  <a href="#a9533a90e24d2872b28730986918e3fb4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a735c8af35e7e379adbda1ae032539f99">acknowledge_bye</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Acknowledge a scanner BYE.  <a href="#a735c8af35e7e379adbda1ae032539f99"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ae323fba6e7a66561706b51ada4ff02c6">acknowledge_feed_version_info</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Acknowledge scanner PLUGINS_FEED_VERSION message,.  <a href="#ae323fba6e7a66561706b51ada4ff02c6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a93e1ef57551afa3b68967a82fd0942e9">manage_check_current_task</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Handle state changes to current task made by other processes.  <a href="#a93e1ef57551afa3b68967a82fd0942e9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a20ff3e739f68ff3a7ed4767335a06bb5">init_system_report_type_iterator</a> (<a class="el" href="structreport__type__iterator__t.html">report_type_iterator_t</a> *iterator, const char *type, const char *slave_id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise a system report type iterator.  <a href="#a20ff3e739f68ff3a7ed4767335a06bb5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a1acdc1f56b78c222844efebb1860b2f2">cleanup_report_type_iterator</a> (<a class="el" href="structreport__type__iterator__t.html">report_type_iterator_t</a> *iterator)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Cleanup a report type iterator.  <a href="#a1acdc1f56b78c222844efebb1860b2f2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a83cda8461bc3072ba25435729d665de4">next_report_type</a> (<a class="el" href="structreport__type__iterator__t.html">report_type_iterator_t</a> *iterator)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Increment a report type iterator.  <a href="#a83cda8461bc3072ba25435729d665de4"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a22e0436f979225a5317232910991c5ce">report_type_iterator_name</a> (<a class="el" href="structreport__type__iterator__t.html">report_type_iterator_t</a> *iterator)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the name from a report type iterator.  <a href="#a22e0436f979225a5317232910991c5ce"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a99c82539e8e835517df4a830c3f090e9">report_type_iterator_title</a> (<a class="el" href="structreport__type__iterator__t.html">report_type_iterator_t</a> *iterator)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the title from a report type iterator.  <a href="#a99c82539e8e835517df4a830c3f090e9"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a75d60659cab32889f30876e3e53e88bc">manage_system_report</a> (const char *name, const char *duration, const char *slave_id, char **report)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a system report.  <a href="#a75d60659cab32889f30876e3e53e88bc"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">time_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a9b642d8002942f0f0b8fb3cb3d3937b7">next_time</a> (time_t first, int period, int period_months)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Calculate the next time from now given a start time and a period.  <a href="#a9b642d8002942f0f0b8fb3cb3d3937b7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a5c55390b2f09d5d1c137acf24d098437">manage_auth_allow_all</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Ensure that any subsequent authentications succeed.  <a href="#a5c55390b2f09d5d1c137acf24d098437"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gchar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#aed6b0e3f3bc36931c867a29672b2b3f8">get_scheduled_user_uuid</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Access UUID of user that scheduled the current task.  <a href="#aed6b0e3f3bc36931c867a29672b2b3f8"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a867d27509c4c78a259fd4bbf4dc49804">set_scheduled_user_uuid</a> (gchar *user_uuid)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set UUID of user that scheduled the current task.  <a href="#a867d27509c4c78a259fd4bbf4dc49804"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a4855b1e67b70882496413511bcd2426e">reschedule_task</a> (const gchar *task_id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Set a task's schedule so that it runs again next scheduling round.  <a href="#a4855b1e67b70882496413511bcd2426e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a9096e0134ed78f75befe1b1ba2690743">manage_schedule</a> (int(*fork_connection)(int *, gnutls_session_t *, gnutls_certificate_credentials_t *, gchar *), gboolean run_tasks)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Schedule any actions that are due.  <a href="#a9096e0134ed78f75befe1b1ba2690743"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a64375f2483bd69cd05553ac74758307d">report_format_param_type_name</a> (<a class="el" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12aff">report_format_param_type_t</a> type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get the name of a report format param type.  <a href="#a64375f2483bd69cd05553ac74758307d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12aff">report_format_param_type_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a5f097d2cdfebc96b171bec3eb0217766">report_format_param_type_from_name</a> (const char *name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Get a report format param type from a name.  <a href="#a5f097d2cdfebc96b171bec3eb0217766"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a3cb493dddb2f401e0962224ff259bbaf">init_report_format_file_iterator</a> (<a class="el" href="structfile__iterator__t.html">file_iterator_t</a> *iterator, <a class="el" href="manage_8h.html#a15b08a0a17397f430e91bf9ce570e92d">report_format_t</a> report_format)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Initialise a report format file iterator.  <a href="#a3cb493dddb2f401e0962224ff259bbaf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a635952c4c372571bcbf1b6401d5ab7b2">cleanup_file_iterator</a> (<a class="el" href="structfile__iterator__t.html">file_iterator_t</a> *iterator)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Cleanup a report type iterator.  <a href="#a635952c4c372571bcbf1b6401d5ab7b2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#af79592f2381960eb3644312fcc345600">next_file</a> (<a class="el" href="structfile__iterator__t.html">file_iterator_t</a> *iterator)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Increment a report type iterator.  <a href="#af79592f2381960eb3644312fcc345600"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a8c523f7882cbf51169bebd7fb7929fa6">file_iterator_name</a> (<a class="el" href="structfile__iterator__t.html">file_iterator_t</a> *iterator)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the name from a file iterator.  <a href="#a8c523f7882cbf51169bebd7fb7929fa6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gchar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a7ad302d9d83e31ca46b00b8c20646879">file_iterator_content_64</a> (<a class="el" href="structfile__iterator__t.html">file_iterator_t</a> *iterator)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Return the file contents from a file iterator.  <a href="#a7ad302d9d83e31ca46b00b8c20646879"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a4a67fcc3149b754284506a48c427f9f5">parse_tags</a> (const char *scanner_tags, gchar **tags, gchar **cvss_base, gchar **risk_factor)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Split up the tags received from the scanner.  <a href="#a4a67fcc3149b754284506a48c427f9f5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ab86f5e2d35356f1929d5c30927c939e5">delete_slave_task</a> (<a class="el" href="manage_8h.html#a0a96f61bb2eb4c7ea77e2a88dc34fec5">slave_t</a> slave, const char *<a class="el" href="manage_8c.html#a8d6c21512d60b5170ea6483bc993f197">slave_task_uuid</a>)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Delete a task on a slave.  <a href="#ab86f5e2d35356f1929d5c30927c939e5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#af1ac2781e324e32407594cd91d4c8350">valid_db_resource_type</a> (const char *type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Check whether a resource type table name is valid.  <a href="#af1ac2781e324e32407594cd91d4c8350"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gchar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#af59809e7b86df3c35af37cb4bad3d7a1">xsl_transform</a> (gchar *stylesheet, gchar *xmlfile, gchar **param_names, gchar **param_values)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Run xsltproc in an external process.  <a href="#af59809e7b86df3c35af37cb4bad3d7a1"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gchar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ad5caf732b373ede69a1717662e040cb7">get_nvti_xml</a> (<a class="el" href="structiterator__t.html">iterator_t</a> *nvts, int details, int pref_count, const char *timeout, int close_tag)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Create and return XML description for an NVT.  <a href="#ad5caf732b373ede69a1717662e040cb7"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a96e51a91a2564436e25f4390402c4e84">manage_scap_update_time</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">GET SCAP update time, as a string.  <a href="#a96e51a91a2564436e25f4390402c4e84"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#afbf958b43fd488180af68dd827f4d427">manage_read_info</a> (gchar *type, gchar *uid, gchar *name, gchar **result)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Read raw information.  <a href="#afbf958b43fd488180af68dd827f4d427"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gchar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a1842b60bcb15f207748a920ac42d4f57">keyfile_to_auth_conf_settings_xml</a> (const gchar *filename)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Produce a stripped-down xml representation of a keyfile.  <a href="#a1842b60bcb15f207748a920ac42d4f57"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a8ef3b399e7a5cc5c05675b02e24df018">validate_username</a> (const gchar *name)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Validates a username.  <a href="#a8ef3b399e7a5cc5c05675b02e24df018"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ac3293f4c788610ea413627459d26ed7a">openvas_sync_script_perform_selftest</a> (const gchar *sync_script, gchar **result)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Request a feed synchronization script selftest.  <a href="#ac3293f4c788610ea413627459d26ed7a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ab7aa1701e03a8578fa8e80f8f8eefdfa">openvas_get_sync_script_identification</a> (const gchar *sync_script, gchar **identification, int feed_type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieves the ID string of a feed sync script, with basic validation.  <a href="#ab7aa1701e03a8578fa8e80f8f8eefdfa"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a9c689855cdd11bbca15deaed4afe1208">openvas_get_sync_script_description</a> (const gchar *sync_script, gchar **description)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieves description of a feed sync script, with basic validation.  <a href="#a9c689855cdd11bbca15deaed4afe1208"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gboolean&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a8515ab3691396e6faca41b210490d31e">openvas_get_sync_script_feed_version</a> (const gchar *sync_script, gchar **feed_version)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Retrieves the version of a feed handled by the sync, with basic validation.  <a href="#a8515ab3691396e6faca41b210490d31e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a55bfda01381e5d1a0eadfb863ca1df1c">openvas_sync_feed</a> (const gchar *sync_script, const gchar *current_user, int feed_type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Forks a child to synchronize the local feed collection.  <a href="#a55bfda01381e5d1a0eadfb863ca1df1c"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ae0fa5c3311b9864d36373726eae9ba6a">openvas_migrate_secinfo</a> (const gchar *sync_script, int feed_type)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Migrates SCAP or CERT database, waiting until migration terminates.  <a href="#ae0fa5c3311b9864d36373726eae9ba6a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ae8b0f2cd415f9029da6b7881bf6ac041">openvas_current_sync</a> (const gchar *sync_script, gchar **timestamp, gchar **user)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Determine if the administrator is synchronizing with a feed.  <a href="#ae8b0f2cd415f9029da6b7881bf6ac041"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#af5602486a83c63f12b4a959e1e8eece1">manage_run_wizard</a> (const gchar *name, int(*run_command)(void *, gchar *, gchar **), void *run_command_data, array_t *params, int read_only, const char *mode, gchar **command_error, gchar **ret_response)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Run a wizard.  <a href="#af5602486a83c63f12b4a959e1e8eece1"></a><br/></td></tr>
<tr><td colspan="2"><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">credentials_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a9478db576484bc00cfe65a5bed1961ab">current_credentials</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Current credentials during any OMP command.  <a href="#a9478db576484bc00cfe65a5bed1961ab"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">short&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#afa812d6ddd8794083a9964ae2293b2d3">scanner_up</a> = 1</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Scanner available flag.  <a href="#afa812d6ddd8794083a9964ae2293b2d3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">short&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#af56db24d7b4cc9e627147fa20fac296d">scanner_active</a> = 0</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Scanner active flag.  <a href="#af56db24d7b4cc9e627147fa20fac296d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a448b7803b3f0a72e88d11cece0fc8aa6">current_scanner_task</a> = (<a class="el" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a>) 0</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The task currently running on the scanner.  <a href="#a448b7803b3f0a72e88d11cece0fc8aa6"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="manage_8h.html#a46acf9d556c9f1756609957571bc90f3">report_t</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ae77b32701fcfee18e020fa799bc8f026">current_report</a> = (<a class="el" href="manage_8h.html#a46acf9d556c9f1756609957571bc90f3">report_t</a>) 0</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">The report of the current task.  <a href="#ae77b32701fcfee18e020fa799bc8f026"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gchar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#aca34079d27544a760cb51adfcdc47190">slave_ssh_credential_uuid</a> = NULL</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Slave credential UUID.  <a href="#aca34079d27544a760cb51adfcdc47190"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gchar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ac9f9744f84e363505692836c77e960ac">slave_smb_credential_uuid</a> = NULL</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Slave credential UUID.  <a href="#ac9f9744f84e363505692836c77e960ac"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gchar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a2c994225ecd6576517c5efaefc8bec18">slave_target_uuid</a> = NULL</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Slave target UUID.  <a href="#a2c994225ecd6576517c5efaefc8bec18"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gchar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a722e123d1e29a7e306809e3e18c0dc4d">slave_config_uuid</a> = NULL</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Slave config UUID.  <a href="#a722e123d1e29a7e306809e3e18c0dc4d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gchar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a8d6c21512d60b5170ea6483bc993f197">slave_task_uuid</a> = NULL</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Slave task UUID.  <a href="#a8d6c21512d60b5170ea6483bc993f197"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gchar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ae7596549ddadfa2d0a201d030507df86">slave_report_uuid</a> = NULL</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Slave report UUID.  <a href="#ae7596549ddadfa2d0a201d030507df86"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gnutls_session_t *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a493639b270d5f76c41eae92cca6eb55f">slave_session</a> = NULL</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Slave session.  <a href="#a493639b270d5f76c41eae92cca6eb55f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#a6d2317e3891c679166b479fcc2e285cf">slave_socket</a> = NULL</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Slave socket.  <a href="#a6d2317e3891c679166b479fcc2e285cf"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#afc6df99003007ef239148d7a96457ed0">authenticate_allow_all</a> = 0</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Flag for manage_auth_allow_all.  <a href="#afc6df99003007ef239148d7a96457ed0"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">gchar *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="manage_8c.html#ac5399296de033331b1694de7bdc03584">schedule_user_uuid</a> = 0</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">UUID of user whose scheduled task is to be started (in connection with authenticate_allow_all).  <a href="#ac5399296de033331b1694de7bdc03584"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>
<p>The OpenVAS Manager management library. </p>
<p>This file defines a management library, for implementing OpenVAS Managers such as the OpenVAS Manager daemon.</p>
<p>This library provides facilities for storing and manipulating credential and task information, and manipulating reports. Task manipulation includes sending task commands to the OTP server (the "scanner") that is running the tasks. </p>

<p>Definition in file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>
<hr/><h2>Define Documentation</h2>
<a class="anchor" id="a78c99ffd76a7bb3c8c74db76207e9ab4"></a><!-- doxytag: member="manage.c::_XOPEN_SOURCE" ref="a78c99ffd76a7bb3c8c74db76207e9ab4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define _XOPEN_SOURCE</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manage_8c_source.html#l00041">41</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="a5f29c7a2f0601dd34b481375d6645d96"></a><!-- doxytag: member="manage.c::CERT_TIMESTAMP_FILENAME" ref="a5f29c7a2f0601dd34b481375d6645d96" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CERT_TIMESTAMP_FILENAME&nbsp;&nbsp;&nbsp;CERT_DATA_DIR &quot;/timestamp&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>CERT timestamp location. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00131">131</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="ab0d87e07831e7e4943caef187872123e"></a><!-- doxytag: member="manage.c::COMMAND" ref="ab0d87e07831e7e4943caef187872123e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMMAND&nbsp;&nbsp;&nbsp;&quot;openvasmr 0 titles&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Command called by get_system_report_types. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l03966">3966</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="abe0bf315a8d20f43a913bb2f8734dffa"></a><!-- doxytag: member="manage.c::CPE_DICT_FILENAME" ref="abe0bf315a8d20f43a913bb2f8734dffa" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPE_DICT_FILENAME&nbsp;&nbsp;&nbsp;SCAP_DATA_DIR &quot;/official-cpe-dictionary_v2.2.xml&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>CPE dictionary location. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00106">106</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad5aa949d6f37d98f569e82752bdfac74"></a><!-- doxytag: member="manage.c::CPE_GETBYNAME_XSL" ref="ad5aa949d6f37d98f569e82752bdfac74" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CPE_GETBYNAME_XSL&nbsp;&nbsp;&nbsp;SCAP_RES_DIR &quot;/cpe_getbyname.xsl&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>CPE selection stylesheet location. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00086">86</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l05778">manage_read_info()</a>.</p>

</div>
</div>
<a class="anchor" id="a53fa8b306e67607ae3149702bc9912ea"></a><!-- doxytag: member="manage.c::CVE_FILENAME_FMT" ref="a53fa8b306e67607ae3149702bc9912ea" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CVE_FILENAME_FMT&nbsp;&nbsp;&nbsp;SCAP_DATA_DIR &quot;/nvdcve-2.0-%d.xml&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>CVE data files location format string. </p>
<p>d should be the year expressed as YYYY. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00113">113</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="af7a8b4a77cbff90ef63f261c6281eba6"></a><!-- doxytag: member="manage.c::CVE_GETBYNAME_XSL" ref="af7a8b4a77cbff90ef63f261c6281eba6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CVE_GETBYNAME_XSL&nbsp;&nbsp;&nbsp;SCAP_RES_DIR &quot;/cve_getbyname.xsl&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>CVE selection stylesheet location. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00091">91</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l05778">manage_read_info()</a>.</p>

</div>
</div>
<a class="anchor" id="a14992bf8bee7c290dd716d865c47ae42"></a><!-- doxytag: member="manage.c::DEF" ref="a14992bf8bee7c290dd716d865c47ae42" args="(x)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEF</td>
          <td>(</td>
          <td class="paramtype">x&nbsp;</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="keyword">const</span> <span class="keywordtype">char</span>* x = nvt_iterator_ ## x (nvts);                  \
      gchar* x ## _text = x                                       \
                          ? g_markup_escape_text (x, -1)          \
                          : g_strdup (<span class="stringliteral">&quot;&quot;</span>);
</pre></div>
<p>Define a code snippet for get_nvti_xml. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>x</em>&nbsp;</td><td>Prefix for names in snippet. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05546">5546</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l05564">get_nvti_xml()</a>.</p>

</div>
</div>
<a class="anchor" id="af7f2e0eb7ca156e42b05b3ee1625496e"></a><!-- doxytag: member="manage.c::DFN_CERT_ADV_FILENAME_FMT" ref="af7f2e0eb7ca156e42b05b3ee1625496e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DFN_CERT_ADV_FILENAME_FMT&nbsp;&nbsp;&nbsp;CERT_DATA_DIR &quot;/dfn-cert-%04d.xml&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>DFN-CERT data files location format string. </p>
<p>First d should be the year expressed as YYYY, second d should be should be Month expressed as MM. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00121">121</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="aeabba2575a41385027b6e379f3dbb712"></a><!-- doxytag: member="manage.c::DFN_CERT_ADV_GETBYNAME_XSL" ref="aeabba2575a41385027b6e379f3dbb712" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DFN_CERT_ADV_GETBYNAME_XSL&nbsp;&nbsp;&nbsp;CERT_RES_DIR &quot;/dfn_cert_getbyname.xsl&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>DFN_CERT_ADV selection stylesheet location. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00101">101</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l05778">manage_read_info()</a>.</p>

</div>
</div>
<a class="anchor" id="af6e390f828fc5640de75627d993a623e"></a><!-- doxytag: member="manage.c::FALLBACK_SYSTEM_REPORT_HEADER" ref="af6e390f828fc5640de75627d993a623e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FALLBACK_SYSTEM_REPORT_HEADER</td>
        </tr>
      </table>
</div>
<div class="memdoc">
<b>Value:</b><div class="fragment"><pre class="fragment"><span class="stringliteral">&quot;This is the most basic, fallback report.  The system can be configured to\n&quot;</span> \
<span class="stringliteral">&quot;produce more powerful reports.  Please contact your system administrator\n&quot;</span> \
<span class="stringliteral">&quot;for more information.\n\n&quot;</span>
</pre></div>
<p>Header for fallback system report. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04239">4239</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l04257">manage_system_report()</a>.</p>

</div>
</div>
<a class="anchor" id="a1810a09af583816ca6b4ccf01ae848f7"></a><!-- doxytag: member="manage.c::G_LOG_DOMAIN" ref="a1810a09af583816ca6b4ccf01ae848f7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define G_LOG_DOMAIN&nbsp;&nbsp;&nbsp;&quot;md manage&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>GLib log domain. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00081">81</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="ad86f058e7e83daa79168f4a2e21cf771"></a><!-- doxytag: member="manage.c::MAX_CHECKS_DEFAULT" ref="ad86f058e7e83daa79168f4a2e21cf771" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_CHECKS_DEFAULT&nbsp;&nbsp;&nbsp;&quot;4&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Default for Scanner max_checks preference. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00136">136</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="a7e3bd54f9e039bd4b7f8084be09116a5"></a><!-- doxytag: member="manage.c::MAX_HOSTS_DEFAULT" ref="a7e3bd54f9e039bd4b7f8084be09116a5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_HOSTS_DEFAULT&nbsp;&nbsp;&nbsp;&quot;20&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Default for Scanner max_hosts preference. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00141">141</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="a3d9ac0eebf166f2e60a60b4e4ff86393"></a><!-- doxytag: member="manage.c::OVALDEF_GETBYNAME_XSL" ref="a3d9ac0eebf166f2e60a60b4e4ff86393" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OVALDEF_GETBYNAME_XSL&nbsp;&nbsp;&nbsp;SCAP_RES_DIR &quot;/ovaldef_getbyname.xsl&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>OVALDEF selection stylesheet location. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00096">96</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l05778">manage_read_info()</a>.</p>

</div>
</div>
<a class="anchor" id="a0b6a3f0e2281112fa8f4cc5d0491157c"></a><!-- doxytag: member="manage.c::RUN_SLAVE_TASK_SLEEP_SECONDS" ref="a0b6a3f0e2281112fa8f4cc5d0491157c" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RUN_SLAVE_TASK_SLEEP_SECONDS&nbsp;&nbsp;&nbsp;25</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Number of seconds to sleep between polls to slave. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l01848">1848</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6829ef55fec66a0b53ff57cbfab63b8d"></a><!-- doxytag: member="manage.c::SCAP_TIMESTAMP_FILENAME" ref="a6829ef55fec66a0b53ff57cbfab63b8d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SCAP_TIMESTAMP_FILENAME&nbsp;&nbsp;&nbsp;SCAP_DATA_DIR &quot;/timestamp&quot;</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>SCAP timestamp location. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00126">126</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l05731">manage_scap_update_time()</a>.</p>

</div>
</div>
<a class="anchor" id="a7c415f3910ecba64f28a551e5063de6b"></a><!-- doxytag: member="manage.c::ZERO_SEVERITY_INDEX" ref="a7c415f3910ecba64f28a551e5063de6b" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ZERO_SEVERITY_INDEX&nbsp;&nbsp;&nbsp;4</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="manage_8c_source.html#l00541">541</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l00593">init_severity_data()</a>, <a class="el" href="manage_8c_source.html#l00551">severity_data_index()</a>, and <a class="el" href="manage_8c_source.html#l00573">severity_data_value()</a>.</p>

</div>
</div>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a735c8af35e7e379adbda1ae032539f99"></a><!-- doxytag: member="manage.c::acknowledge_bye" ref="a735c8af35e7e379adbda1ae032539f99" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int acknowledge_bye </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Acknowledge a scanner BYE. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 if out of space in scanner output buffer. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l03766">3766</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="ovas-mngr-comm_8c_source.html#l00155">send_to_server()</a>.</p>

<p>Referenced by <a class="el" href="otp_8c_source.html#l00784">process_otp_scanner_input()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03767"></a>03767 {
<a name="l03768"></a>03768   <span class="keywordflow">if</span> (<a class="code" href="ovas-mngr-comm_8c.html#a5e8ebd680f5948035731df580f52bbab" title="Send a message to the server.">send_to_server</a> (<span class="stringliteral">&quot;CLIENT &lt;|&gt; BYE &lt;|&gt; ACK\n&quot;</span>))
<a name="l03769"></a>03769     <span class="keywordflow">return</span> -1;
<a name="l03770"></a>03770   <span class="keywordflow">return</span> 0;
<a name="l03771"></a>03771 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ae323fba6e7a66561706b51ada4ff02c6"></a><!-- doxytag: member="manage.c::acknowledge_feed_version_info" ref="ae323fba6e7a66561706b51ada4ff02c6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int acknowledge_feed_version_info </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Acknowledge scanner PLUGINS_FEED_VERSION message,. </p>
<p>requesting all plugin info. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 if out of space in scanner output buffer. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l03780">3780</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="ovas-mngr-comm_8c_source.html#l00155">send_to_server()</a>.</p>

<p>Referenced by <a class="el" href="otp_8c_source.html#l00784">process_otp_scanner_input()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03781"></a>03781 {
<a name="l03782"></a>03782   <span class="keywordflow">if</span> (<a class="code" href="ovas-mngr-comm_8c.html#a5e8ebd680f5948035731df580f52bbab" title="Send a message to the server.">send_to_server</a> (<span class="stringliteral">&quot;CLIENT &lt;|&gt; COMPLETE_LIST &lt;|&gt; CLIENT\n&quot;</span>))
<a name="l03783"></a>03783     <span class="keywordflow">return</span> -1;
<a name="l03784"></a>03784   <span class="keywordflow">return</span> 0;
<a name="l03785"></a>03785 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ab0857e60d922fc8f0e93e77e05f2739a"></a><!-- doxytag: member="manage.c::alert_condition_description" ref="ab0857e60d922fc8f0e93e77e05f2739a" args="(alert_condition_t condition, alert_t alert)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gchar* alert_condition_description </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71d">alert_condition_t</a>&nbsp;</td>
          <td class="paramname"> <em>condition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="manage_8h.html#ab8f49b57d1efa085106917a33ea8993c">alert_t</a>&nbsp;</td>
          <td class="paramname"> <em>alert</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get a description of an alert condition. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>condition</em>&nbsp;</td><td>Condition. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alert</em>&nbsp;</td><td>Alert.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Freshly allocated description of condition. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00834">834</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00329">ALERT_CONDITION_ALWAYS</a>, <a class="el" href="manage_8h_source.html#l00330">ALERT_CONDITION_SEVERITY_AT_LEAST</a>, <a class="el" href="manage_8h_source.html#l00331">ALERT_CONDITION_SEVERITY_CHANGED</a>, and <a class="el" href="manage__sql_8c_source.html#l06594">alert_data()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00836"></a>00836 {
<a name="l00837"></a>00837   <span class="keywordflow">switch</span> (condition)
<a name="l00838"></a>00838     {
<a name="l00839"></a>00839       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71da794c6332f7c64c34497528f07f29a024">ALERT_CONDITION_ALWAYS</a>:
<a name="l00840"></a>00840         <span class="keywordflow">return</span> g_strdup (<span class="stringliteral">&quot;Always&quot;</span>);
<a name="l00841"></a>00841       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71da2eb8dce5d7e6e3316b84408bbbb12d55">ALERT_CONDITION_SEVERITY_AT_LEAST</a>:
<a name="l00842"></a>00842         {
<a name="l00843"></a>00843           <span class="keywordtype">char</span> *level = <a class="code" href="manage__sql_8c.html#a8080734e167dd2ed40ec5ee201334d4d" title="Return data associated with an alert.">alert_data</a> (alert, <span class="stringliteral">&quot;condition&quot;</span>, <span class="stringliteral">&quot;severity&quot;</span>);
<a name="l00844"></a>00844           gchar *ret = g_strdup_printf (<span class="stringliteral">&quot;Task severity is at least &apos;%s&apos;&quot;</span>,
<a name="l00845"></a>00845                                         level);
<a name="l00846"></a>00846           free (level);
<a name="l00847"></a>00847           <span class="keywordflow">return</span> ret;
<a name="l00848"></a>00848         }
<a name="l00849"></a>00849       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71dad1b49ef6f95c23ecf6bfb97f9f8d76fb">ALERT_CONDITION_SEVERITY_CHANGED</a>:
<a name="l00850"></a>00850         {
<a name="l00851"></a>00851           <span class="keywordtype">char</span> *direction;
<a name="l00852"></a>00852           direction = <a class="code" href="manage__sql_8c.html#a8080734e167dd2ed40ec5ee201334d4d" title="Return data associated with an alert.">alert_data</a> (alert, <span class="stringliteral">&quot;condition&quot;</span>, <span class="stringliteral">&quot;direction&quot;</span>);
<a name="l00853"></a>00853           gchar *ret = g_strdup_printf (<span class="stringliteral">&quot;Task severity %s&quot;</span>, direction);
<a name="l00854"></a>00854           free (direction);
<a name="l00855"></a>00855           <span class="keywordflow">return</span> ret;
<a name="l00856"></a>00856         }
<a name="l00857"></a>00857       <span class="keywordflow">default</span>:
<a name="l00858"></a>00858         <span class="keywordflow">return</span> g_strdup (<span class="stringliteral">&quot;Internal Error&quot;</span>);
<a name="l00859"></a>00859     }
<a name="l00860"></a>00860 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a8b5128bc5d3c2280e35793b23dfdb5e7"></a><!-- doxytag: member="manage.c::alert_condition_from_name" ref="a8b5128bc5d3c2280e35793b23dfdb5e7" args="(const char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71d">alert_condition_t</a> alert_condition_from_name </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get an alert condition from a name. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>Condition name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The condition. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00919">919</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00329">ALERT_CONDITION_ALWAYS</a>, <a class="el" href="manage_8h_source.html#l00328">ALERT_CONDITION_ERROR</a>, <a class="el" href="manage_8h_source.html#l00330">ALERT_CONDITION_SEVERITY_AT_LEAST</a>, and <a class="el" href="manage_8h_source.html#l00331">ALERT_CONDITION_SEVERITY_CHANGED</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00920"></a>00920 {
<a name="l00921"></a>00921   <span class="keywordflow">if</span> (strcasecmp (<a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>, <span class="stringliteral">&quot;Always&quot;</span>) == 0)
<a name="l00922"></a>00922     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71da794c6332f7c64c34497528f07f29a024">ALERT_CONDITION_ALWAYS</a>;
<a name="l00923"></a>00923   <span class="keywordflow">if</span> (strcasecmp (<a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>, <span class="stringliteral">&quot;Severity at least&quot;</span>) == 0)
<a name="l00924"></a>00924     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71da2eb8dce5d7e6e3316b84408bbbb12d55">ALERT_CONDITION_SEVERITY_AT_LEAST</a>;
<a name="l00925"></a>00925   <span class="keywordflow">if</span> (strcasecmp (<a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>, <span class="stringliteral">&quot;Severity changed&quot;</span>) == 0)
<a name="l00926"></a>00926     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71dad1b49ef6f95c23ecf6bfb97f9f8d76fb">ALERT_CONDITION_SEVERITY_CHANGED</a>;
<a name="l00927"></a>00927   <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71da9025723e6b6b23f224c1ddf031232e63">ALERT_CONDITION_ERROR</a>;
<a name="l00928"></a>00928 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="aaf325a9591faa1e5f2c891946aabfdc4"></a><!-- doxytag: member="manage.c::alert_condition_name" ref="aaf325a9591faa1e5f2c891946aabfdc4" args="(alert_condition_t condition)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* alert_condition_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71d">alert_condition_t</a>&nbsp;</td>
          <td class="paramname"> <em>condition</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the name of an alert condition. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>condition</em>&nbsp;</td><td>Condition.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The name of the condition (for example, "Always"). </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00793">793</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00329">ALERT_CONDITION_ALWAYS</a>, <a class="el" href="manage_8h_source.html#l00330">ALERT_CONDITION_SEVERITY_AT_LEAST</a>, and <a class="el" href="manage_8h_source.html#l00331">ALERT_CONDITION_SEVERITY_CHANGED</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00794"></a>00794 {
<a name="l00795"></a>00795   <span class="keywordflow">switch</span> (condition)
<a name="l00796"></a>00796     {
<a name="l00797"></a>00797       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71da794c6332f7c64c34497528f07f29a024">ALERT_CONDITION_ALWAYS</a>:
<a name="l00798"></a>00798         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Always&quot;</span>;
<a name="l00799"></a>00799       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71da2eb8dce5d7e6e3316b84408bbbb12d55">ALERT_CONDITION_SEVERITY_AT_LEAST</a>:
<a name="l00800"></a>00800         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Severity at least&quot;</span>;
<a name="l00801"></a>00801       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#abf4e6a79c807ff333dc28e681c34d71dad1b49ef6f95c23ecf6bfb97f9f8d76fb">ALERT_CONDITION_SEVERITY_CHANGED</a>:
<a name="l00802"></a>00802         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Severity changed&quot;</span>;
<a name="l00803"></a>00803       <span class="keywordflow">default</span>:
<a name="l00804"></a>00804         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Internal Error&quot;</span>;
<a name="l00805"></a>00805     }
<a name="l00806"></a>00806 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a82a0807b99c0dfdc0e377b3562c348d9"></a><!-- doxytag: member="manage.c::alert_method_from_name" ref="a82a0807b99c0dfdc0e377b3562c348d9" args="(const char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dc">alert_method_t</a> alert_method_from_name </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get an alert method from a name. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>Method name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The method. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00953">953</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00316">ALERT_METHOD_EMAIL</a>, <a class="el" href="manage_8h_source.html#l00315">ALERT_METHOD_ERROR</a>, <a class="el" href="manage_8h_source.html#l00317">ALERT_METHOD_HTTP_GET</a>, <a class="el" href="manage_8h_source.html#l00318">ALERT_METHOD_SOURCEFIRE</a>, <a class="el" href="manage_8h_source.html#l00319">ALERT_METHOD_SYSLOG</a>, and <a class="el" href="manage_8h_source.html#l00320">ALERT_METHOD_VERINICE</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00954"></a>00954 {
<a name="l00955"></a>00955   <span class="keywordflow">if</span> (strcasecmp (<a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>, <span class="stringliteral">&quot;Email&quot;</span>) == 0)
<a name="l00956"></a>00956     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dca52afe4ea3317b468d48c77bb3f84c19c">ALERT_METHOD_EMAIL</a>;
<a name="l00957"></a>00957   <span class="keywordflow">if</span> (strcasecmp (<a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>, <span class="stringliteral">&quot;HTTP Get&quot;</span>) == 0)
<a name="l00958"></a>00958     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dcac709e5dfe9bd132f5b373b1e378eb9d5">ALERT_METHOD_HTTP_GET</a>;
<a name="l00959"></a>00959   <span class="keywordflow">if</span> (strcasecmp (<a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>, <span class="stringliteral">&quot;Sourcefire Connector&quot;</span>) == 0)
<a name="l00960"></a>00960     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dca9ad6a3bcc9b664ceff895ba93985edc2">ALERT_METHOD_SOURCEFIRE</a>;
<a name="l00961"></a>00961   <span class="keywordflow">if</span> (strcasecmp (<a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>, <span class="stringliteral">&quot;Syslog&quot;</span>) == 0)
<a name="l00962"></a>00962     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dcaa6c9d4d82a85c6bdfa670044cd2c67d5">ALERT_METHOD_SYSLOG</a>;
<a name="l00963"></a>00963   <span class="keywordflow">if</span> (strcasecmp (<a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>, <span class="stringliteral">&quot;verinice Connector&quot;</span>) == 0)
<a name="l00964"></a>00964     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dca31d3307f9e2c5a2aad23263970893074">ALERT_METHOD_VERINICE</a>;
<a name="l00965"></a>00965   <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dca2bdcd025eed976a84e9602d033d3ecba">ALERT_METHOD_ERROR</a>;
<a name="l00966"></a>00966 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a56441bd475c89375dd71bb34750f6b31"></a><!-- doxytag: member="manage.c::alert_method_name" ref="a56441bd475c89375dd71bb34750f6b31" args="(alert_method_t method)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* alert_method_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dc">alert_method_t</a>&nbsp;</td>
          <td class="paramname"> <em>method</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the name of an alert method. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>method</em>&nbsp;</td><td>Method.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The name of the method (for example, "Email" or "SNMP"). </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00898">898</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00316">ALERT_METHOD_EMAIL</a>, <a class="el" href="manage_8h_source.html#l00317">ALERT_METHOD_HTTP_GET</a>, <a class="el" href="manage_8h_source.html#l00318">ALERT_METHOD_SOURCEFIRE</a>, <a class="el" href="manage_8h_source.html#l00319">ALERT_METHOD_SYSLOG</a>, and <a class="el" href="manage_8h_source.html#l00320">ALERT_METHOD_VERINICE</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00899"></a>00899 {
<a name="l00900"></a>00900   <span class="keywordflow">switch</span> (method)
<a name="l00901"></a>00901     {
<a name="l00902"></a>00902       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dca52afe4ea3317b468d48c77bb3f84c19c">ALERT_METHOD_EMAIL</a>:       <span class="keywordflow">return</span> <span class="stringliteral">&quot;Email&quot;</span>;
<a name="l00903"></a>00903       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dcac709e5dfe9bd132f5b373b1e378eb9d5">ALERT_METHOD_HTTP_GET</a>:    <span class="keywordflow">return</span> <span class="stringliteral">&quot;HTTP Get&quot;</span>;
<a name="l00904"></a>00904       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dca9ad6a3bcc9b664ceff895ba93985edc2">ALERT_METHOD_SOURCEFIRE</a>:  <span class="keywordflow">return</span> <span class="stringliteral">&quot;Sourcefire Connector&quot;</span>;
<a name="l00905"></a>00905       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dcaa6c9d4d82a85c6bdfa670044cd2c67d5">ALERT_METHOD_SYSLOG</a>:      <span class="keywordflow">return</span> <span class="stringliteral">&quot;Syslog&quot;</span>;
<a name="l00906"></a>00906       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#a3e29863d97eb6a3ede86cd21cbc273dca31d3307f9e2c5a2aad23263970893074">ALERT_METHOD_VERINICE</a>:    <span class="keywordflow">return</span> <span class="stringliteral">&quot;verinice Connector&quot;</span>;
<a name="l00907"></a>00907       <span class="keywordflow">default</span>:                       <span class="keywordflow">return</span> <span class="stringliteral">&quot;Internal Error&quot;</span>;
<a name="l00908"></a>00908     }
<a name="l00909"></a>00909 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1b50d91884982550b4483e02f6f044ae"></a><!-- doxytag: member="manage.c::buffer_config_preference_xml" ref="a1b50d91884982550b4483e02f6f044ae" args="(GString *, iterator_t *, config_t, int)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void buffer_config_preference_xml </td>
          <td>(</td>
          <td class="paramtype">GString *&nbsp;</td>
          <td class="paramname"> <em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structiterator__t.html">iterator_t</a> *&nbsp;</td>
          <td class="paramname"> <em>prefs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="manage_8h.html#a02ae852d74ff91bf9a6884d76e2a5902">config_t</a>&nbsp;</td>
          <td class="paramname"> <em>config</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>hide_passwords</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Buffer XML for the NVT preference of a config. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>buffer</em>&nbsp;</td><td>Buffer. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>prefs</em>&nbsp;</td><td>NVT preference iterator. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>config</em>&nbsp;</td><td>Config. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>hide_passwords</em>&nbsp;</td><td>Whether to hide passwords. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="omp_8c_source.html#l10172">10172</a> of file <a class="el" href="omp_8c_source.html">omp.c</a>.</p>

<p>References <a class="el" href="manage__sql_8c_source.html#l30605">nvt_oid()</a>, <a class="el" href="manage__sql_8c_source.html#l32894">nvt_preference_iterator_config_value()</a>, <a class="el" href="manage__sql_8c_source.html#l32867">nvt_preference_iterator_nvt()</a>, <a class="el" href="manage__sql_8c_source.html#l32812">nvt_preference_iterator_real_name()</a>, <a class="el" href="manage__sql_8c_source.html#l32840">nvt_preference_iterator_type()</a>, and <a class="el" href="manage_8h.html#acca7281b311c3b8a9b3512fd5de9bffa">nvt_preference_iterator_value()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l10174"></a>10174 {
<a name="l10175"></a>10175   <span class="keywordtype">char</span> *real_name, *type, *<a class="code" href="structnamelist__s.html#a2382546248b3fa55432d922fc5076f19">value</a>, *nvt;
<a name="l10176"></a>10176   <span class="keyword">const</span> <span class="keywordtype">char</span> *default_value;
<a name="l10177"></a>10177   <span class="keywordtype">char</span> *oid = NULL;
<a name="l10178"></a>10178 
<a name="l10179"></a>10179   real_name = <a class="code" href="manage_8h.html#a4e903d1bec8439dd7cab2dac12dc16c2" title="Get the real name from an NVT preference iterator.">nvt_preference_iterator_real_name</a> (prefs);
<a name="l10180"></a>10180   type = <a class="code" href="manage_8h.html#af6e8c1f62401a585ccc645360d7a8ad3" title="Get the type from an NVT preference iterator.">nvt_preference_iterator_type</a> (prefs);
<a name="l10181"></a>10181   value = <a class="code" href="manage_8h.html#a916315397eccd16da527fd3513edba63" title="Get the config value from an NVT preference iterator.">nvt_preference_iterator_config_value</a> (prefs, config);
<a name="l10182"></a>10182   nvt = <a class="code" href="manage_8h.html#af23eaf891a8018ce18d8c11838e84468" title="Get the NVT from an NVT preference iterator.">nvt_preference_iterator_nvt</a> (prefs);
<a name="l10183"></a>10183 
<a name="l10184"></a>10184   default_value = <a class="code" href="manage_8h.html#acca7281b311c3b8a9b3512fd5de9bffa">nvt_preference_iterator_value</a> (prefs);
<a name="l10185"></a>10185 
<a name="l10186"></a>10186   <span class="keywordflow">if</span> (nvt) oid = <a class="code" href="manage_8h.html#a8cbda3f5c08b4117a05fee500c21eb07" title="Guess the OID of an NVT given a name.">nvt_oid</a> (nvt);
<a name="l10187"></a>10187 
<a name="l10188"></a>10188   buffer_xml_append_printf (buffer,
<a name="l10189"></a>10189                             <span class="stringliteral">&quot;&lt;preference&gt;&quot;</span>
<a name="l10190"></a>10190                             <span class="stringliteral">&quot;&lt;nvt oid=\&quot;%s\&quot;&gt;&lt;name&gt;%s&lt;/name&gt;&lt;/nvt&gt;&quot;</span>
<a name="l10191"></a>10191                             <span class="stringliteral">&quot;&lt;name&gt;%s&lt;/name&gt;&quot;</span>
<a name="l10192"></a>10192                             <span class="stringliteral">&quot;&lt;type&gt;%s&lt;/type&gt;&quot;</span>,
<a name="l10193"></a>10193                             oid ? oid : <span class="stringliteral">&quot;&quot;</span>,
<a name="l10194"></a>10194                             nvt ? nvt : <span class="stringliteral">&quot;&quot;</span>,
<a name="l10195"></a>10195                             real_name ? real_name : <span class="stringliteral">&quot;&quot;</span>,
<a name="l10196"></a>10196                             type ? type : <span class="stringliteral">&quot;&quot;</span>);
<a name="l10197"></a>10197 
<a name="l10198"></a>10198   <span class="keywordflow">if</span> (value
<a name="l10199"></a>10199       &amp;&amp; type
<a name="l10200"></a>10200       &amp;&amp; (strcmp (type, <span class="stringliteral">&quot;radio&quot;</span>) == 0))
<a name="l10201"></a>10201     {
<a name="l10202"></a>10202       <span class="comment">/* Handle the other possible values. */</span>
<a name="l10203"></a>10203       <span class="keywordtype">char</span> *pos = strchr (value, <span class="charliteral">&apos;;&apos;</span>);
<a name="l10204"></a>10204       <span class="keywordflow">if</span> (pos) *pos = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l10205"></a>10205       buffer_xml_append_printf (buffer, <span class="stringliteral">&quot;&lt;value&gt;%s&lt;/value&gt;&quot;</span>, value);
<a name="l10206"></a>10206       <span class="keywordflow">while</span> (pos)
<a name="l10207"></a>10207         {
<a name="l10208"></a>10208           <span class="keywordtype">char</span> *pos2 = strchr (++pos, <span class="charliteral">&apos;;&apos;</span>);
<a name="l10209"></a>10209           <span class="keywordflow">if</span> (pos2) *pos2 = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l10210"></a>10210           buffer_xml_append_printf (buffer, <span class="stringliteral">&quot;&lt;alt&gt;%s&lt;/alt&gt;&quot;</span>, pos);
<a name="l10211"></a>10211           pos = pos2;
<a name="l10212"></a>10212         }
<a name="l10213"></a>10213     }
<a name="l10214"></a>10214   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (value
<a name="l10215"></a>10215            &amp;&amp; type
<a name="l10216"></a>10216            &amp;&amp; hide_passwords
<a name="l10217"></a>10217            &amp;&amp; (strcmp (type, <span class="stringliteral">&quot;password&quot;</span>) == 0))
<a name="l10218"></a>10218     buffer_xml_append_printf (buffer, <span class="stringliteral">&quot;&lt;value&gt;&lt;/value&gt;&quot;</span>);
<a name="l10219"></a>10219   <span class="keywordflow">else</span>
<a name="l10220"></a>10220     buffer_xml_append_printf (buffer, <span class="stringliteral">&quot;&lt;value&gt;%s&lt;/value&gt;&quot;</span>, value ? value : <span class="stringliteral">&quot;&quot;</span>);
<a name="l10221"></a>10221 
<a name="l10222"></a>10222   <span class="keywordflow">if</span> (default_value
<a name="l10223"></a>10223       &amp;&amp; type
<a name="l10224"></a>10224       &amp;&amp; (strcmp (type, <span class="stringliteral">&quot;radio&quot;</span>) == 0))
<a name="l10225"></a>10225     {
<a name="l10226"></a>10226       <span class="comment">/* Handle the other possible values. */</span>
<a name="l10227"></a>10227       <span class="keywordtype">char</span> *pos = strchr (default_value, <span class="charliteral">&apos;;&apos;</span>);
<a name="l10228"></a>10228       <span class="keywordflow">if</span> (pos) *pos = <span class="charliteral">&apos;\0&apos;</span>;
<a name="l10229"></a>10229       buffer_xml_append_printf (buffer, <span class="stringliteral">&quot;&lt;default&gt;%s&lt;/default&gt;&quot;</span>, default_value);
<a name="l10230"></a>10230     }
<a name="l10231"></a>10231   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (default_value
<a name="l10232"></a>10232            &amp;&amp; type
<a name="l10233"></a>10233            &amp;&amp; (strcmp (type, <span class="stringliteral">&quot;password&quot;</span>) == 0))
<a name="l10234"></a>10234     buffer_xml_append_printf (buffer, <span class="stringliteral">&quot;&lt;default&gt;&lt;/default&gt;&quot;</span>);
<a name="l10235"></a>10235   <span class="keywordflow">else</span>
<a name="l10236"></a>10236     buffer_xml_append_printf (buffer, <span class="stringliteral">&quot;&lt;default&gt;%s&lt;/default&gt;&quot;</span>, default_value
<a name="l10237"></a>10237                                                                ? default_value
<a name="l10238"></a>10238                                                                : <span class="stringliteral">&quot;&quot;</span>);
<a name="l10239"></a>10239 
<a name="l10240"></a>10240   buffer_xml_append_printf (buffer, <span class="stringliteral">&quot;&lt;/preference&gt;&quot;</span>);
<a name="l10241"></a>10241 
<a name="l10242"></a>10242   free (real_name);
<a name="l10243"></a>10243   free (type);
<a name="l10244"></a>10244   free (value);
<a name="l10245"></a>10245   free (nvt);
<a name="l10246"></a>10246   free (oid);
<a name="l10247"></a>10247 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a635952c4c372571bcbf1b6401d5ab7b2"></a><!-- doxytag: member="manage.c::cleanup_file_iterator" ref="a635952c4c372571bcbf1b6401d5ab7b2" args="(file_iterator_t *iterator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cleanup_file_iterator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfile__iterator__t.html">file_iterator_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Cleanup a report type iterator. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>iterator</em>&nbsp;</td><td>Iterator. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05032">5032</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l02359">file_iterator_t::dir_name</a>, and <a class="el" href="manage_8h_source.html#l02357">file_iterator_t::start</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l40106">verify_report_format_internal()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05033"></a>05033 {
<a name="l05034"></a>05034   array_free (iterator-&gt;<a class="code" href="structfile__iterator__t.html#a2fdaa9abf475aeb2be7f858ea5541577" title="Array of files.">start</a>);
<a name="l05035"></a>05035   g_free (iterator-&gt;<a class="code" href="structfile__iterator__t.html#ab93c5216864438b256d596db6149a9f5" title="Dir holding files.">dir_name</a>);
<a name="l05036"></a>05036 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a1acdc1f56b78c222844efebb1860b2f2"></a><!-- doxytag: member="manage.c::cleanup_report_type_iterator" ref="a1acdc1f56b78c222844efebb1860b2f2" args="(report_type_iterator_t *iterator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cleanup_report_type_iterator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structreport__type__iterator__t.html">report_type_iterator_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Cleanup a report type iterator. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>iterator</em>&nbsp;</td><td>Iterator. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04104">4104</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l02073">report_type_iterator_t::start</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04105"></a>04105 {
<a name="l04106"></a>04106   g_strfreev (iterator-&gt;<a class="code" href="structreport__type__iterator__t.html#ab888bbf8198796f986db6b1d4709f1b5" title="First type.">start</a>);
<a name="l04107"></a>04107 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab34995fe7b61c71b10f1943d18ee2ff7"></a><!-- doxytag: member="manage.c::cleanup_severity_data" ref="ab34995fe7b61c71b10f1943d18ee2ff7" args="(severity_data_t *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void cleanup_severity_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structseverity__data__t.html">severity_data_t</a> *&nbsp;</td>
          <td class="paramname"> <em>data</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Clean up a severity data structure. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>The data structure to initialize. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00610">610</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00808">severity_data_t::counts</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00611"></a>00611 {
<a name="l00612"></a>00612   g_free (data-&gt;<a class="code" href="structseverity__data__t.html#a0117bda2dbab5a7423fe42785415835d">counts</a>);
<a name="l00613"></a>00613 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ade0e864e3b072af900232a13f5ae8d3e"></a><!-- doxytag: member="manage.c::delete_reports" ref="ade0e864e3b072af900232a13f5ae8d3e" args="(task_t task)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int delete_reports </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a>&nbsp;</td>
          <td class="paramname"> <em>task</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Delete all the reports for a task. </p>
<p>It's up to the caller to ensure that this runs in a contention safe context (for example within an SQL transaction).</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>task</em>&nbsp;</td><td>A task descriptor.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 on error. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00503">503</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="sql_8c_source.html#l02228">cleanup_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l19450">delete_report_internal()</a>, <a class="el" href="manage__sql_8c_source.html#l15746">init_report_iterator_task()</a>, and <a class="el" href="manage__sql_8c_source.html#l15785">next_report()</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l25963">delete_task()</a>, and <a class="el" href="manage__sql_8c_source.html#l25833">request_delete_task_uuid()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00504"></a>00504 {
<a name="l00505"></a>00505   <a class="code" href="manage_8h.html#a46acf9d556c9f1756609957571bc90f3">report_t</a> report;
<a name="l00506"></a>00506   <a class="code" href="structiterator__t.html" title="A generic SQL iterator.">iterator_t</a> iterator;
<a name="l00507"></a>00507   <a class="code" href="manage_8h.html#a1a00d0400ea96f775bf01a864b97fc5c" title="Initialise a report iterator.">init_report_iterator_task</a> (&amp;iterator, task);
<a name="l00508"></a>00508   <span class="keywordflow">while</span> (<a class="code" href="manage_8h.html#a7175f00fb9791444cd9a45ade1f5741b" title="Read the next report from an iterator.">next_report</a> (&amp;iterator, &amp;report))
<a name="l00509"></a>00509     <span class="keywordflow">if</span> (<a class="code" href="manage__sql_8c.html#a5b12be9ec5774042c1b8cabca5e5ebaf" title="Delete a report.">delete_report_internal</a> (report))
<a name="l00510"></a>00510       {
<a name="l00511"></a>00511         <a class="code" href="manage_8h.html#aa98d17659363974764692d019f4d8172" title="Cleanup an iterator.">cleanup_iterator</a> (&amp;iterator);
<a name="l00512"></a>00512         <span class="keywordflow">return</span> -1;
<a name="l00513"></a>00513       }
<a name="l00514"></a>00514   <a class="code" href="manage_8h.html#aa98d17659363974764692d019f4d8172" title="Cleanup an iterator.">cleanup_iterator</a> (&amp;iterator);
<a name="l00515"></a>00515   <span class="keywordflow">return</span> 0;
<a name="l00516"></a>00516 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ab86f5e2d35356f1929d5c30927c939e5"></a><!-- doxytag: member="manage.c::delete_slave_task" ref="ab86f5e2d35356f1929d5c30927c939e5" args="(slave_t slave, const char *slave_task_uuid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int delete_slave_task </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="manage_8h.html#a0a96f61bb2eb4c7ea77e2a88dc34fec5">slave_t</a>&nbsp;</td>
          <td class="paramname"> <em>slave</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>slave_task_uuid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Delete a task on a slave. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>slave</em>&nbsp;</td><td>The slave. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>slave_task_uuid</em>&nbsp;</td><td>UUID of task on slave.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 success, -1 error. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05190">5190</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8c_source.html#l01817">slave_authenticate()</a>, <a class="el" href="manage__sql_8c_source.html#l41959">slave_host()</a>, <a class="el" href="manage__sql_8c_source.html#l42004">slave_port()</a>, and <a class="el" href="tracef_8h_source.html#l00089">tracef</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l19450">delete_report_internal()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05191"></a>05191 {
<a name="l05192"></a>05192   <span class="keywordtype">int</span> socket;
<a name="l05193"></a>05193   gnutls_session_t session;
<a name="l05194"></a>05194   <span class="keywordtype">char</span> *host;
<a name="l05195"></a>05195   <span class="keywordtype">int</span> port;
<a name="l05196"></a>05196   entity_t get_tasks, get_targets, entity, task, credential;
<a name="l05197"></a>05197   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="manage_8c.html#a722e123d1e29a7e306809e3e18c0dc4d" title="Slave config UUID.">slave_config_uuid</a>, *<a class="code" href="manage_8c.html#a2c994225ecd6576517c5efaefc8bec18" title="Slave target UUID.">slave_target_uuid</a>;
<a name="l05198"></a>05198   <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="manage_8c.html#aca34079d27544a760cb51adfcdc47190" title="Slave credential UUID.">slave_ssh_credential_uuid</a>, *<a class="code" href="manage_8c.html#ac9f9744f84e363505692836c77e960ac" title="Slave credential UUID.">slave_smb_credential_uuid</a>;
<a name="l05199"></a>05199 
<a name="l05200"></a>05200   omp_delete_opts_t del_opts = omp_delete_opts_ultimate_defaults;
<a name="l05201"></a>05201 
<a name="l05202"></a>05202   assert (slave);
<a name="l05203"></a>05203 
<a name="l05204"></a>05204   <span class="comment">/* Connect to the slave. */</span>
<a name="l05205"></a>05205 
<a name="l05206"></a>05206   host = <a class="code" href="manage_8h.html#a6e8a68bdaf86f2478e83f5cf3113e512" title="Return the host associated with a slave.">slave_host</a> (slave);
<a name="l05207"></a>05207   <span class="keywordflow">if</span> (host == NULL) <span class="keywordflow">return</span> -1;
<a name="l05208"></a>05208 
<a name="l05209"></a>05209   <a class="code" href="tracef_8h.html#a70d339a461f334e16086ab23b83cedc4" title="Formatted trace output.">tracef</a> (<span class="stringliteral">&quot;   %s: host: %s\n&quot;</span>, __FUNCTION__, host);
<a name="l05210"></a>05210 
<a name="l05211"></a>05211   port = <a class="code" href="manage_8h.html#aef7a0d6cf951344546337e00bcefccf8" title="Return the port associated with a slave.">slave_port</a> (slave);
<a name="l05212"></a>05212   <span class="keywordflow">if</span> (port == -1)
<a name="l05213"></a>05213     {
<a name="l05214"></a>05214       free (host);
<a name="l05215"></a>05215       <span class="keywordflow">return</span> -1;
<a name="l05216"></a>05216     }
<a name="l05217"></a>05217 
<a name="l05218"></a>05218   socket = openvas_server_open (&amp;session, host, port);
<a name="l05219"></a>05219   free (host);
<a name="l05220"></a>05220   <span class="keywordflow">if</span> (socket == -1) <span class="keywordflow">return</span> -1;
<a name="l05221"></a>05221 
<a name="l05222"></a>05222   <a class="code" href="tracef_8h.html#a70d339a461f334e16086ab23b83cedc4" title="Formatted trace output.">tracef</a> (<span class="stringliteral">&quot;   %s: connected\n&quot;</span>, __FUNCTION__);
<a name="l05223"></a>05223 
<a name="l05224"></a>05224   <span class="comment">/* Authenticate using the slave login. */</span>
<a name="l05225"></a>05225 
<a name="l05226"></a>05226   <span class="keywordflow">if</span> (<a class="code" href="manage_8c.html#a08629059dbccb26c5e10d44ef08e9b58" title="Authenticate with a slave.">slave_authenticate</a> (&amp;session, slave))
<a name="l05227"></a>05227     <span class="keywordflow">goto</span> fail;
<a name="l05228"></a>05228 
<a name="l05229"></a>05229   <a class="code" href="tracef_8h.html#a70d339a461f334e16086ab23b83cedc4" title="Formatted trace output.">tracef</a> (<span class="stringliteral">&quot;   %s: authenticated\n&quot;</span>, __FUNCTION__);
<a name="l05230"></a>05230 
<a name="l05231"></a>05231   <span class="comment">/* Get the UUIDs of the slave resources. */</span>
<a name="l05232"></a>05232 
<a name="l05233"></a>05233   <span class="keywordflow">if</span> (omp_get_tasks (&amp;session, <a class="code" href="manage_8c.html#a8d6c21512d60b5170ea6483bc993f197" title="Slave task UUID.">slave_task_uuid</a>, 0, 0, &amp;get_tasks))
<a name="l05234"></a>05234     <span class="keywordflow">goto</span> fail;
<a name="l05235"></a>05235 
<a name="l05236"></a>05236   task = entity_child (get_tasks, <span class="stringliteral">&quot;task&quot;</span>);
<a name="l05237"></a>05237   <span class="keywordflow">if</span> (task == NULL)
<a name="l05238"></a>05238     <span class="keywordflow">goto</span> fail_free_task;
<a name="l05239"></a>05239 
<a name="l05240"></a>05240   entity = entity_child (task, <span class="stringliteral">&quot;config&quot;</span>);
<a name="l05241"></a>05241   <span class="keywordflow">if</span> (entity == NULL)
<a name="l05242"></a>05242     <span class="keywordflow">goto</span> fail_free_task;
<a name="l05243"></a>05243   slave_config_uuid = entity_attribute (entity, <span class="stringliteral">&quot;id&quot;</span>);
<a name="l05244"></a>05244 
<a name="l05245"></a>05245   entity = entity_child (task, <span class="stringliteral">&quot;target&quot;</span>);
<a name="l05246"></a>05246   <span class="keywordflow">if</span> (entity == NULL)
<a name="l05247"></a>05247     <span class="keywordflow">goto</span> fail_free_task;
<a name="l05248"></a>05248   slave_target_uuid = entity_attribute (entity, <span class="stringliteral">&quot;id&quot;</span>);
<a name="l05249"></a>05249 
<a name="l05250"></a>05250   <span class="keywordflow">if</span> (omp_get_targets (&amp;session, slave_target_uuid, 0, 0, &amp;get_targets))
<a name="l05251"></a>05251     <span class="keywordflow">goto</span> fail_free_task;
<a name="l05252"></a>05252 
<a name="l05253"></a>05253   entity = entity_child (get_targets, <span class="stringliteral">&quot;target&quot;</span>);
<a name="l05254"></a>05254   <span class="keywordflow">if</span> (entity == NULL)
<a name="l05255"></a>05255     <span class="keywordflow">goto</span> fail_free;
<a name="l05256"></a>05256 
<a name="l05257"></a>05257   credential = entity_child (entity, <span class="stringliteral">&quot;ssh_lsc_credential&quot;</span>);
<a name="l05258"></a>05258   <span class="keywordflow">if</span> (credential == NULL)
<a name="l05259"></a>05259     <span class="keywordflow">goto</span> fail_free;
<a name="l05260"></a>05260   slave_ssh_credential_uuid = entity_attribute (credential, <span class="stringliteral">&quot;id&quot;</span>);
<a name="l05261"></a>05261 
<a name="l05262"></a>05262   credential = entity_child (entity, <span class="stringliteral">&quot;smb_lsc_credential&quot;</span>);
<a name="l05263"></a>05263   <span class="keywordflow">if</span> (credential == NULL)
<a name="l05264"></a>05264     <span class="keywordflow">goto</span> fail_free;
<a name="l05265"></a>05265   slave_smb_credential_uuid = entity_attribute (credential, <span class="stringliteral">&quot;id&quot;</span>);
<a name="l05266"></a>05266 
<a name="l05267"></a>05267   <span class="comment">/* Remove the slave resources. */</span>
<a name="l05268"></a>05268 
<a name="l05269"></a>05269   omp_stop_task (&amp;session, <a class="code" href="manage_8c.html#a8d6c21512d60b5170ea6483bc993f197" title="Slave task UUID.">slave_task_uuid</a>);
<a name="l05270"></a>05270   <span class="keywordflow">if</span> (omp_delete_task_ext (&amp;session, <a class="code" href="manage_8c.html#a8d6c21512d60b5170ea6483bc993f197" title="Slave task UUID.">slave_task_uuid</a>, del_opts))
<a name="l05271"></a>05271     <span class="keywordflow">goto</span> fail_config;
<a name="l05272"></a>05272   <span class="keywordflow">if</span> (omp_delete_config_ext (&amp;session, slave_config_uuid, del_opts))
<a name="l05273"></a>05273     <span class="keywordflow">goto</span> fail_target;
<a name="l05274"></a>05274   <span class="keywordflow">if</span> (omp_delete_target_ext (&amp;session, slave_target_uuid, del_opts))
<a name="l05275"></a>05275     <span class="keywordflow">goto</span> fail_credential;
<a name="l05276"></a>05276   <span class="keywordflow">if</span> (omp_delete_lsc_credential_ext (&amp;session, slave_smb_credential_uuid,
<a name="l05277"></a>05277                                      del_opts))
<a name="l05278"></a>05278     <span class="keywordflow">goto</span> fail;
<a name="l05279"></a>05279   <span class="keywordflow">if</span> (omp_delete_lsc_credential_ext (&amp;session, slave_ssh_credential_uuid,
<a name="l05280"></a>05280                                      del_opts))
<a name="l05281"></a>05281     <span class="keywordflow">goto</span> fail;
<a name="l05282"></a>05282 
<a name="l05283"></a>05283   <span class="comment">/* Cleanup. */</span>
<a name="l05284"></a>05284 
<a name="l05285"></a>05285   free_entity (get_targets);
<a name="l05286"></a>05286   free_entity (get_tasks);
<a name="l05287"></a>05287   openvas_server_close (socket, session);
<a name="l05288"></a>05288   <span class="keywordflow">return</span> 0;
<a name="l05289"></a>05289 
<a name="l05290"></a>05290  fail_config:
<a name="l05291"></a>05291   omp_delete_config_ext (&amp;session, slave_config_uuid, del_opts);
<a name="l05292"></a>05292  fail_target:
<a name="l05293"></a>05293   omp_delete_target_ext (&amp;session, slave_target_uuid, del_opts);
<a name="l05294"></a>05294  fail_credential:
<a name="l05295"></a>05295   omp_delete_lsc_credential_ext (&amp;session, slave_smb_credential_uuid, del_opts);
<a name="l05296"></a>05296   omp_delete_lsc_credential_ext (&amp;session, slave_ssh_credential_uuid, del_opts);
<a name="l05297"></a>05297  fail_free:
<a name="l05298"></a>05298   free_entity (get_targets);
<a name="l05299"></a>05299  fail_free_task:
<a name="l05300"></a>05300   free_entity (get_tasks);
<a name="l05301"></a>05301  fail:
<a name="l05302"></a>05302   openvas_server_close (socket, session);
<a name="l05303"></a>05303   <span class="keywordflow">return</span> -1;
<a name="l05304"></a>05304 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="aef51ca9de1b1ef35454f451584de9df3"></a><!-- doxytag: member="manage.c::event_description" ref="aef51ca9de1b1ef35454f451584de9df3" args="(event_t event, const void *event_data, const char *task_name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gchar* event_description </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="manage_8h.html#a2fb9b58e4e5f14f40af8b4a1425841f8">event_t</a>&nbsp;</td>
          <td class="paramname"> <em>event</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const void *&nbsp;</td>
          <td class="paramname"> <em>event_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>task_name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get a description of an alert event. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>event</em>&nbsp;</td><td>Event. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>event_data</em>&nbsp;</td><td>Event data. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>task_name</em>&nbsp;</td><td>Name of task if required in description, else NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Freshly allocated description of event. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00872">872</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00307">EVENT_TASK_RUN_STATUS_CHANGED</a>, and <a class="el" href="manage_8c_source.html#l00979">run_status_name()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00873"></a>00873 {
<a name="l00874"></a>00874   <span class="keywordflow">switch</span> (event)
<a name="l00875"></a>00875     {
<a name="l00876"></a>00876       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#a2fb9b58e4e5f14f40af8b4a1425841f8a500e04f429b10ceabf42bb1578d291be">EVENT_TASK_RUN_STATUS_CHANGED</a>:
<a name="l00877"></a>00877         <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#a721a440abdd3dfcf69c768e2fcaa6049" title="Return the name of a task.">task_name</a>)
<a name="l00878"></a>00878           <span class="keywordflow">return</span> g_strdup_printf
<a name="l00879"></a>00879                   (<span class="stringliteral">&quot;The security scan task &apos;%s&apos; changed status to &apos;%s&apos;&quot;</span>,
<a name="l00880"></a>00880                    <a class="code" href="manage_8h.html#a721a440abdd3dfcf69c768e2fcaa6049" title="Return the name of a task.">task_name</a>,
<a name="l00881"></a>00881                    <a class="code" href="manage_8c.html#a8fd61b9a4fc00435cccfc0a13dba3378" title="Get the name of a run status.">run_status_name</a> ((<a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65" title="Task statuses, also used as scan/report statuses.">task_status_t</a>) event_data));
<a name="l00882"></a>00882         <span class="keywordflow">return</span> g_strdup_printf (<span class="stringliteral">&quot;Task status changed to &apos;%s&apos;&quot;</span>,
<a name="l00883"></a>00883                                 <a class="code" href="manage_8c.html#a8fd61b9a4fc00435cccfc0a13dba3378" title="Get the name of a run status.">run_status_name</a> ((<a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65" title="Task statuses, also used as scan/report statuses.">task_status_t</a>) event_data));
<a name="l00884"></a>00884         <span class="keywordflow">break</span>;
<a name="l00885"></a>00885       <span class="keywordflow">default</span>:
<a name="l00886"></a>00886         <span class="keywordflow">return</span> g_strdup (<span class="stringliteral">&quot;Internal Error&quot;</span>);
<a name="l00887"></a>00887     }
<a name="l00888"></a>00888 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a7ce585eed4a3949bb5d225e3387fbd28"></a><!-- doxytag: member="manage.c::event_from_name" ref="a7ce585eed4a3949bb5d225e3387fbd28" args="(const char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="manage_8h.html#a2fb9b58e4e5f14f40af8b4a1425841f8">event_t</a> event_from_name </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get an event from a name. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>Event name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The event. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00938">938</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00306">EVENT_ERROR</a>, and <a class="el" href="manage_8h_source.html#l00307">EVENT_TASK_RUN_STATUS_CHANGED</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00939"></a>00939 {
<a name="l00940"></a>00940   <span class="keywordflow">if</span> (strcasecmp (<a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>, <span class="stringliteral">&quot;Task run status changed&quot;</span>) == 0)
<a name="l00941"></a>00941     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a2fb9b58e4e5f14f40af8b4a1425841f8a500e04f429b10ceabf42bb1578d291be">EVENT_TASK_RUN_STATUS_CHANGED</a>;
<a name="l00942"></a>00942   <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a2fb9b58e4e5f14f40af8b4a1425841f8aa45fa5ecff86270d410d4c89c527898a">EVENT_ERROR</a>;
<a name="l00943"></a>00943 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5bfdf19a40b56addb2b0d9cf061d6f17"></a><!-- doxytag: member="manage.c::event_name" ref="a5bfdf19a40b56addb2b0d9cf061d6f17" args="(event_t event)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* event_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="manage_8h.html#a2fb9b58e4e5f14f40af8b4a1425841f8">event_t</a>&nbsp;</td>
          <td class="paramname"> <em>event</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the name of an alert event. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>event</em>&nbsp;</td><td>Event.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The name of the event (for example, "Run status changed"). </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00816">816</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00307">EVENT_TASK_RUN_STATUS_CHANGED</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00817"></a>00817 {
<a name="l00818"></a>00818   <span class="keywordflow">switch</span> (event)
<a name="l00819"></a>00819     {
<a name="l00820"></a>00820       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#a2fb9b58e4e5f14f40af8b4a1425841f8a500e04f429b10ceabf42bb1578d291be">EVENT_TASK_RUN_STATUS_CHANGED</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;Task run status changed&quot;</span>;
<a name="l00821"></a>00821       <span class="keywordflow">default</span>:                            <span class="keywordflow">return</span> <span class="stringliteral">&quot;Internal Error&quot;</span>;
<a name="l00822"></a>00822     }
<a name="l00823"></a>00823 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a7ad302d9d83e31ca46b00b8c20646879"></a><!-- doxytag: member="manage.c::file_iterator_content_64" ref="a7ad302d9d83e31ca46b00b8c20646879" args="(file_iterator_t *iterator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gchar* file_iterator_content_64 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfile__iterator__t.html">file_iterator_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the file contents from a file iterator. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>iterator</em>&nbsp;</td><td>Iterator.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Freshly allocated file contents, in base64. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05076">5076</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l02358">file_iterator_t::current</a>, and <a class="el" href="manage_8h_source.html#l02359">file_iterator_t::dir_name</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l40106">verify_report_format_internal()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05077"></a>05077 {
<a name="l05078"></a>05078   gchar *path_name, *content;
<a name="l05079"></a>05079   GError *error;
<a name="l05080"></a>05080   gsize content_size;
<a name="l05081"></a>05081 
<a name="l05082"></a>05082   path_name = g_build_filename (iterator-&gt;<a class="code" href="structfile__iterator__t.html#ab93c5216864438b256d596db6149a9f5" title="Dir holding files.">dir_name</a>,
<a name="l05083"></a>05083                                 (gchar*) *iterator-&gt;<a class="code" href="structfile__iterator__t.html#a47f952665998ffcaef59a7bd2be9433c" title="Current file.">current</a>,
<a name="l05084"></a>05084                                 NULL);
<a name="l05085"></a>05085 
<a name="l05086"></a>05086   <span class="comment">/* Read in the contents. */</span>
<a name="l05087"></a>05087 
<a name="l05088"></a>05088   error = NULL;
<a name="l05089"></a>05089   <span class="keywordflow">if</span> (g_file_get_contents (path_name,
<a name="l05090"></a>05090                            &amp;content,
<a name="l05091"></a>05091                            &amp;content_size,
<a name="l05092"></a>05092                            &amp;error)
<a name="l05093"></a>05093       == FALSE)
<a name="l05094"></a>05094     {
<a name="l05095"></a>05095       <span class="keywordflow">if</span> (error)
<a name="l05096"></a>05096         {
<a name="l05097"></a>05097           g_debug (<span class="stringliteral">&quot;%s: failed to read %s: %s&quot;</span>,
<a name="l05098"></a>05098                    __FUNCTION__, path_name, error-&gt;message);
<a name="l05099"></a>05099           g_error_free (error);
<a name="l05100"></a>05100         }
<a name="l05101"></a>05101       g_free (path_name);
<a name="l05102"></a>05102       <span class="keywordflow">return</span> NULL;
<a name="l05103"></a>05103     }
<a name="l05104"></a>05104 
<a name="l05105"></a>05105   g_free (path_name);
<a name="l05106"></a>05106 
<a name="l05107"></a>05107   <span class="comment">/* Base64 encode the contents. */</span>
<a name="l05108"></a>05108 
<a name="l05109"></a>05109   <span class="keywordflow">if</span> (content &amp;&amp; (content_size &gt; 0))
<a name="l05110"></a>05110     {
<a name="l05111"></a>05111       gchar *base64 = g_base64_encode ((guchar*) content, content_size);
<a name="l05112"></a>05112       g_free (content);
<a name="l05113"></a>05113       <span class="keywordflow">return</span> base64;
<a name="l05114"></a>05114     }
<a name="l05115"></a>05115 
<a name="l05116"></a>05116   <span class="keywordflow">return</span> content;
<a name="l05117"></a>05117 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a8c523f7882cbf51169bebd7fb7929fa6"></a><!-- doxytag: member="manage.c::file_iterator_name" ref="a8c523f7882cbf51169bebd7fb7929fa6" args="(file_iterator_t *iterator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* file_iterator_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfile__iterator__t.html">file_iterator_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the name from a file iterator. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>iterator</em>&nbsp;</td><td>Iterator.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>File name. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05063">5063</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l02358">file_iterator_t::current</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l40106">verify_report_format_internal()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05064"></a>05064 {
<a name="l05065"></a>05065   <span class="keywordflow">return</span> (<span class="keyword">const</span> <span class="keywordtype">char</span>*) *iterator-&gt;<a class="code" href="structfile__iterator__t.html#a47f952665998ffcaef59a7bd2be9433c" title="Current file.">current</a>;
<a name="l05066"></a>05066 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ad5caf732b373ede69a1717662e040cb7"></a><!-- doxytag: member="manage.c::get_nvti_xml" ref="ad5caf732b373ede69a1717662e040cb7" args="(iterator_t *nvts, int details, int pref_count, const char *timeout, int close_tag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gchar* get_nvti_xml </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structiterator__t.html">iterator_t</a> *&nbsp;</td>
          <td class="paramname"> <em>nvts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>details</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>pref_count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>timeout</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>close_tag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Create and return XML description for an NVT. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>nvts</em>&nbsp;</td><td>The NVT. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>details</em>&nbsp;</td><td>If true, detailed XML, else simple XML. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pref_count</em>&nbsp;</td><td>Preference count. Used if details is true. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>timeout</em>&nbsp;</td><td>Timeout. Used if details is true. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>close_tag</em>&nbsp;</td><td>Wether to close the NVT tag or not.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A dynamically allocated string containing the XML description. </dd></dl>

<p><dl class="todo"><dt><b><a class="el" href="todo.html#_todo000012">Todo:</a></b></dt><dd>Implement checksum. </dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000013">Todo:</a></b></dt><dd>Implement checksum. </dd></dl>
</p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05564">5564</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="sql_8c_source.html#l02228">cleanup_iterator()</a>, <a class="el" href="manage_8c_source.html#l05546">DEF</a>, <a class="el" href="manage_8h.html#ab66c2fa53aa80ec6e24e71b15d4a1165">get_iterator_creation_time()</a>, <a class="el" href="manage_8h.html#ad7335ba899326c1f13499e22c4251f6f">get_iterator_modification_time()</a>, <a class="el" href="manage_8h.html#a86424591691c9091f97847a0c8a96f3b">get_iterator_name()</a>, <a class="el" href="manage__sql_8c_source.html#l35370">get_iterator_resource()</a>, <a class="el" href="manage__sql_8c_source.html#l49561">init_nvt_dfn_cert_adv_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l51790">init_resource_tag_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l48896">manage_cert_loaded()</a>, <a class="el" href="sql_8c_source.html#l02253">next()</a>, <a class="el" href="manage_8h.html#a7f6fb30365672ad3c60e7a7adeb87b30">nvt_iterator_bid()</a>, <a class="el" href="manage__sql_8c_source.html#l31100">nvt_iterator_category()</a>, <a class="el" href="manage_8h.html#a3f778d80f0ef5c146ab3d7e4bb8aa40a">nvt_iterator_cve()</a>, <a class="el" href="manage_8h.html#ab45d0ed19398353c254215c0ae55307f">nvt_iterator_cvss_base()</a>, <a class="el" href="manage_8h.html#a4af75eecd71e97cfc7d7226898322abe">nvt_iterator_name()</a>, <a class="el" href="manage_8h.html#a250ce422acda40bd16192e1f27f1039e">nvt_iterator_oid()</a>, <a class="el" href="manage__sql_8c_source.html#l51869">resource_tag_count()</a>, <a class="el" href="manage_8h.html#a81887b2287ae4b0e84eeffb520e93018">resource_tag_iterator_comment()</a>, <a class="el" href="manage_8h.html#a0133db5d350d3502c4c11892e425a06d">resource_tag_iterator_name()</a>, <a class="el" href="manage_8h.html#ac750e14aedb93d78048980e597f4df8f">resource_tag_iterator_uuid()</a>, and <a class="el" href="manage_8h.html#a3f44cd106b8e105ee3958154ff066c03">resource_tag_iterator_value()</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l05778">manage_read_info()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05566"></a>05566 {
<a name="l05567"></a>05567   <span class="keyword">const</span> <span class="keywordtype">char</span>* oid = <a class="code" href="manage_8h.html#a250ce422acda40bd16192e1f27f1039e">nvt_iterator_oid</a> (nvts);
<a name="l05568"></a>05568   <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a> = <a class="code" href="manage_8h.html#a4af75eecd71e97cfc7d7226898322abe">nvt_iterator_name</a> (nvts);
<a name="l05569"></a>05569   gchar* msg;
<a name="l05570"></a>05570 
<a name="l05571"></a>05571   gchar* name_text = g_markup_escape_text (name, strlen (name));
<a name="l05572"></a>05572   <span class="keywordflow">if</span> (details)
<a name="l05573"></a>05573     {
<a name="l05574"></a>05574       GString *cert_refs_str, *tags_str;
<a name="l05575"></a>05575       <a class="code" href="structiterator__t.html" title="A generic SQL iterator.">iterator_t</a> cert_refs_iterator, tags;
<a name="l05576"></a>05576       gchar *tag_name_esc, *tag_value_esc, *tag_comment_esc;
<a name="l05577"></a>05577 
<a name="l05578"></a>05578 <span class="preprocessor">#ifndef S_SPLINT_S</span>
<a name="l05579"></a>05579 <span class="preprocessor"></span>      <a class="code" href="manage_8c.html#a14992bf8bee7c290dd716d865c47ae42" title="Define a code snippet for get_nvti_xml.">DEF</a> (copyright);
<a name="l05580"></a>05580       <a class="code" href="manage_8c.html#a14992bf8bee7c290dd716d865c47ae42" title="Define a code snippet for get_nvti_xml.">DEF</a> (summary);
<a name="l05581"></a>05581       <a class="code" href="manage_8c.html#a14992bf8bee7c290dd716d865c47ae42" title="Define a code snippet for get_nvti_xml.">DEF</a> (family);
<a name="l05582"></a>05582       <a class="code" href="manage_8c.html#a14992bf8bee7c290dd716d865c47ae42" title="Define a code snippet for get_nvti_xml.">DEF</a> (version);
<a name="l05583"></a>05583       <a class="code" href="manage_8c.html#a14992bf8bee7c290dd716d865c47ae42" title="Define a code snippet for get_nvti_xml.">DEF</a> (xref);
<a name="l05584"></a>05584       <a class="code" href="manage_8c.html#a14992bf8bee7c290dd716d865c47ae42" title="Define a code snippet for get_nvti_xml.">DEF</a> (tag);
<a name="l05585"></a>05585 <span class="preprocessor">#endif </span><span class="comment">/* not S_SPLINT_S */</span>
<a name="l05586"></a>05586 
<a name="l05587"></a>05587 <span class="preprocessor">#undef DEF</span>
<a name="l05588"></a>05588 <span class="preprocessor"></span>
<a name="l05589"></a>05589       cert_refs_str = g_string_new (<span class="stringliteral">&quot;&quot;</span>);
<a name="l05590"></a>05590       <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#a7bdad6631a798ba09543b2c38388c515" title="Check whether CERT is available.">manage_cert_loaded</a>())
<a name="l05591"></a>05591         {
<a name="l05592"></a>05592           <a class="code" href="manage_8h.html#a1eddb2476c6e3a95e8e8f5aa45b588fe" title="Initialise an DFN-CERT iterator, for advisories relevant to a NVT.">init_nvt_dfn_cert_adv_iterator</a> (&amp;cert_refs_iterator, oid, 0, 0);
<a name="l05593"></a>05593           <span class="keywordflow">while</span> (<a class="code" href="manage_8h.html#a821a1a0d4e2daaa3fb6a485ebf0ac67a" title="Increment an iterator.">next</a> (&amp;cert_refs_iterator))
<a name="l05594"></a>05594             {
<a name="l05595"></a>05595               g_string_append_printf (cert_refs_str,
<a name="l05596"></a>05596                                       <span class="stringliteral">&quot;&lt;cert_ref type=\&quot;DFN-CERT\&quot; id=\&quot;%s\&quot;/&gt;&quot;</span>,
<a name="l05597"></a>05597                                       <a class="code" href="manage_8h.html#a86424591691c9091f97847a0c8a96f3b">get_iterator_name</a> (&amp;cert_refs_iterator));
<a name="l05598"></a>05598           }
<a name="l05599"></a>05599           <a class="code" href="manage_8h.html#aa98d17659363974764692d019f4d8172" title="Cleanup an iterator.">cleanup_iterator</a> (&amp;cert_refs_iterator);
<a name="l05600"></a>05600         }
<a name="l05601"></a>05601       <span class="keywordflow">else</span>
<a name="l05602"></a>05602         {
<a name="l05603"></a>05603           g_string_append(cert_refs_str, <span class="stringliteral">&quot;&lt;warning&gt;database not available&lt;/warning&gt;&quot;</span>);
<a name="l05604"></a>05604         }
<a name="l05605"></a>05605 
<a name="l05606"></a>05606       tags_str = g_string_new (<span class="stringliteral">&quot;&quot;</span>);
<a name="l05607"></a>05607       g_string_append_printf (tags_str,
<a name="l05608"></a>05608                               <span class="stringliteral">&quot;&lt;count&gt;%i&lt;/count&gt;&quot;</span>,
<a name="l05609"></a>05609                               <a class="code" href="manage_8h.html#aaf843cf55d9a32fa01e7663e921497c9" title="Count number of tags attached to a resource.">resource_tag_count</a> (<span class="stringliteral">&quot;nvt&quot;</span>,
<a name="l05610"></a>05610                                                   <a class="code" href="manage_8h.html#aad2f0490b4b0b32ae37fa10a73336cdb" title="Get the resource from a GET iterator.">get_iterator_resource</a>
<a name="l05611"></a>05611                                                     (nvts),
<a name="l05612"></a>05612                                                   1));
<a name="l05613"></a>05613 
<a name="l05614"></a>05614       <a class="code" href="manage_8h.html#a1ddc64e981362a3f12dd5947e5157aa1" title="Initialise a iterator of tags attached to a resource.">init_resource_tag_iterator</a> (&amp;tags, <span class="stringliteral">&quot;nvt&quot;</span>,
<a name="l05615"></a>05615                                   <a class="code" href="manage_8h.html#aad2f0490b4b0b32ae37fa10a73336cdb" title="Get the resource from a GET iterator.">get_iterator_resource</a> (nvts),
<a name="l05616"></a>05616                                   1, NULL, 1);
<a name="l05617"></a>05617       <span class="keywordflow">while</span> (<a class="code" href="manage_8h.html#a821a1a0d4e2daaa3fb6a485ebf0ac67a" title="Increment an iterator.">next</a> (&amp;tags))
<a name="l05618"></a>05618         {
<a name="l05619"></a>05619           tag_name_esc = g_markup_escape_text (<a class="code" href="manage_8h.html#a0133db5d350d3502c4c11892e425a06d">resource_tag_iterator_name</a>
<a name="l05620"></a>05620                                                 (&amp;tags),
<a name="l05621"></a>05621                                                -1);
<a name="l05622"></a>05622           tag_value_esc = g_markup_escape_text (<a class="code" href="manage_8h.html#a3f44cd106b8e105ee3958154ff066c03">resource_tag_iterator_value</a>
<a name="l05623"></a>05623                                                   (&amp;tags),
<a name="l05624"></a>05624                                                 -1);
<a name="l05625"></a>05625           tag_comment_esc = g_markup_escape_text (<a class="code" href="manage_8h.html#a81887b2287ae4b0e84eeffb520e93018">resource_tag_iterator_comment</a>
<a name="l05626"></a>05626                                                     (&amp;tags),
<a name="l05627"></a>05627                                                   -1);
<a name="l05628"></a>05628           g_string_append_printf (tags_str,
<a name="l05629"></a>05629                                   <span class="stringliteral">&quot;&lt;tag id=\&quot;%s\&quot;&gt;&quot;</span>
<a name="l05630"></a>05630                                   <span class="stringliteral">&quot;&lt;name&gt;%s&lt;/name&gt;&quot;</span>
<a name="l05631"></a>05631                                   <span class="stringliteral">&quot;&lt;value&gt;%s&lt;/value&gt;&quot;</span>
<a name="l05632"></a>05632                                   <span class="stringliteral">&quot;&lt;comment&gt;%s&lt;/comment&gt;&quot;</span>
<a name="l05633"></a>05633                                   <span class="stringliteral">&quot;&lt;/tag&gt;&quot;</span>,
<a name="l05634"></a>05634                                   <a class="code" href="manage_8h.html#ac750e14aedb93d78048980e597f4df8f">resource_tag_iterator_uuid</a> (&amp;tags),
<a name="l05635"></a>05635                                   tag_name_esc,
<a name="l05636"></a>05636                                   tag_value_esc,
<a name="l05637"></a>05637                                   tag_comment_esc);
<a name="l05638"></a>05638           g_free (tag_name_esc);
<a name="l05639"></a>05639           g_free (tag_value_esc);
<a name="l05640"></a>05640           g_free (tag_comment_esc);
<a name="l05641"></a>05641         }
<a name="l05642"></a>05642       <a class="code" href="manage_8h.html#aa98d17659363974764692d019f4d8172" title="Cleanup an iterator.">cleanup_iterator</a> (&amp;tags);
<a name="l05643"></a>05643 
<a name="l05644"></a>05644       msg = g_strdup_printf (<span class="stringliteral">&quot;&lt;nvt&quot;</span>
<a name="l05645"></a>05645                              <span class="stringliteral">&quot; oid=\&quot;%s\&quot;&gt;&quot;</span>
<a name="l05646"></a>05646                              <span class="stringliteral">&quot;&lt;name&gt;%s&lt;/name&gt;&quot;</span>
<a name="l05647"></a>05647                              <span class="stringliteral">&quot;&lt;creation_time&gt;%s&lt;/creation_time&gt;&quot;</span>
<a name="l05648"></a>05648                              <span class="stringliteral">&quot;&lt;modification_time&gt;%s&lt;/modification_time&gt;&quot;</span>
<a name="l05649"></a>05649                              <span class="stringliteral">&quot;&lt;user_tags&gt;%s&lt;/user_tags&gt;&quot;</span>
<a name="l05650"></a>05650                              <span class="stringliteral">&quot;&lt;category&gt;%s&lt;/category&gt;&quot;</span>
<a name="l05651"></a>05651                              <span class="stringliteral">&quot;&lt;copyright&gt;%s&lt;/copyright&gt;&quot;</span>
<a name="l05652"></a>05652                              <span class="stringliteral">&quot;&lt;summary&gt;%s&lt;/summary&gt;&quot;</span>
<a name="l05653"></a>05653                              <span class="stringliteral">&quot;&lt;family&gt;%s&lt;/family&gt;&quot;</span>
<a name="l05654"></a>05654                              <span class="stringliteral">&quot;&lt;version&gt;%s&lt;/version&gt;&quot;</span>
<a name="l05655"></a>05655                              <span class="stringliteral">&quot;&lt;cvss_base&gt;%s&lt;/cvss_base&gt;&quot;</span>
<a name="l05656"></a>05656                              <span class="stringliteral">&quot;&lt;cve_id&gt;%s&lt;/cve_id&gt;&quot;</span>
<a name="l05657"></a>05657                              <span class="stringliteral">&quot;&lt;bugtraq_id&gt;%s&lt;/bugtraq_id&gt;&quot;</span>
<a name="l05658"></a>05658                              <span class="stringliteral">&quot;&lt;cert_refs&gt;%s&lt;/cert_refs&gt;&quot;</span>
<a name="l05659"></a>05659                              <span class="stringliteral">&quot;&lt;xrefs&gt;%s&lt;/xrefs&gt;&quot;</span>
<a name="l05660"></a>05660                              <span class="stringliteral">&quot;&lt;tags&gt;%s&lt;/tags&gt;&quot;</span>
<a name="l05661"></a>05661                              <span class="stringliteral">&quot;&lt;preference_count&gt;%i&lt;/preference_count&gt;&quot;</span>
<a name="l05662"></a>05662                              <span class="stringliteral">&quot;&lt;timeout&gt;%s&lt;/timeout&gt;&quot;</span>
<a name="l05663"></a>05663                              <span class="stringliteral">&quot;&lt;checksum&gt;&quot;</span>
<a name="l05664"></a>05664                              <span class="stringliteral">&quot;&lt;algorithm&gt;md5&lt;/algorithm&gt;&quot;</span>
<a name="l05666"></a>05666                              <span class="stringliteral">&quot;2397586ea5cd3a69f953836f7be9ef7b&quot;</span>
<a name="l05667"></a>05667                              <span class="stringliteral">&quot;&lt;/checksum&gt;%s&quot;</span>,
<a name="l05668"></a>05668                              oid,
<a name="l05669"></a>05669                              name_text,
<a name="l05670"></a>05670                              <a class="code" href="manage_8h.html#ab66c2fa53aa80ec6e24e71b15d4a1165">get_iterator_creation_time</a> (nvts)
<a name="l05671"></a>05671                               ? <a class="code" href="manage_8h.html#ab66c2fa53aa80ec6e24e71b15d4a1165">get_iterator_creation_time</a> (nvts)
<a name="l05672"></a>05672                               : <span class="stringliteral">&quot;&quot;</span>,
<a name="l05673"></a>05673                              <a class="code" href="manage_8h.html#ad7335ba899326c1f13499e22c4251f6f">get_iterator_modification_time</a> (nvts)
<a name="l05674"></a>05674                               ? <a class="code" href="manage_8h.html#ad7335ba899326c1f13499e22c4251f6f">get_iterator_modification_time</a> (nvts)
<a name="l05675"></a>05675                               : <span class="stringliteral">&quot;&quot;</span>,
<a name="l05676"></a>05676                              tags_str-&gt;str,
<a name="l05677"></a>05677                              category_name (<a class="code" href="manage_8h.html#a608519b375fbf05eb906227859c4a67c" title="Get the category from an NVT iterator.">nvt_iterator_category</a> (nvts)),
<a name="l05678"></a>05678                              copyright_text,
<a name="l05679"></a>05679                              summary_text,
<a name="l05680"></a>05680                              family_text,
<a name="l05681"></a>05681                              version_text,
<a name="l05682"></a>05682                              <a class="code" href="manage_8h.html#ab45d0ed19398353c254215c0ae55307f">nvt_iterator_cvss_base</a> (nvts)
<a name="l05683"></a>05683                               ? <a class="code" href="manage_8h.html#ab45d0ed19398353c254215c0ae55307f">nvt_iterator_cvss_base</a> (nvts)
<a name="l05684"></a>05684                               : <span class="stringliteral">&quot;&quot;</span>,
<a name="l05685"></a>05685                              <a class="code" href="manage_8h.html#a3f778d80f0ef5c146ab3d7e4bb8aa40a">nvt_iterator_cve</a> (nvts),
<a name="l05686"></a>05686                              <a class="code" href="manage_8h.html#a7f6fb30365672ad3c60e7a7adeb87b30">nvt_iterator_bid</a> (nvts),
<a name="l05687"></a>05687                              cert_refs_str-&gt;str,
<a name="l05688"></a>05688                              xref_text,
<a name="l05689"></a>05689                              tag_text,
<a name="l05690"></a>05690                              pref_count,
<a name="l05691"></a>05691                              timeout ? timeout : <span class="stringliteral">&quot;&quot;</span>,
<a name="l05692"></a>05692                              close_tag ? <span class="stringliteral">&quot;&lt;/nvt&gt;&quot;</span> : <span class="stringliteral">&quot;&quot;</span>);
<a name="l05693"></a>05693       g_free (copyright_text);
<a name="l05694"></a>05694       g_free (summary_text);
<a name="l05695"></a>05695       g_free (family_text);
<a name="l05696"></a>05696       g_free (version_text);
<a name="l05697"></a>05697       g_free (xref_text);
<a name="l05698"></a>05698       g_free (tag_text);
<a name="l05699"></a>05699       g_string_free(cert_refs_str, 1);
<a name="l05700"></a>05700       g_string_free(tags_str, 1);
<a name="l05701"></a>05701 
<a name="l05702"></a>05702     }
<a name="l05703"></a>05703   <span class="keywordflow">else</span>
<a name="l05704"></a>05704     msg = g_strdup_printf (<span class="stringliteral">&quot;&lt;nvt&quot;</span>
<a name="l05705"></a>05705                            <span class="stringliteral">&quot; oid=\&quot;%s\&quot;&gt;&quot;</span>
<a name="l05706"></a>05706                            <span class="stringliteral">&quot;&lt;name&gt;%s&lt;/name&gt;&quot;</span>
<a name="l05707"></a>05707                            <span class="stringliteral">&quot;&lt;user_tags&gt;&quot;</span>
<a name="l05708"></a>05708                            <span class="stringliteral">&quot;&lt;count&gt;%i&lt;/count&gt;&quot;</span>
<a name="l05709"></a>05709                            <span class="stringliteral">&quot;&lt;/user_tags&gt;&quot;</span>
<a name="l05710"></a>05710                            <span class="stringliteral">&quot;&lt;checksum&gt;&quot;</span>
<a name="l05711"></a>05711                            <span class="stringliteral">&quot;&lt;algorithm&gt;md5&lt;/algorithm&gt;&quot;</span>
<a name="l05713"></a>05713                            <span class="stringliteral">&quot;2397586ea5cd3a69f953836f7be9ef7b&quot;</span>
<a name="l05714"></a>05714                            <span class="stringliteral">&quot;&lt;/checksum&gt;&quot;</span>,
<a name="l05715"></a>05715                            oid,
<a name="l05716"></a>05716                            name_text,
<a name="l05717"></a>05717                            <a class="code" href="manage_8h.html#aaf843cf55d9a32fa01e7663e921497c9" title="Count number of tags attached to a resource.">resource_tag_count</a> (<span class="stringliteral">&quot;nvt&quot;</span>,
<a name="l05718"></a>05718                                                 <a class="code" href="manage_8h.html#aad2f0490b4b0b32ae37fa10a73336cdb" title="Get the resource from a GET iterator.">get_iterator_resource</a>
<a name="l05719"></a>05719                                                   (nvts),
<a name="l05720"></a>05720                                                 1));
<a name="l05721"></a>05721   g_free (name_text);
<a name="l05722"></a>05722   <span class="keywordflow">return</span> msg;
<a name="l05723"></a>05723 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="aed6b0e3f3bc36931c867a29672b2b3f8"></a><!-- doxytag: member="manage.c::get_scheduled_user_uuid" ref="aed6b0e3f3bc36931c867a29672b2b3f8" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gchar* get_scheduled_user_uuid </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Access UUID of user that scheduled the current task. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>UUID of user that scheduled the current task. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04418">4418</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l12494">authenticate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04419"></a>04419 {
<a name="l04420"></a>04420   <span class="keywordflow">return</span> <a class="code" href="manage_8c.html#ac5399296de033331b1694de7bdc03584" title="UUID of user whose scheduled task is to be started (in connection with authenticate_allow_all)...">schedule_user_uuid</a>;
<a name="l04421"></a>04421 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a3cb493dddb2f401e0962224ff259bbaf"></a><!-- doxytag: member="manage.c::init_report_format_file_iterator" ref="a3cb493dddb2f401e0962224ff259bbaf" args="(file_iterator_t *iterator, report_format_t report_format)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_report_format_file_iterator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfile__iterator__t.html">file_iterator_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="manage_8h.html#a15b08a0a17397f430e91bf9ce570e92d">report_format_t</a>&nbsp;</td>
          <td class="paramname"> <em>report_format</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise a report format file iterator. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>iterator</em>&nbsp;</td><td>Iterator. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>report_format</em>&nbsp;</td><td>Single report format to iterate over, NULL for all.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 on error. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04981">4981</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l02358">file_iterator_t::current</a>, <a class="el" href="manage_8h_source.html#l02359">file_iterator_t::dir_name</a>, <a class="el" href="manage__sql_8c_source.html#l40523">report_format_global()</a>, <a class="el" href="manage__sql_8c_source.html#l40351">report_format_owner_uuid()</a>, <a class="el" href="manage__sql_8c_source.html#l40336">report_format_uuid()</a>, and <a class="el" href="manage_8h_source.html#l02357">file_iterator_t::start</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l40106">verify_report_format_internal()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04983"></a>04983 {
<a name="l04984"></a>04984   gchar *dir_name, *uuid;
<a name="l04985"></a>04985 
<a name="l04986"></a>04986   uuid = <a class="code" href="manage_8h.html#abca7fa49ee70166185193bb65985d8db" title="Return the UUID of a report format.">report_format_uuid</a> (report_format);
<a name="l04987"></a>04987   <span class="keywordflow">if</span> (uuid == NULL)
<a name="l04988"></a>04988     <span class="keywordflow">return</span> -1;
<a name="l04989"></a>04989 
<a name="l04990"></a>04990   <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#a487dc44dba5a9545db930d55d3e7b05f" title="Return whether a report format is global.">report_format_global</a> (report_format))
<a name="l04991"></a>04991     dir_name = g_build_filename (OPENVAS_DATA_DIR,
<a name="l04992"></a>04992                                  <span class="stringliteral">&quot;openvasmd&quot;</span>,
<a name="l04993"></a>04993                                  <span class="stringliteral">&quot;global_report_formats&quot;</span>,
<a name="l04994"></a>04994                                  uuid,
<a name="l04995"></a>04995                                  NULL);
<a name="l04996"></a>04996   <span class="keywordflow">else</span>
<a name="l04997"></a>04997     {
<a name="l04998"></a>04998       gchar *owner_uuid;
<a name="l04999"></a>04999 
<a name="l05000"></a>05000       owner_uuid = <a class="code" href="manage_8h.html#a086fb74b6d4eab79c8e9000825dbf96d" title="Return the UUID of the owner of a report format.">report_format_owner_uuid</a> (report_format);
<a name="l05001"></a>05001       <span class="keywordflow">if</span> (owner_uuid == NULL)
<a name="l05002"></a>05002         <span class="keywordflow">return</span> -1;
<a name="l05003"></a>05003       dir_name = g_build_filename (OPENVAS_STATE_DIR,
<a name="l05004"></a>05004                                    <span class="stringliteral">&quot;openvasmd&quot;</span>,
<a name="l05005"></a>05005                                    <span class="stringliteral">&quot;report_formats&quot;</span>,
<a name="l05006"></a>05006                                    owner_uuid,
<a name="l05007"></a>05007                                    uuid,
<a name="l05008"></a>05008                                    NULL);
<a name="l05009"></a>05009       g_free (owner_uuid);
<a name="l05010"></a>05010     }
<a name="l05011"></a>05011 
<a name="l05012"></a>05012   g_free (uuid);
<a name="l05013"></a>05013 
<a name="l05014"></a>05014   <span class="keywordflow">if</span> (get_report_format_files (dir_name, &amp;iterator-&gt;<a class="code" href="structfile__iterator__t.html#a2fdaa9abf475aeb2be7f858ea5541577" title="Array of files.">start</a>))
<a name="l05015"></a>05015     {
<a name="l05016"></a>05016       g_free (dir_name);
<a name="l05017"></a>05017       <span class="keywordflow">return</span> -1;
<a name="l05018"></a>05018     }
<a name="l05019"></a>05019 
<a name="l05020"></a>05020   iterator-&gt;<a class="code" href="structfile__iterator__t.html#a47f952665998ffcaef59a7bd2be9433c" title="Current file.">current</a> = iterator-&gt;<a class="code" href="structfile__iterator__t.html#a2fdaa9abf475aeb2be7f858ea5541577" title="Array of files.">start</a>-&gt;pdata;
<a name="l05021"></a>05021   iterator-&gt;<a class="code" href="structfile__iterator__t.html#a47f952665998ffcaef59a7bd2be9433c" title="Current file.">current</a>--;
<a name="l05022"></a>05022   iterator-&gt;<a class="code" href="structfile__iterator__t.html#ab93c5216864438b256d596db6149a9f5" title="Dir holding files.">dir_name</a> = dir_name;
<a name="l05023"></a>05023   <span class="keywordflow">return</span> 0;
<a name="l05024"></a>05024 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="acb2679535c63506b5f7890afb4f455ae"></a><!-- doxytag: member="manage.c::init_severity_data" ref="acb2679535c63506b5f7890afb4f455ae" args="(severity_data_t *data)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void init_severity_data </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structseverity__data__t.html">severity_data_t</a> *&nbsp;</td>
          <td class="paramname"> <em>data</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialize a severity data structure. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>data</em>&nbsp;</td><td>The data structure to initialize. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00593">593</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00808">severity_data_t::counts</a>, <a class="el" href="manage_8h_source.html#l00810">severity_data_t::max</a>, <a class="el" href="manage_8h_source.html#l00781">SEVERITY_MAX</a>, <a class="el" href="manage_8h_source.html#l00777">SEVERITY_MISSING</a>, <a class="el" href="manage_8h_source.html#l00783">SEVERITY_SUBDIVISIONS</a>, <a class="el" href="manage_8h_source.html#l00809">severity_data_t::total</a>, and <a class="el" href="manage_8c_source.html#l00541">ZERO_SEVERITY_INDEX</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00594"></a>00594 {
<a name="l00595"></a>00595   <span class="keywordtype">int</span> max_i;
<a name="l00596"></a>00596   max_i = <a class="code" href="manage_8c.html#a7c415f3910ecba64f28a551e5063de6b">ZERO_SEVERITY_INDEX</a> + (<a class="code" href="manage_8h.html#a79c5e57509c07123c77a8a5a1a4bc31d">SEVERITY_SUBDIVISIONS</a> * <a class="code" href="manage_8h.html#a6f8c43fbdd8da04c1a554cc5dfc09674">SEVERITY_MAX</a>);
<a name="l00597"></a>00597 
<a name="l00598"></a>00598   data-&gt;<a class="code" href="structseverity__data__t.html#a0117bda2dbab5a7423fe42785415835d">counts</a> = g_malloc0 (<span class="keyword">sizeof</span> (<span class="keywordtype">int</span>) * (max_i + 1));
<a name="l00599"></a>00599 
<a name="l00600"></a>00600   data-&gt;<a class="code" href="structseverity__data__t.html#a5ccb9b2b55cc5b505b4a93f333ba9a91">total</a> = 0;
<a name="l00601"></a>00601   data-&gt;<a class="code" href="structseverity__data__t.html#aef1e27cfd8b253e334fa8d2f868a2353">max</a> = <a class="code" href="manage_8h.html#a0092499ecda0b1be8668de33c0206bdf">SEVERITY_MISSING</a>;
<a name="l00602"></a>00602 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a20ff3e739f68ff3a7ed4767335a06bb5"></a><!-- doxytag: member="manage.c::init_system_report_type_iterator" ref="a20ff3e739f68ff3a7ed4767335a06bb5" args="(report_type_iterator_t *iterator, const char *type, const char *slave_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int init_system_report_type_iterator </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structreport__type__iterator__t.html">report_type_iterator_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>slave_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initialise a system report type iterator. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>iterator</em>&nbsp;</td><td>Iterator. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>type</em>&nbsp;</td><td>Single report type to iterate over, NULL for all. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>slave_id</em>&nbsp;</td><td>ID of slave to get reports from. 0 for local.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, 1 failed to find report type, 2 failed to find slave, 3 used the fallback report, 99 permission denied, -1 on error. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04079">4079</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l02074">report_type_iterator_t::current</a>, <a class="el" href="manage_8h_source.html#l02073">report_type_iterator_t::start</a>, and <a class="el" href="manage__acl_8c_source.html#l00050">user_may()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04082"></a>04082 {
<a name="l04083"></a>04083   <span class="keywordtype">int</span> ret;
<a name="l04084"></a>04084 
<a name="l04085"></a>04085   <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#abe056c751dd156a61be8677666039d29" title="Test whether a user may perform an operation.">user_may</a> (<span class="stringliteral">&quot;get_system_reports&quot;</span>) == 0)
<a name="l04086"></a>04086     <span class="keywordflow">return</span> 99;
<a name="l04087"></a>04087 
<a name="l04088"></a>04088   ret = get_system_report_types (type, &amp;iterator-&gt;<a class="code" href="structreport__type__iterator__t.html#ab888bbf8198796f986db6b1d4709f1b5" title="First type.">start</a>, &amp;iterator-&gt;<a class="code" href="structreport__type__iterator__t.html#aef30e4a63f98728f2d7c7db8f7ff9b61" title="Current type.">current</a>,
<a name="l04089"></a>04089                                  slave_id);
<a name="l04090"></a>04090   <span class="keywordflow">if</span> (ret == 0 || ret == 3)
<a name="l04091"></a>04091     {
<a name="l04092"></a>04092       iterator-&gt;<a class="code" href="structreport__type__iterator__t.html#aef30e4a63f98728f2d7c7db8f7ff9b61" title="Current type.">current</a>--;
<a name="l04093"></a>04093       <span class="keywordflow">return</span> ret;
<a name="l04094"></a>04094     }
<a name="l04095"></a>04095   <span class="keywordflow">return</span> ret;
<a name="l04096"></a>04096 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a1842b60bcb15f207748a920ac42d4f57"></a><!-- doxytag: member="manage.c::keyfile_to_auth_conf_settings_xml" ref="a1842b60bcb15f207748a920ac42d4f57" args="(const gchar *filename)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gchar* keyfile_to_auth_conf_settings_xml </td>
          <td>(</td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>filename</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Produce a stripped-down xml representation of a keyfile. </p>
<p>For </p>
<div class="fragment"><pre class="fragment"> [first group]
<span class="preprocessor"> # this comment will be lost</span>
<span class="preprocessor"></span> weather=good
 example=bad
 [empty group]
</pre></div><p> the output will look like </p>
<div class="fragment"><pre class="fragment"> &lt;group <a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>=<span class="stringliteral">&quot;first group&quot;</span>&gt;
 &lt;auth_conf_setting key=<span class="stringliteral">&quot;weather&quot;</span> <a class="code" href="structnamelist__s.html#a2382546248b3fa55432d922fc5076f19">value</a>=<span class="stringliteral">&quot;good&quot;</span>/&gt;
 &lt;auth_conf_setting key=<span class="stringliteral">&quot;example&quot;</span> <a class="code" href="structnamelist__s.html#a2382546248b3fa55432d922fc5076f19">value</a>=<span class="stringliteral">&quot;bad&quot;</span>/&gt;
 &lt;/group&gt;
 &lt;group name=<span class="stringliteral">&quot;empty group&quot;</span>&gt;
 &lt;/group&gt;
</pre></div><dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>filename</em>&nbsp;</td><td>Keyfile to read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>NULL in case of any error, otherwise xml representation of keyfile (free with g_free). </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05889">5889</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05890"></a>05890 {
<a name="l05891"></a>05891   GKeyFile *key_file = g_key_file_new ();
<a name="l05892"></a>05892   GString *response = NULL;
<a name="l05893"></a>05893   gchar **groups = NULL;
<a name="l05894"></a>05894   gchar **group = NULL;
<a name="l05895"></a>05895 
<a name="l05896"></a>05896   <span class="keywordflow">if</span> (g_key_file_load_from_file (key_file, filename, G_KEY_FILE_NONE, NULL)
<a name="l05897"></a>05897       == FALSE)
<a name="l05898"></a>05898     {
<a name="l05899"></a>05899       g_key_file_free (key_file);
<a name="l05900"></a>05900       <span class="keywordflow">return</span> NULL;
<a name="l05901"></a>05901     }
<a name="l05902"></a>05902 
<a name="l05903"></a>05903   response = g_string_new (<span class="stringliteral">&quot;&quot;</span>);
<a name="l05904"></a>05904 
<a name="l05905"></a>05905   groups = g_key_file_get_groups (key_file, NULL);
<a name="l05906"></a>05906 
<a name="l05907"></a>05907   group = groups;
<a name="l05908"></a>05908   <span class="keywordflow">while</span> (*group != NULL)
<a name="l05909"></a>05909     {
<a name="l05910"></a>05910       gchar **keys = g_key_file_get_keys (key_file, *group, NULL, NULL);
<a name="l05911"></a>05911       gchar **key = keys;
<a name="l05912"></a>05912       g_string_append_printf (response, <span class="stringliteral">&quot;&lt;group name=\&quot;%s\&quot;&gt;\n&quot;</span>, *group);
<a name="l05913"></a>05913       <span class="keywordflow">while</span> (*key != NULL)
<a name="l05914"></a>05914         {
<a name="l05915"></a>05915           gchar *<a class="code" href="structnamelist__s.html#a2382546248b3fa55432d922fc5076f19">value</a> = g_key_file_get_value (key_file, *group, *key, NULL);
<a name="l05916"></a>05916           <span class="keywordflow">if</span> (value)
<a name="l05917"></a>05917             g_string_append_printf (response,
<a name="l05918"></a>05918                                     <span class="stringliteral">&quot;&lt;auth_conf_setting key=\&quot;%s\&quot; value=\&quot;%s\&quot;/&gt;&quot;</span>,
<a name="l05919"></a>05919                                     *key, value);
<a name="l05920"></a>05920           g_free (value);
<a name="l05921"></a>05921           key++;
<a name="l05922"></a>05922         }
<a name="l05923"></a>05923       g_strfreev (keys);
<a name="l05924"></a>05924       g_string_append (response, <span class="stringliteral">&quot;&lt;/group&gt;&quot;</span>);
<a name="l05925"></a>05925       group++;
<a name="l05926"></a>05926     }
<a name="l05927"></a>05927 
<a name="l05928"></a>05928   g_strfreev (groups);
<a name="l05929"></a>05929   g_key_file_free (key_file);
<a name="l05930"></a>05930 
<a name="l05931"></a>05931   <span class="keywordflow">return</span> g_string_free (response, FALSE);
<a name="l05932"></a>05932 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a944bb9ece423240e59690aa700f35845"></a><!-- doxytag: member="manage.c::level_max_severity" ref="a944bb9ece423240e59690aa700f35845" args="(const char *level, const gchar *class)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double level_max_severity </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>class</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the minimum severity for a severity level and class. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>level</em>&nbsp;</td><td>The name of the severity level. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>class</em>&nbsp;</td><td>The severity class.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The minimum severity. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00309">309</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00773">SEVERITY_DEBUG</a>, <a class="el" href="manage_8h_source.html#l00775">SEVERITY_ERROR</a>, <a class="el" href="manage_8h_source.html#l00771">SEVERITY_FP</a>, <a class="el" href="manage_8h_source.html#l00769">SEVERITY_LOG</a>, and <a class="el" href="manage_8h_source.html#l00779">SEVERITY_UNDEFINED</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l00692">severity_data_level_counts()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00310"></a>00310 {
<a name="l00311"></a>00311   <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;Log&quot;</span>) == 0)
<a name="l00312"></a>00312     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a9d33ec420648fd2dc6ab5d32e22c783a">SEVERITY_LOG</a>;
<a name="l00313"></a>00313   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;False Positive&quot;</span>) == 0)
<a name="l00314"></a>00314     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a278856677dc1ea57b047dbfc213a7a0b">SEVERITY_FP</a>;
<a name="l00315"></a>00315   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;Debug&quot;</span>) == 0)
<a name="l00316"></a>00316     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a16c5fb5a2e4e400fd8caabc41ed98396">SEVERITY_DEBUG</a>;
<a name="l00317"></a>00317   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;Error&quot;</span>) == 0)
<a name="l00318"></a>00318     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a90b2e06a02b5b39bc00210a97f61ce97">SEVERITY_ERROR</a>;
<a name="l00319"></a>00319   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (<span class="keyword">class</span>, <span class="stringliteral">&quot;classic&quot;</span>) == 0)
<a name="l00320"></a>00320     {
<a name="l00321"></a>00321       <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;high&quot;</span>) == 0)
<a name="l00322"></a>00322         <span class="keywordflow">return</span> 10.0;
<a name="l00323"></a>00323       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;medium&quot;</span>) == 0)
<a name="l00324"></a>00324         <span class="keywordflow">return</span> 5.0;
<a name="l00325"></a>00325       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;low&quot;</span>) == 0)
<a name="l00326"></a>00326         <span class="keywordflow">return</span> 2.0;
<a name="l00327"></a>00327       <span class="keywordflow">else</span>
<a name="l00328"></a>00328         <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a4a1706ad48c3fa5761d57e5384673f37">SEVERITY_UNDEFINED</a>;
<a name="l00329"></a>00329     }
<a name="l00330"></a>00330   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (<span class="keyword">class</span>, <span class="stringliteral">&quot;pci-dss&quot;</span>) == 0)
<a name="l00331"></a>00331     {
<a name="l00332"></a>00332       <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;high&quot;</span>) == 0)
<a name="l00333"></a>00333         <span class="keywordflow">return</span> 10.0;
<a name="l00334"></a>00334       <span class="keywordflow">else</span>
<a name="l00335"></a>00335         <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a4a1706ad48c3fa5761d57e5384673f37">SEVERITY_UNDEFINED</a>;
<a name="l00336"></a>00336     }
<a name="l00337"></a>00337   <span class="keywordflow">else</span>
<a name="l00338"></a>00338     {
<a name="l00339"></a>00339       <span class="comment">/* NIST/BSI. */</span>
<a name="l00340"></a>00340       <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;high&quot;</span>) == 0)
<a name="l00341"></a>00341         <span class="keywordflow">return</span> 10.0;
<a name="l00342"></a>00342       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;medium&quot;</span>) == 0)
<a name="l00343"></a>00343         <span class="keywordflow">return</span> 6.9;
<a name="l00344"></a>00344       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;low&quot;</span>) == 0)
<a name="l00345"></a>00345         <span class="keywordflow">return</span> 3.9;
<a name="l00346"></a>00346       <span class="keywordflow">else</span>
<a name="l00347"></a>00347         <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a4a1706ad48c3fa5761d57e5384673f37">SEVERITY_UNDEFINED</a>;
<a name="l00348"></a>00348     }
<a name="l00349"></a>00349 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ab10de498a6cf575c242ac2e96b8c3cc5"></a><!-- doxytag: member="manage.c::level_min_severity" ref="ab10de498a6cf575c242ac2e96b8c3cc5" args="(const char *level, const gchar *class)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double level_min_severity </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>class</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the minimum severity for a severity level and class. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>level</em>&nbsp;</td><td>The name of the severity level. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>class</em>&nbsp;</td><td>The severity class, NULL to get from current user setting.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The minimum severity. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00258">258</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00773">SEVERITY_DEBUG</a>, <a class="el" href="manage_8h_source.html#l00775">SEVERITY_ERROR</a>, <a class="el" href="manage_8h_source.html#l00771">SEVERITY_FP</a>, <a class="el" href="manage_8h_source.html#l00769">SEVERITY_LOG</a>, and <a class="el" href="manage_8h_source.html#l00779">SEVERITY_UNDEFINED</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l00692">severity_data_level_counts()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00259"></a>00259 {
<a name="l00260"></a>00260   <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;Log&quot;</span>) == 0)
<a name="l00261"></a>00261     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a9d33ec420648fd2dc6ab5d32e22c783a">SEVERITY_LOG</a>;
<a name="l00262"></a>00262   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;False Positive&quot;</span>) == 0)
<a name="l00263"></a>00263     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a278856677dc1ea57b047dbfc213a7a0b">SEVERITY_FP</a>;
<a name="l00264"></a>00264   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;Debug&quot;</span>) == 0)
<a name="l00265"></a>00265     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a16c5fb5a2e4e400fd8caabc41ed98396">SEVERITY_DEBUG</a>;
<a name="l00266"></a>00266   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;Error&quot;</span>) == 0)
<a name="l00267"></a>00267     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a90b2e06a02b5b39bc00210a97f61ce97">SEVERITY_ERROR</a>;
<a name="l00268"></a>00268   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (<span class="keyword">class</span>, <span class="stringliteral">&quot;classic&quot;</span>) == 0)
<a name="l00269"></a>00269     {
<a name="l00270"></a>00270       <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;high&quot;</span>) == 0)
<a name="l00271"></a>00271         <span class="keywordflow">return</span> 5.1;
<a name="l00272"></a>00272       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;medium&quot;</span>) == 0)
<a name="l00273"></a>00273         <span class="keywordflow">return</span> 2.1;
<a name="l00274"></a>00274       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;low&quot;</span>) == 0)
<a name="l00275"></a>00275         <span class="keywordflow">return</span> 0.1;
<a name="l00276"></a>00276       <span class="keywordflow">else</span>
<a name="l00277"></a>00277         <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a4a1706ad48c3fa5761d57e5384673f37">SEVERITY_UNDEFINED</a>;
<a name="l00278"></a>00278     }
<a name="l00279"></a>00279   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (<span class="keyword">class</span>, <span class="stringliteral">&quot;pci-dss&quot;</span>) == 0)
<a name="l00280"></a>00280     {
<a name="l00281"></a>00281       <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;high&quot;</span>) == 0)
<a name="l00282"></a>00282         <span class="keywordflow">return</span> 4.3;
<a name="l00283"></a>00283       <span class="keywordflow">else</span>
<a name="l00284"></a>00284         <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a4a1706ad48c3fa5761d57e5384673f37">SEVERITY_UNDEFINED</a>;
<a name="l00285"></a>00285     }
<a name="l00286"></a>00286   <span class="keywordflow">else</span>
<a name="l00287"></a>00287     {
<a name="l00288"></a>00288       <span class="comment">/* NIST/BSI. */</span>
<a name="l00289"></a>00289       <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;high&quot;</span>) == 0)
<a name="l00290"></a>00290         <span class="keywordflow">return</span> 7.0;
<a name="l00291"></a>00291       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;medium&quot;</span>) == 0)
<a name="l00292"></a>00292         <span class="keywordflow">return</span> 4.0;
<a name="l00293"></a>00293       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;low&quot;</span>) == 0)
<a name="l00294"></a>00294         <span class="keywordflow">return</span> 0.1;
<a name="l00295"></a>00295       <span class="keywordflow">else</span>
<a name="l00296"></a>00296         <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a4a1706ad48c3fa5761d57e5384673f37">SEVERITY_UNDEFINED</a>;
<a name="l00297"></a>00297     }
<a name="l00298"></a>00298 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a5c55390b2f09d5d1c137acf24d098437"></a><!-- doxytag: member="manage.c::manage_auth_allow_all" ref="a5c55390b2f09d5d1c137acf24d098437" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void manage_auth_allow_all </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Ensure that any subsequent authentications succeed. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04407">4407</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04408"></a>04408 {
<a name="l04409"></a>04409   <a class="code" href="manage_8c.html#afc6df99003007ef239148d7a96457ed0" title="Flag for manage_auth_allow_all.">authenticate_allow_all</a> = 1;
<a name="l04410"></a>04410 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a93e1ef57551afa3b68967a82fd0942e9"></a><!-- doxytag: member="manage.c::manage_check_current_task" ref="a93e1ef57551afa3b68967a82fd0942e9" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int manage_check_current_task </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Handle state changes to current task made by other processes. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, -1 if out of space in scanner output buffer, 1 if queued to scanner. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l03794">3794</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8c_source.html#l00775">current_scanner_task</a>, <a class="el" href="manage__sql_8c_source.html#l26622">manage_transaction_stop()</a>, <a class="el" href="ovas-mngr-comm_8c_source.html#l00155">send_to_server()</a>, <a class="el" href="manage__sql_8c_source.html#l13141">set_task_run_status()</a>, <a class="el" href="manage__sql_8c_source.html#l13127">task_run_status()</a>, <a class="el" href="manage_8h_source.html#l00167">TASK_STATUS_DELETE_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00181">TASK_STATUS_DELETE_ULTIMATE_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00184">TASK_STATUS_DELETE_ULTIMATE_WAITING</a>, <a class="el" href="manage_8h_source.html#l00183">TASK_STATUS_DELETE_WAITING</a>, <a class="el" href="manage_8h_source.html#l00168">TASK_STATUS_DONE</a>, <a class="el" href="manage_8h_source.html#l00180">TASK_STATUS_INTERNAL_ERROR</a>, <a class="el" href="manage_8h_source.html#l00169">TASK_STATUS_NEW</a>, <a class="el" href="manage_8h_source.html#l00172">TASK_STATUS_PAUSE_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00173">TASK_STATUS_PAUSE_WAITING</a>, <a class="el" href="manage_8h_source.html#l00174">TASK_STATUS_PAUSED</a>, <a class="el" href="manage_8h_source.html#l00170">TASK_STATUS_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00175">TASK_STATUS_RESUME_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00176">TASK_STATUS_RESUME_WAITING</a>, <a class="el" href="manage_8h_source.html#l00171">TASK_STATUS_RUNNING</a>, <a class="el" href="manage_8h_source.html#l00177">TASK_STATUS_STOP_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00182">TASK_STATUS_STOP_REQUESTED_GIVEUP</a>, <a class="el" href="manage_8h_source.html#l00178">TASK_STATUS_STOP_WAITING</a>, and <a class="el" href="manage_8h_source.html#l00179">TASK_STATUS_STOPPED</a>.</p>

<p>Referenced by <a class="el" href="omp_8c_source.html#l26265">process_omp_change()</a>, and <a class="el" href="otp_8c_source.html#l00784">process_otp_scanner_input()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03795"></a>03795 {
<a name="l03796"></a>03796   <span class="keywordflow">if</span> (<a class="code" href="manage_8c.html#a448b7803b3f0a72e88d11cece0fc8aa6" title="The task currently running on the scanner.">current_scanner_task</a>)
<a name="l03797"></a>03797     {
<a name="l03798"></a>03798       <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65" title="Task statuses, also used as scan/report statuses.">task_status_t</a> run_status;
<a name="l03799"></a>03799 
<a name="l03800"></a>03800       <span class="comment">/* Commit pending transaction if needed. */</span>
<a name="l03801"></a>03801       <a class="code" href="manage__sql_8c.html#a70586869be78fab18b22b5c9f612ae02" title="Commit the current transaction, if any.">manage_transaction_stop</a> (FALSE);
<a name="l03802"></a>03802 
<a name="l03803"></a>03803       <span class="comment">/* Check if some other process changed the status. */</span>
<a name="l03804"></a>03804 
<a name="l03805"></a>03805       run_status = <a class="code" href="manage_8h.html#a6ee81446351e254b95a54483210f1ada" title="Return the run state of a task.">task_run_status</a> (<a class="code" href="manage_8c.html#a448b7803b3f0a72e88d11cece0fc8aa6" title="The task currently running on the scanner.">current_scanner_task</a>);
<a name="l03806"></a>03806       <span class="keywordflow">switch</span> (run_status)
<a name="l03807"></a>03807         {
<a name="l03808"></a>03808           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65ad734252ff7130810a12e395498625d8b">TASK_STATUS_PAUSE_REQUESTED</a>:
<a name="l03809"></a>03809             <span class="keywordflow">if</span> (<a class="code" href="ovas-mngr-comm_8c.html#a5e8ebd680f5948035731df580f52bbab" title="Send a message to the server.">send_to_server</a> (<span class="stringliteral">&quot;CLIENT &lt;|&gt; PAUSE_WHOLE_TEST &lt;|&gt; CLIENT\n&quot;</span>))
<a name="l03810"></a>03810               <span class="keywordflow">return</span> -1;
<a name="l03811"></a>03811             <a class="code" href="manage_8h.html#a8607acfa50914954cc41f17d045775e6" title="Set the run state of a task.">set_task_run_status</a> (<a class="code" href="manage_8c.html#a448b7803b3f0a72e88d11cece0fc8aa6" title="The task currently running on the scanner.">current_scanner_task</a>,
<a name="l03812"></a>03812                                  <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a6d8209c267e3f776f199aa0447adeab7">TASK_STATUS_PAUSE_WAITING</a>);
<a name="l03813"></a>03813             <span class="keywordflow">return</span> 1;
<a name="l03814"></a>03814             <span class="keywordflow">break</span>;
<a name="l03815"></a>03815           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65aab2e7d18cbd9530b261a6293ddef8317">TASK_STATUS_RESUME_REQUESTED</a>:
<a name="l03816"></a>03816             <span class="keywordflow">if</span> (<a class="code" href="ovas-mngr-comm_8c.html#a5e8ebd680f5948035731df580f52bbab" title="Send a message to the server.">send_to_server</a> (<span class="stringliteral">&quot;CLIENT &lt;|&gt; RESUME_WHOLE_TEST &lt;|&gt; CLIENT\n&quot;</span>))
<a name="l03817"></a>03817               <span class="keywordflow">return</span> -1;
<a name="l03818"></a>03818             <a class="code" href="manage_8h.html#a8607acfa50914954cc41f17d045775e6" title="Set the run state of a task.">set_task_run_status</a> (<a class="code" href="manage_8c.html#a448b7803b3f0a72e88d11cece0fc8aa6" title="The task currently running on the scanner.">current_scanner_task</a>,
<a name="l03819"></a>03819                                  <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a1cef794b3f767afb7167f45ed87fcc4e">TASK_STATUS_RESUME_WAITING</a>);
<a name="l03820"></a>03820             <span class="keywordflow">return</span> 1;
<a name="l03821"></a>03821             <span class="keywordflow">break</span>;
<a name="l03822"></a>03822           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a67a4fe195a744d41d307949fe2cceb01">TASK_STATUS_STOP_REQUESTED_GIVEUP</a>:
<a name="l03823"></a>03823             <span class="comment">/* This should only happen for slave tasks. */</span>
<a name="l03824"></a>03824             assert (0);
<a name="l03825"></a>03825           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a9c59cae3c178975e67fd644c321dd7c9">TASK_STATUS_STOP_REQUESTED</a>:
<a name="l03826"></a>03826             <span class="keywordflow">if</span> (<a class="code" href="ovas-mngr-comm_8c.html#a5e8ebd680f5948035731df580f52bbab" title="Send a message to the server.">send_to_server</a> (<span class="stringliteral">&quot;CLIENT &lt;|&gt; STOP_WHOLE_TEST &lt;|&gt; CLIENT\n&quot;</span>))
<a name="l03827"></a>03827               <span class="keywordflow">return</span> -1;
<a name="l03828"></a>03828             <a class="code" href="manage_8h.html#a8607acfa50914954cc41f17d045775e6" title="Set the run state of a task.">set_task_run_status</a> (<a class="code" href="manage_8c.html#a448b7803b3f0a72e88d11cece0fc8aa6" title="The task currently running on the scanner.">current_scanner_task</a>,
<a name="l03829"></a>03829                                  <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0b0e0633d24f7f6be77b1606ea31c624">TASK_STATUS_STOP_WAITING</a>);
<a name="l03830"></a>03830             <span class="keywordflow">return</span> 1;
<a name="l03831"></a>03831             <span class="keywordflow">break</span>;
<a name="l03832"></a>03832           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65aeb14e9b0d17875aea2e578740ea73511">TASK_STATUS_DELETE_REQUESTED</a>:
<a name="l03833"></a>03833             <span class="keywordflow">if</span> (<a class="code" href="ovas-mngr-comm_8c.html#a5e8ebd680f5948035731df580f52bbab" title="Send a message to the server.">send_to_server</a> (<span class="stringliteral">&quot;CLIENT &lt;|&gt; STOP_WHOLE_TEST &lt;|&gt; CLIENT\n&quot;</span>))
<a name="l03834"></a>03834               <span class="keywordflow">return</span> -1;
<a name="l03835"></a>03835             <a class="code" href="manage_8h.html#a8607acfa50914954cc41f17d045775e6" title="Set the run state of a task.">set_task_run_status</a> (<a class="code" href="manage_8c.html#a448b7803b3f0a72e88d11cece0fc8aa6" title="The task currently running on the scanner.">current_scanner_task</a>,
<a name="l03836"></a>03836                                  <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a6b6345e4c6f5777b557bba05babe38e1">TASK_STATUS_DELETE_WAITING</a>);
<a name="l03837"></a>03837             <span class="keywordflow">return</span> 1;
<a name="l03838"></a>03838             <span class="keywordflow">break</span>;
<a name="l03839"></a>03839           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a80492cc1dd3c32171d1e16236fd2080a">TASK_STATUS_DELETE_ULTIMATE_REQUESTED</a>:
<a name="l03840"></a>03840             <span class="keywordflow">if</span> (<a class="code" href="ovas-mngr-comm_8c.html#a5e8ebd680f5948035731df580f52bbab" title="Send a message to the server.">send_to_server</a> (<span class="stringliteral">&quot;CLIENT &lt;|&gt; STOP_WHOLE_TEST &lt;|&gt; CLIENT\n&quot;</span>))
<a name="l03841"></a>03841               <span class="keywordflow">return</span> -1;
<a name="l03842"></a>03842             <a class="code" href="manage_8h.html#a8607acfa50914954cc41f17d045775e6" title="Set the run state of a task.">set_task_run_status</a> (<a class="code" href="manage_8c.html#a448b7803b3f0a72e88d11cece0fc8aa6" title="The task currently running on the scanner.">current_scanner_task</a>,
<a name="l03843"></a>03843                                  <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a4503d7e858a22c8975a037296e449319">TASK_STATUS_DELETE_ULTIMATE_WAITING</a>);
<a name="l03844"></a>03844             <span class="keywordflow">return</span> 1;
<a name="l03845"></a>03845             <span class="keywordflow">break</span>;
<a name="l03846"></a>03846           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a6b6345e4c6f5777b557bba05babe38e1">TASK_STATUS_DELETE_WAITING</a>:
<a name="l03847"></a>03847           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a4503d7e858a22c8975a037296e449319">TASK_STATUS_DELETE_ULTIMATE_WAITING</a>:
<a name="l03848"></a>03848           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65aa6d0f9ed77c21c50a5dbda15be0cfda5">TASK_STATUS_DONE</a>:
<a name="l03849"></a>03849           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a06c1917e071cda8248578dc6488a9e26">TASK_STATUS_NEW</a>:
<a name="l03850"></a>03850           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0a268852134eeb744236e9196514e460">TASK_STATUS_REQUESTED</a>:
<a name="l03851"></a>03851           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a1cef794b3f767afb7167f45ed87fcc4e">TASK_STATUS_RESUME_WAITING</a>:
<a name="l03852"></a>03852           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a71652716ef97001ba2420436c93e0d96">TASK_STATUS_RUNNING</a>:
<a name="l03853"></a>03853           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a6d8209c267e3f776f199aa0447adeab7">TASK_STATUS_PAUSE_WAITING</a>:
<a name="l03854"></a>03854           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0b77333c1d4ae0d0eabc67464554f400">TASK_STATUS_PAUSED</a>:
<a name="l03855"></a>03855           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0b0e0633d24f7f6be77b1606ea31c624">TASK_STATUS_STOP_WAITING</a>:
<a name="l03856"></a>03856           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65afd9ce62ed6527ce4538d459aef435175">TASK_STATUS_STOPPED</a>:
<a name="l03857"></a>03857           <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a574a9d15c05d6e4de314548e7a993b62">TASK_STATUS_INTERNAL_ERROR</a>:
<a name="l03858"></a>03858             <span class="keywordflow">break</span>;
<a name="l03859"></a>03859         }
<a name="l03860"></a>03860     }
<a name="l03861"></a>03861   <span class="keywordflow">return</span> 0;
<a name="l03862"></a>03862 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="afbf958b43fd488180af68dd827f4d427"></a><!-- doxytag: member="manage.c::manage_read_info" ref="afbf958b43fd488180af68dd827f4d427" args="(gchar *type, gchar *uid, gchar *name, gchar **result)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int manage_read_info </td>
          <td>(</td>
          <td class="paramtype">gchar *&nbsp;</td>
          <td class="paramname"> <em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar *&nbsp;</td>
          <td class="paramname"> <em>uid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar **&nbsp;</td>
          <td class="paramname"> <em>result</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Read raw information. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>type</em>&nbsp;</td><td>Type of the requested information. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>uid</em>&nbsp;</td><td>Unique identifier of the requested information </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>Name or identifier of the requested information. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>result</em>&nbsp;</td><td>Pointer to the read information location. Will point to NULL on error.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 success, -1 error. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05778">5778</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="sql_8c_source.html#l02228">cleanup_iterator()</a>, <a class="el" href="manage_8c_source.html#l00086">CPE_GETBYNAME_XSL</a>, <a class="el" href="manage_8c_source.html#l00091">CVE_GETBYNAME_XSL</a>, <a class="el" href="manage_8c_source.html#l00101">DFN_CERT_ADV_GETBYNAME_XSL</a>, <a class="el" href="manage__sql_8c_source.html#l30656">find_nvt()</a>, <a class="el" href="manage_8c_source.html#l05564">get_nvti_xml()</a>, <a class="el" href="manage__sql_8c_source.html#l30914">init_nvt_iterator()</a>, <a class="el" href="sql_8c_source.html#l02253">next()</a>, <a class="el" href="manage_8c_source.html#l00096">OVALDEF_GETBYNAME_XSL</a>, and <a class="el" href="manage_8c_source.html#l05443">xsl_transform()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05779"></a>05779 {
<a name="l05780"></a>05780   gchar *fname;
<a name="l05781"></a>05781   gchar *pnames[2] = { <span class="stringliteral">&quot;refname&quot;</span>, NULL };
<a name="l05782"></a>05782   gchar *pvalues[2] = { <a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>, NULL };
<a name="l05783"></a>05783 
<a name="l05784"></a>05784   assert (result != NULL);
<a name="l05785"></a>05785   *result = NULL;
<a name="l05786"></a>05786 
<a name="l05787"></a>05787   <span class="keywordflow">if</span> (g_ascii_strcasecmp (<span class="stringliteral">&quot;CPE&quot;</span>, type) == 0)
<a name="l05788"></a>05788     {
<a name="l05789"></a>05789       fname = get_cpe_filename ();
<a name="l05790"></a>05790       <span class="keywordflow">if</span> (fname)
<a name="l05791"></a>05791         {
<a name="l05792"></a>05792           gchar *cpe;
<a name="l05793"></a>05793           cpe = <a class="code" href="manage_8c.html#af59809e7b86df3c35af37cb4bad3d7a1" title="Run xsltproc in an external process.">xsl_transform</a> (<a class="code" href="manage_8c.html#ad5aa949d6f37d98f569e82752bdfac74" title="CPE selection stylesheet location.">CPE_GETBYNAME_XSL</a>, fname, pnames, pvalues);
<a name="l05794"></a>05794           g_free (fname);
<a name="l05795"></a>05795           <span class="keywordflow">if</span> (cpe)
<a name="l05796"></a>05796             *result = cpe;
<a name="l05797"></a>05797         }
<a name="l05798"></a>05798     }
<a name="l05799"></a>05799   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (g_ascii_strcasecmp (<span class="stringliteral">&quot;CVE&quot;</span>, type) == 0)
<a name="l05800"></a>05800     {
<a name="l05801"></a>05801       fname = get_cve_filename (uid);
<a name="l05802"></a>05802       <span class="keywordflow">if</span> (fname)
<a name="l05803"></a>05803         {
<a name="l05804"></a>05804           gchar *cve;
<a name="l05805"></a>05805           cve = <a class="code" href="manage_8c.html#af59809e7b86df3c35af37cb4bad3d7a1" title="Run xsltproc in an external process.">xsl_transform</a> (<a class="code" href="manage_8c.html#af7a8b4a77cbff90ef63f261c6281eba6" title="CVE selection stylesheet location.">CVE_GETBYNAME_XSL</a>, fname, pnames, pvalues);
<a name="l05806"></a>05806           g_free (fname);
<a name="l05807"></a>05807           <span class="keywordflow">if</span> (cve)
<a name="l05808"></a>05808             *result = cve;
<a name="l05809"></a>05809         }
<a name="l05810"></a>05810     }
<a name="l05811"></a>05811   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (g_ascii_strcasecmp (<span class="stringliteral">&quot;NVT&quot;</span>, type) == 0)
<a name="l05812"></a>05812     {
<a name="l05813"></a>05813       <a class="code" href="structiterator__t.html" title="A generic SQL iterator.">iterator_t</a> nvts;
<a name="l05814"></a>05814       <a class="code" href="manage_8h.html#ace86a53941d3d1418393413ca0a8096a">nvt_t</a> nvt;
<a name="l05815"></a>05815 
<a name="l05816"></a>05816       <span class="keywordflow">if</span> (!<a class="code" href="manage_8h.html#a7cf650871ffb6166f2801e2afce623e1" title="Find an NVT given an identifier.">find_nvt</a> (<a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>, &amp;nvt) &amp;&amp; nvt)
<a name="l05817"></a>05817         {
<a name="l05818"></a>05818           <a class="code" href="manage_8h.html#abc6e214d28263cbb4802df29505b55c7" title="Initialise an NVT iterator.">init_nvt_iterator</a> (&amp;nvts, nvt, 0, NULL, NULL, 0, NULL);
<a name="l05819"></a>05819 
<a name="l05820"></a>05820           <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#a821a1a0d4e2daaa3fb6a485ebf0ac67a" title="Increment an iterator.">next</a> (&amp;nvts))
<a name="l05821"></a>05821             *result = <a class="code" href="manage_8c.html#ad5caf732b373ede69a1717662e040cb7" title="Create and return XML description for an NVT.">get_nvti_xml</a> (&amp;nvts, 1, 0, NULL, 1);
<a name="l05822"></a>05822 
<a name="l05823"></a>05823           <a class="code" href="manage_8h.html#aa98d17659363974764692d019f4d8172" title="Cleanup an iterator.">cleanup_iterator</a> (&amp;nvts);
<a name="l05824"></a>05824         }
<a name="l05825"></a>05825     }
<a name="l05826"></a>05826   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (g_ascii_strcasecmp (<span class="stringliteral">&quot;OVALDEF&quot;</span>, type) == 0)
<a name="l05827"></a>05827     {
<a name="l05828"></a>05828       fname = get_ovaldef_filename (uid);
<a name="l05829"></a>05829       <span class="keywordflow">if</span> (fname)
<a name="l05830"></a>05830         {
<a name="l05831"></a>05831           gchar *ovaldef;
<a name="l05832"></a>05832           ovaldef = <a class="code" href="manage_8c.html#af59809e7b86df3c35af37cb4bad3d7a1" title="Run xsltproc in an external process.">xsl_transform</a> (<a class="code" href="manage_8c.html#a3d9ac0eebf166f2e60a60b4e4ff86393" title="OVALDEF selection stylesheet location.">OVALDEF_GETBYNAME_XSL</a>, fname,
<a name="l05833"></a>05833                                    pnames, pvalues);
<a name="l05834"></a>05834           g_free (fname);
<a name="l05835"></a>05835           <span class="keywordflow">if</span> (ovaldef)
<a name="l05836"></a>05836             *result = ovaldef;
<a name="l05837"></a>05837         }
<a name="l05838"></a>05838     }
<a name="l05839"></a>05839   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (g_ascii_strcasecmp (<span class="stringliteral">&quot;DFN_CERT_ADV&quot;</span>, type) == 0)
<a name="l05840"></a>05840     {
<a name="l05841"></a>05841       fname = get_dfn_cert_adv_filename (uid);
<a name="l05842"></a>05842       <span class="keywordflow">if</span> (fname)
<a name="l05843"></a>05843         {
<a name="l05844"></a>05844           gchar *adv;
<a name="l05845"></a>05845           adv = <a class="code" href="manage_8c.html#af59809e7b86df3c35af37cb4bad3d7a1" title="Run xsltproc in an external process.">xsl_transform</a> (<a class="code" href="manage_8c.html#aeabba2575a41385027b6e379f3dbb712" title="DFN_CERT_ADV selection stylesheet location.">DFN_CERT_ADV_GETBYNAME_XSL</a>, fname,
<a name="l05846"></a>05846                                pnames, pvalues);
<a name="l05847"></a>05847           g_free (fname);
<a name="l05848"></a>05848           <span class="keywordflow">if</span> (adv)
<a name="l05849"></a>05849             *result = adv;
<a name="l05850"></a>05850         }
<a name="l05851"></a>05851     }
<a name="l05852"></a>05852 
<a name="l05853"></a>05853   <span class="keywordflow">if</span> (*result == NULL)
<a name="l05854"></a>05854     <span class="keywordflow">return</span> -1;
<a name="l05855"></a>05855 
<a name="l05856"></a>05856   <span class="keywordflow">return</span> 1;
<a name="l05857"></a>05857 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ad30783278158eec63de2c1ba5a8eebda"></a><!-- doxytag: member="manage.c::manage_result_type_threat" ref="ad30783278158eec63de2c1ba5a8eebda" args="(const char *type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* manage_result_type_threat </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>type</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the threat associated with a result type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>type</em>&nbsp;</td><td>Result type.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Threat name. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00526">526</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00527"></a>00527 {
<a name="l00528"></a>00528   <span class="keywordflow">if</span> (strcasecmp (type, <span class="stringliteral">&quot;Security Hole&quot;</span>) == 0)
<a name="l00529"></a>00529     <span class="keywordflow">return</span> <span class="stringliteral">&quot;High&quot;</span>;
<a name="l00530"></a>00530   <span class="keywordflow">if</span> (strcasecmp (type, <span class="stringliteral">&quot;Security Warning&quot;</span>) == 0)
<a name="l00531"></a>00531     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Medium&quot;</span>;
<a name="l00532"></a>00532   <span class="keywordflow">if</span> (strcasecmp (type, <span class="stringliteral">&quot;Security Note&quot;</span>) == 0)
<a name="l00533"></a>00533     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Low&quot;</span>;
<a name="l00534"></a>00534   <span class="keywordflow">if</span> (strcasecmp (type, <span class="stringliteral">&quot;False Positive&quot;</span>) == 0)
<a name="l00535"></a>00535     <span class="keywordflow">return</span> <span class="stringliteral">&quot;False Positive&quot;</span>;
<a name="l00536"></a>00536   <span class="keywordflow">return</span> <span class="stringliteral">&quot;Log&quot;</span>;
<a name="l00537"></a>00537 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af5602486a83c63f12b4a959e1e8eece1"></a><!-- doxytag: member="manage.c::manage_run_wizard" ref="af5602486a83c63f12b4a959e1e8eece1" args="(const gchar *name, int(*run_command)(void *, gchar *, gchar **), void *run_command_data, array_t *params, int read_only, const char *mode, gchar **command_error, gchar **ret_response)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int manage_run_wizard </td>
          <td>(</td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int(*)(void *, gchar *, gchar **)&nbsp;</td>
          <td class="paramname"> <em>run_command</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&nbsp;</td>
          <td class="paramname"> <em>run_command_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">array_t *&nbsp;</td>
          <td class="paramname"> <em>params</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>read_only</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar **&nbsp;</td>
          <td class="paramname"> <em>command_error</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar **&nbsp;</td>
          <td class="paramname"> <em>ret_response</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Run a wizard. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>Wizard name. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>run_command</em>&nbsp;</td><td>Function to run OMP command. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>run_command_data</em>&nbsp;</td><td>Argument for run_command. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>params</em>&nbsp;</td><td>Wizard params. Array of <a class="el" href="structname__value__t.html" title="Name value pair.">name_value_t</a>. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>read_only</em>&nbsp;</td><td>Whether to only allow wizards marked as read only. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mode</em>&nbsp;</td><td>Name of the mode to run the wizard in. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>command_error</em>&nbsp;</td><td>Address for error message from failed command when return is 4, or NULL. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>ret_response</em>&nbsp;</td><td>Address for response string of last command.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 success, 1 name error, 2 process forked to run task, -10 process forked to run task where task start failed, -2 to_scanner buffer full, 4 command in wizard failed, 5 wizard not read only, 6 Parameter validation failed, -1 internal error, 99 permission denied. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l06858">6858</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="omp_8c_source.html#l04673">forked</a>, <a class="el" href="manage_8h_source.html#l00046">name_value_t::name</a>, <a class="el" href="tracef_8h_source.html#l00089">tracef</a>, <a class="el" href="manage__acl_8c_source.html#l00050">user_may()</a>, <a class="el" href="manage_8h_source.html#l00047">name_value_t::value</a>, and <a class="el" href="manage_8c_source.html#l05443">xsl_transform()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l06866"></a>06866 {
<a name="l06867"></a>06867   gchar *file, *file_name, *response, *wizard;
<a name="l06868"></a>06868   gsize wizard_len;
<a name="l06869"></a>06869   GError *get_error;
<a name="l06870"></a>06870   entity_t entity, mode_entity, params_entity, read_only_entity;
<a name="l06871"></a>06871   entity_t param_def, step;
<a name="l06872"></a>06872   entities_t modes, steps, param_defs;
<a name="l06873"></a>06873   <span class="keywordtype">int</span> ret, <a class="code" href="omp_8c.html#a561d6ae2df1882124024d1ad25c05ca0" title="Hack for returning fork status to caller.">forked</a>;
<a name="l06874"></a>06874   <span class="keyword">const</span> gchar *point;
<a name="l06875"></a>06875 
<a name="l06876"></a>06876   forked = 0;
<a name="l06877"></a>06877 
<a name="l06878"></a>06878   <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#abe056c751dd156a61be8677666039d29" title="Test whether a user may perform an operation.">user_may</a> (<span class="stringliteral">&quot;run_wizard&quot;</span>) == 0)
<a name="l06879"></a>06879     <span class="keywordflow">return</span> 99;
<a name="l06880"></a>06880 
<a name="l06881"></a>06881   <span class="keywordflow">if</span> (command_error)
<a name="l06882"></a>06882     *command_error = NULL;
<a name="l06883"></a>06883 
<a name="l06884"></a>06884   point = <a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>;
<a name="l06885"></a>06885   <span class="keywordflow">while</span> (*point &amp;&amp; (isalnum (*point) || *point == <span class="charliteral">&apos;_&apos;</span>)) point++;
<a name="l06886"></a>06886   <span class="keywordflow">if</span> (*point)
<a name="l06887"></a>06887     <span class="keywordflow">return</span> 1;
<a name="l06888"></a>06888 
<a name="l06889"></a>06889   <span class="comment">/* Read wizard from file. */</span>
<a name="l06890"></a>06890 
<a name="l06891"></a>06891   file_name = g_strdup_printf (<span class="stringliteral">&quot;%s.xml&quot;</span>, <a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>);
<a name="l06892"></a>06892   file = g_build_filename (OPENVAS_DATA_DIR,
<a name="l06893"></a>06893                            <span class="stringliteral">&quot;openvasmd&quot;</span>,
<a name="l06894"></a>06894                            <span class="stringliteral">&quot;wizards&quot;</span>,
<a name="l06895"></a>06895                            file_name,
<a name="l06896"></a>06896                            NULL);
<a name="l06897"></a>06897   g_free (file_name);
<a name="l06898"></a>06898 
<a name="l06899"></a>06899   get_error = NULL;
<a name="l06900"></a>06900   g_file_get_contents (file,
<a name="l06901"></a>06901                        &amp;wizard,
<a name="l06902"></a>06902                        &amp;wizard_len,
<a name="l06903"></a>06903                        &amp;get_error);
<a name="l06904"></a>06904   g_free (file);
<a name="l06905"></a>06905   <span class="keywordflow">if</span> (get_error)
<a name="l06906"></a>06906     {
<a name="l06907"></a>06907       g_warning (<span class="stringliteral">&quot;%s: Failed to read wizard: %s\n&quot;</span>,
<a name="l06908"></a>06908                  __FUNCTION__,
<a name="l06909"></a>06909                  get_error-&gt;message);
<a name="l06910"></a>06910       g_error_free (get_error);
<a name="l06911"></a>06911       <span class="keywordflow">return</span> -1;
<a name="l06912"></a>06912     }
<a name="l06913"></a>06913 
<a name="l06914"></a>06914   <span class="comment">/* Parse wizard. */</span>
<a name="l06915"></a>06915 
<a name="l06916"></a>06916   entity = NULL;
<a name="l06917"></a>06917   <span class="keywordflow">if</span> (parse_entity (wizard, &amp;entity))
<a name="l06918"></a>06918     {
<a name="l06919"></a>06919       g_warning (<span class="stringliteral">&quot;%s: Failed to parse wizard\n&quot;</span>, __FUNCTION__);
<a name="l06920"></a>06920       g_free (wizard);
<a name="l06921"></a>06921       <span class="keywordflow">return</span> -1;
<a name="l06922"></a>06922     }
<a name="l06923"></a>06923   g_free (wizard);
<a name="l06924"></a>06924 
<a name="l06925"></a>06925   <span class="comment">/* Select mode */</span>
<a name="l06926"></a>06926   <span class="keywordflow">if</span> (mode &amp;&amp; strcmp (mode, <span class="stringliteral">&quot;&quot;</span>))
<a name="l06927"></a>06927     {
<a name="l06928"></a>06928     modes = entity-&gt;entities;
<a name="l06929"></a>06929     <span class="keywordtype">int</span> mode_found = 0;
<a name="l06930"></a>06930     <span class="keywordflow">while</span> (mode_found == 0 &amp;&amp; (mode_entity = first_entity (modes)))
<a name="l06931"></a>06931       {
<a name="l06932"></a>06932         <span class="keywordflow">if</span> (strcasecmp (entity_name (mode_entity), <span class="stringliteral">&quot;mode&quot;</span>) == 0)
<a name="l06933"></a>06933           {
<a name="l06934"></a>06934             entity_t name_entity;
<a name="l06935"></a>06935             name_entity = entity_child (mode_entity, <span class="stringliteral">&quot;name&quot;</span>);
<a name="l06936"></a>06936 
<a name="l06937"></a>06937             <span class="keywordflow">if</span> (strcmp (entity_text (name_entity), mode) == 0)
<a name="l06938"></a>06938               mode_found = 1;
<a name="l06939"></a>06939           }
<a name="l06940"></a>06940         modes = next_entities (modes);
<a name="l06941"></a>06941       }
<a name="l06942"></a>06942 
<a name="l06943"></a>06943       <span class="keywordflow">if</span> (mode_found == 0)
<a name="l06944"></a>06944         {
<a name="l06945"></a>06945           free_entity (entity);
<a name="l06946"></a>06946           *ret_response = g_strdup (<span class="stringliteral">&quot;&quot;</span>);
<a name="l06947"></a>06947 
<a name="l06948"></a>06948           <span class="keywordflow">if</span> (forked)
<a name="l06949"></a>06949             <span class="keywordflow">return</span> 3;
<a name="l06950"></a>06950           <span class="keywordflow">else</span>
<a name="l06951"></a>06951             <span class="keywordflow">return</span> 0;
<a name="l06952"></a>06952         }
<a name="l06953"></a>06953     }
<a name="l06954"></a>06954   <span class="keywordflow">else</span>
<a name="l06955"></a>06955     {
<a name="l06956"></a>06956       mode_entity = entity;
<a name="l06957"></a>06957     }
<a name="l06958"></a>06958 
<a name="l06959"></a>06959   <span class="comment">/* If needed, check if wizard is marked as read only.</span>
<a name="l06960"></a>06960 <span class="comment">   * This does not check the actual commands.</span>
<a name="l06961"></a>06961 <span class="comment">   */</span>
<a name="l06962"></a>06962   <span class="keywordflow">if</span> (read_only)
<a name="l06963"></a>06963     {
<a name="l06964"></a>06964       read_only_entity = entity_child (mode_entity, <span class="stringliteral">&quot;read_only&quot;</span>);
<a name="l06965"></a>06965       <span class="keywordflow">if</span> (read_only_entity == NULL)
<a name="l06966"></a>06966         {
<a name="l06967"></a>06967           free_entity (entity);
<a name="l06968"></a>06968           <span class="keywordflow">return</span> 5;
<a name="l06969"></a>06969         }
<a name="l06970"></a>06970     }
<a name="l06971"></a>06971 
<a name="l06972"></a>06972   <span class="comment">/* Check params */</span>
<a name="l06973"></a>06973   params_entity = entity_child (mode_entity, <span class="stringliteral">&quot;params&quot;</span>);
<a name="l06974"></a>06974   <span class="keywordflow">if</span> (params_entity)
<a name="l06975"></a>06975     param_defs = params_entity-&gt;entities;
<a name="l06976"></a>06976 
<a name="l06977"></a>06977   <span class="keywordflow">while</span> (params_entity &amp;&amp; (param_def = first_entity (param_defs)))
<a name="l06978"></a>06978     {
<a name="l06979"></a>06979       <span class="keywordflow">if</span> (strcasecmp (entity_name (param_def), <span class="stringliteral">&quot;param&quot;</span>) == 0)
<a name="l06980"></a>06980         {
<a name="l06981"></a>06981           entity_t name_entity, regex_entity, optional_entity;
<a name="l06982"></a>06982           <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="structnamelist__s.html#a10e5f9a9cf791f9201d3a41250b36c3a">name</a>, *regex;
<a name="l06983"></a>06983           <span class="keywordtype">int</span> optional;
<a name="l06984"></a>06984           <span class="keywordtype">int</span> param_found = 0;
<a name="l06985"></a>06985 
<a name="l06986"></a>06986           name_entity = entity_child (param_def, <span class="stringliteral">&quot;name&quot;</span>);
<a name="l06987"></a>06987           <span class="keywordflow">if</span> ((name_entity == NULL)
<a name="l06988"></a>06988               || (strcmp (entity_text (name_entity), <span class="stringliteral">&quot;&quot;</span>) == 0))
<a name="l06989"></a>06989             {
<a name="l06990"></a>06990               g_warning (<span class="stringliteral">&quot;%s: Wizard PARAM missing NAME\n&quot;</span>,
<a name="l06991"></a>06991                          __FUNCTION__);
<a name="l06992"></a>06992               free_entity (entity);
<a name="l06993"></a>06993               <span class="keywordflow">return</span> -1;
<a name="l06994"></a>06994             }
<a name="l06995"></a>06995           <span class="keywordflow">else</span>
<a name="l06996"></a>06996             name = entity_text (name_entity);
<a name="l06997"></a>06997 
<a name="l06998"></a>06998           regex_entity = entity_child (param_def, <span class="stringliteral">&quot;regex&quot;</span>);
<a name="l06999"></a>06999           <span class="keywordflow">if</span> ((regex_entity == NULL)
<a name="l07000"></a>07000               || (strcmp (entity_text (regex_entity), <span class="stringliteral">&quot;&quot;</span>) == 0))
<a name="l07001"></a>07001             {
<a name="l07002"></a>07002               g_warning (<span class="stringliteral">&quot;%s: Wizard PARAM missing REGEX\n&quot;</span>,
<a name="l07003"></a>07003                          __FUNCTION__);
<a name="l07004"></a>07004               free_entity (entity);
<a name="l07005"></a>07005               <span class="keywordflow">return</span> -1;
<a name="l07006"></a>07006             }
<a name="l07007"></a>07007           <span class="keywordflow">else</span>
<a name="l07008"></a>07008             regex = entity_text (regex_entity);
<a name="l07009"></a>07009 
<a name="l07010"></a>07010           optional_entity = entity_child (param_def, <span class="stringliteral">&quot;optional&quot;</span>);
<a name="l07011"></a>07011           optional = (optional_entity
<a name="l07012"></a>07012                       &amp;&amp; strcmp (entity_text (optional_entity), <span class="stringliteral">&quot;&quot;</span>)
<a name="l07013"></a>07013                       &amp;&amp; strcmp (entity_text (optional_entity), <span class="stringliteral">&quot;0&quot;</span>));
<a name="l07014"></a>07014 
<a name="l07015"></a>07015           <span class="keywordflow">if</span> (params)
<a name="l07016"></a>07016             {
<a name="l07017"></a>07017               guint index = params-&gt;len;
<a name="l07018"></a>07018               <span class="keywordflow">while</span> (index--)
<a name="l07019"></a>07019                 {
<a name="l07020"></a>07020                   <a class="code" href="structname__value__t.html" title="Name value pair.">name_value_t</a> *pair;
<a name="l07021"></a>07021 
<a name="l07022"></a>07022                   pair = (<a class="code" href="structname__value__t.html" title="Name value pair.">name_value_t</a>*) g_ptr_array_index (params, index);
<a name="l07023"></a>07023 
<a name="l07024"></a>07024                   <span class="keywordflow">if</span> (pair == NULL)
<a name="l07025"></a>07025                     <span class="keywordflow">continue</span>;
<a name="l07026"></a>07026 
<a name="l07027"></a>07027                   <span class="keywordflow">if</span> ((pair-&gt;<a class="code" href="structname__value__t.html#a0efd8e4906cf69f2b33de242f67754bf" title="Name.">name</a>)
<a name="l07028"></a>07028                       &amp;&amp; (pair-&gt;<a class="code" href="structname__value__t.html#a9909219ecfa230e5922c1b3c6eafad6b" title="Param value.">value</a>)
<a name="l07029"></a>07029                       &amp;&amp; (strcmp (pair-&gt;<a class="code" href="structname__value__t.html#a0efd8e4906cf69f2b33de242f67754bf" title="Name.">name</a>, name) == 0))
<a name="l07030"></a>07030                     {
<a name="l07031"></a>07031                       index = 0; <span class="comment">// end loop;</span>
<a name="l07032"></a>07032                       param_found = 1;
<a name="l07033"></a>07033 
<a name="l07034"></a>07034                       <span class="keywordflow">if</span> (g_regex_match_simple (regex, pair-&gt;<a class="code" href="structname__value__t.html#a9909219ecfa230e5922c1b3c6eafad6b" title="Param value.">value</a>, 0, 0) == 0)
<a name="l07035"></a>07035                         {
<a name="l07036"></a>07036                           *command_error
<a name="l07037"></a>07037                             = g_strdup_printf (<span class="stringliteral">&quot;Value &apos;%s&apos; is not valid for&quot;</span>
<a name="l07038"></a>07038                                               <span class="stringliteral">&quot; parameter &apos;%s&apos;.&quot;</span>,
<a name="l07039"></a>07039                                               pair-&gt;<a class="code" href="structname__value__t.html#a9909219ecfa230e5922c1b3c6eafad6b" title="Param value.">value</a>, name);
<a name="l07040"></a>07040                           free_entity (entity);
<a name="l07041"></a>07041                           <span class="keywordflow">return</span> 6;
<a name="l07042"></a>07042                         }
<a name="l07043"></a>07043                     }
<a name="l07044"></a>07044                 }
<a name="l07045"></a>07045             }
<a name="l07046"></a>07046 
<a name="l07047"></a>07047           <span class="keywordflow">if</span> (optional == 0 &amp;&amp; param_found == 0)
<a name="l07048"></a>07048             {
<a name="l07049"></a>07049               *command_error = g_strdup_printf (<span class="stringliteral">&quot;Mandatory wizard param &apos;%s&apos;&quot;</span>
<a name="l07050"></a>07050                                                 <span class="stringliteral">&quot; missing&quot;</span>,
<a name="l07051"></a>07051                                                 name);
<a name="l07052"></a>07052               free_entity (entity);
<a name="l07053"></a>07053               <span class="keywordflow">return</span> 6;
<a name="l07054"></a>07054             }
<a name="l07055"></a>07055 
<a name="l07056"></a>07056 
<a name="l07057"></a>07057         }
<a name="l07058"></a>07058       param_defs = next_entities (param_defs);
<a name="l07059"></a>07059     }
<a name="l07060"></a>07060 
<a name="l07061"></a>07061   <span class="comment">/* Run each step of the wizard. */</span>
<a name="l07062"></a>07062 
<a name="l07063"></a>07063   response = NULL;
<a name="l07064"></a>07064   ret = 0;
<a name="l07065"></a>07065   steps = mode_entity-&gt;entities;
<a name="l07066"></a>07066   <span class="keywordflow">while</span> ((step = first_entity (steps)))
<a name="l07067"></a>07067     {
<a name="l07068"></a>07068       <span class="keywordflow">if</span> (strcasecmp (entity_name (step), <span class="stringliteral">&quot;step&quot;</span>) == 0)
<a name="l07069"></a>07069         {
<a name="l07070"></a>07070           entity_t command;
<a name="l07071"></a>07071           gchar *omp;
<a name="l07072"></a>07072           <span class="keywordtype">int</span> xsl_fd, xml_fd;
<a name="l07073"></a>07073           <span class="keywordtype">char</span> xsl_file_name[] = <span class="stringliteral">&quot;/tmp/openvasmd-xsl-XXXXXX&quot;</span>;
<a name="l07074"></a>07074           FILE *xsl_file, *xml_file;
<a name="l07075"></a>07075           <span class="keywordtype">char</span> xml_file_name[] = <span class="stringliteral">&quot;/tmp/openvasmd-xml-XXXXXX&quot;</span>;
<a name="l07076"></a>07076 
<a name="l07077"></a>07077           <span class="comment">/* Get the command element. */</span>
<a name="l07078"></a>07078 
<a name="l07079"></a>07079           command = entity_child (step, <span class="stringliteral">&quot;command&quot;</span>);
<a name="l07080"></a>07080           <span class="keywordflow">if</span> (command == NULL)
<a name="l07081"></a>07081             {
<a name="l07082"></a>07082               g_warning (<span class="stringliteral">&quot;%s: Wizard STEP missing COMMAND\n&quot;</span>,
<a name="l07083"></a>07083                          __FUNCTION__);
<a name="l07084"></a>07084               free_entity (entity);
<a name="l07085"></a>07085               g_free (response);
<a name="l07086"></a>07086               <span class="keywordflow">return</span> -1;
<a name="l07087"></a>07087             }
<a name="l07088"></a>07088 
<a name="l07089"></a>07089           <span class="comment">/* Save the command XSL from the element to a file. */</span>
<a name="l07090"></a>07090 
<a name="l07091"></a>07091           xsl_fd = mkstemp (xsl_file_name);
<a name="l07092"></a>07092           <span class="keywordflow">if</span> (xsl_fd == -1)
<a name="l07093"></a>07093             {
<a name="l07094"></a>07094               g_warning (<span class="stringliteral">&quot;%s: Wizard XSL file create failed\n&quot;</span>,
<a name="l07095"></a>07095                          __FUNCTION__);
<a name="l07096"></a>07096               free_entity (entity);
<a name="l07097"></a>07097               g_free (response);
<a name="l07098"></a>07098               <span class="keywordflow">return</span> -1;
<a name="l07099"></a>07099             }
<a name="l07100"></a>07100 
<a name="l07101"></a>07101           xsl_file = fdopen (xsl_fd, <span class="stringliteral">&quot;w&quot;</span>);
<a name="l07102"></a>07102           <span class="keywordflow">if</span> (xsl_file == NULL)
<a name="l07103"></a>07103             {
<a name="l07104"></a>07104               g_warning (<span class="stringliteral">&quot;%s: Wizard XSL file open failed\n&quot;</span>,
<a name="l07105"></a>07105                          __FUNCTION__);
<a name="l07106"></a>07106               close (xsl_fd);
<a name="l07107"></a>07107               free_entity (entity);
<a name="l07108"></a>07108               g_free (response);
<a name="l07109"></a>07109               <span class="keywordflow">return</span> -1;
<a name="l07110"></a>07110             }
<a name="l07111"></a>07111 
<a name="l07112"></a>07112           <span class="keywordflow">if</span> (first_entity (command-&gt;entities))
<a name="l07113"></a>07113             print_entity (xsl_file, first_entity (command-&gt;entities));
<a name="l07114"></a>07114 
<a name="l07115"></a>07115           <span class="comment">/* Write the params as XML to a file. */</span>
<a name="l07116"></a>07116 
<a name="l07117"></a>07117           xml_fd = mkstemp (xml_file_name);
<a name="l07118"></a>07118           <span class="keywordflow">if</span> (xml_fd == -1)
<a name="l07119"></a>07119             {
<a name="l07120"></a>07120               g_warning (<span class="stringliteral">&quot;%s: Wizard XML file create failed\n&quot;</span>,
<a name="l07121"></a>07121                          __FUNCTION__);
<a name="l07122"></a>07122               fclose (xsl_file);
<a name="l07123"></a>07123               unlink (xsl_file_name);
<a name="l07124"></a>07124               free_entity (entity);
<a name="l07125"></a>07125               g_free (response);
<a name="l07126"></a>07126               <span class="keywordflow">return</span> -1;
<a name="l07127"></a>07127             }
<a name="l07128"></a>07128 
<a name="l07129"></a>07129           xml_file = fdopen (xml_fd, <span class="stringliteral">&quot;w&quot;</span>);
<a name="l07130"></a>07130           <span class="keywordflow">if</span> (xml_file == NULL)
<a name="l07131"></a>07131             {
<a name="l07132"></a>07132               g_warning (<span class="stringliteral">&quot;%s: Wizard XML file open failed\n&quot;</span>,
<a name="l07133"></a>07133                          __FUNCTION__);
<a name="l07134"></a>07134               fclose (xsl_file);
<a name="l07135"></a>07135               unlink (xsl_file_name);
<a name="l07136"></a>07136               close (xml_fd);
<a name="l07137"></a>07137               free_entity (entity);
<a name="l07138"></a>07138               g_free (response);
<a name="l07139"></a>07139               <span class="keywordflow">return</span> -1;
<a name="l07140"></a>07140             }
<a name="l07141"></a>07141 
<a name="l07142"></a>07142           <span class="keywordflow">if</span> (fprintf (xml_file, <span class="stringliteral">&quot;&lt;wizard&gt;&lt;params&gt;&quot;</span>) &lt; 0)
<a name="l07143"></a>07143             {
<a name="l07144"></a>07144               fclose (xsl_file);
<a name="l07145"></a>07145               unlink (xsl_file_name);
<a name="l07146"></a>07146               fclose (xml_file);
<a name="l07147"></a>07147               free_entity (entity);
<a name="l07148"></a>07148               g_warning (<span class="stringliteral">&quot;%s: Wizard failed to write XML\n&quot;</span>,
<a name="l07149"></a>07149                          __FUNCTION__);
<a name="l07150"></a>07150               g_free (response);
<a name="l07151"></a>07151               <span class="keywordflow">return</span> -1;
<a name="l07152"></a>07152             }
<a name="l07153"></a>07153 
<a name="l07154"></a>07154           <span class="keywordflow">if</span> (params)
<a name="l07155"></a>07155             {
<a name="l07156"></a>07156               guint index = params-&gt;len;
<a name="l07157"></a>07157               <span class="keywordflow">while</span> (index--)
<a name="l07158"></a>07158                 {
<a name="l07159"></a>07159                   <a class="code" href="structname__value__t.html" title="Name value pair.">name_value_t</a> *pair;
<a name="l07160"></a>07160                   gchar *pair_name, *pair_value;
<a name="l07161"></a>07161 
<a name="l07162"></a>07162                   pair = (<a class="code" href="structname__value__t.html" title="Name value pair.">name_value_t</a>*) g_ptr_array_index (params, index);
<a name="l07163"></a>07163 
<a name="l07164"></a>07164                   <span class="keywordflow">if</span> (pair == NULL)
<a name="l07165"></a>07165                     <span class="keywordflow">continue</span>;
<a name="l07166"></a>07166 
<a name="l07167"></a>07167                   pair_name = pair-&gt;<a class="code" href="structname__value__t.html#a0efd8e4906cf69f2b33de242f67754bf" title="Name.">name</a>
<a name="l07168"></a>07168                                ? g_markup_escape_text
<a name="l07169"></a>07169                                   (pair-&gt;<a class="code" href="structname__value__t.html#a0efd8e4906cf69f2b33de242f67754bf" title="Name.">name</a>, strlen (pair-&gt;<a class="code" href="structname__value__t.html#a0efd8e4906cf69f2b33de242f67754bf" title="Name.">name</a>))
<a name="l07170"></a>07170                                : g_strdup (<span class="stringliteral">&quot;&quot;</span>);
<a name="l07171"></a>07171 
<a name="l07172"></a>07172                   pair_value = pair-&gt;<a class="code" href="structname__value__t.html#a9909219ecfa230e5922c1b3c6eafad6b" title="Param value.">value</a>
<a name="l07173"></a>07173                                 ? g_markup_escape_text
<a name="l07174"></a>07174                                    (pair-&gt;<a class="code" href="structname__value__t.html#a9909219ecfa230e5922c1b3c6eafad6b" title="Param value.">value</a>, strlen (pair-&gt;<a class="code" href="structname__value__t.html#a9909219ecfa230e5922c1b3c6eafad6b" title="Param value.">value</a>))
<a name="l07175"></a>07175                                 : g_strdup (<span class="stringliteral">&quot;&quot;</span>);
<a name="l07176"></a>07176 
<a name="l07177"></a>07177                   <span class="keywordflow">if</span> (fprintf (xml_file,
<a name="l07178"></a>07178                                <span class="stringliteral">&quot;&lt;param&gt;&quot;</span>
<a name="l07179"></a>07179                                <span class="stringliteral">&quot;&lt;name&gt;%s&lt;/name&gt;&quot;</span>
<a name="l07180"></a>07180                                <span class="stringliteral">&quot;&lt;value&gt;%s&lt;/value&gt;&quot;</span>
<a name="l07181"></a>07181                                <span class="stringliteral">&quot;&lt;/param&gt;&quot;</span>,
<a name="l07182"></a>07182                                pair_name,
<a name="l07183"></a>07183                                pair_value)
<a name="l07184"></a>07184                       &lt; 0)
<a name="l07185"></a>07185                     {
<a name="l07186"></a>07186                       g_free (pair_name);
<a name="l07187"></a>07187                       g_free (pair_value);
<a name="l07188"></a>07188                       fclose (xsl_file);
<a name="l07189"></a>07189                       unlink (xsl_file_name);
<a name="l07190"></a>07190                       fclose (xml_file);
<a name="l07191"></a>07191                       unlink (xml_file_name);
<a name="l07192"></a>07192                       free_entity (entity);
<a name="l07193"></a>07193                       g_warning (<span class="stringliteral">&quot;%s: Wizard failed to write XML\n&quot;</span>,
<a name="l07194"></a>07194                                  __FUNCTION__);
<a name="l07195"></a>07195                       g_free (response);
<a name="l07196"></a>07196                       <span class="keywordflow">return</span> -1;
<a name="l07197"></a>07197                     }
<a name="l07198"></a>07198                   g_free (pair_name);
<a name="l07199"></a>07199                   g_free (pair_value);
<a name="l07200"></a>07200                 }
<a name="l07201"></a>07201             }
<a name="l07202"></a>07202 
<a name="l07203"></a>07203           <span class="keywordflow">if</span> (fprintf (xml_file,
<a name="l07204"></a>07204                        <span class="stringliteral">&quot;&lt;/params&gt;&quot;</span>
<a name="l07205"></a>07205                        <span class="stringliteral">&quot;&lt;previous&gt;&quot;</span>
<a name="l07206"></a>07206                        <span class="stringliteral">&quot;&lt;response&gt;%s&lt;/response&gt;&quot;</span>
<a name="l07207"></a>07207                        <span class="stringliteral">&quot;&lt;/previous&gt;&quot;</span>
<a name="l07208"></a>07208                        <span class="stringliteral">&quot;&lt;/wizard&gt;\n&quot;</span>,
<a name="l07209"></a>07209                        response ? response : <span class="stringliteral">&quot;&quot;</span>)
<a name="l07210"></a>07210               &lt; 0)
<a name="l07211"></a>07211             {
<a name="l07212"></a>07212               fclose (xsl_file);
<a name="l07213"></a>07213               unlink (xsl_file_name);
<a name="l07214"></a>07214               fclose (xml_file);
<a name="l07215"></a>07215               unlink (xml_file_name);
<a name="l07216"></a>07216               free_entity (entity);
<a name="l07217"></a>07217               g_warning (<span class="stringliteral">&quot;%s: Wizard failed to write XML\n&quot;</span>,
<a name="l07218"></a>07218                          __FUNCTION__);
<a name="l07219"></a>07219               g_free (response);
<a name="l07220"></a>07220               <span class="keywordflow">return</span> -1;
<a name="l07221"></a>07221             }
<a name="l07222"></a>07222 
<a name="l07223"></a>07223           fflush (xml_file);
<a name="l07224"></a>07224 
<a name="l07225"></a>07225           <span class="comment">/* Combine XSL and XML to get the OMP command. */</span>
<a name="l07226"></a>07226 
<a name="l07227"></a>07227           omp = <a class="code" href="manage_8c.html#af59809e7b86df3c35af37cb4bad3d7a1" title="Run xsltproc in an external process.">xsl_transform</a> (xsl_file_name, xml_file_name, NULL,
<a name="l07228"></a>07228                                NULL);
<a name="l07229"></a>07229           fclose (xsl_file);
<a name="l07230"></a>07230           unlink (xsl_file_name);
<a name="l07231"></a>07231           fclose (xml_file);
<a name="l07232"></a>07232           unlink (xml_file_name);
<a name="l07233"></a>07233           <span class="keywordflow">if</span> (omp == NULL)
<a name="l07234"></a>07234             {
<a name="l07235"></a>07235               g_warning (<span class="stringliteral">&quot;%s: Wizard XSL transform failed\n&quot;</span>,
<a name="l07236"></a>07236                          __FUNCTION__);
<a name="l07237"></a>07237               free_entity (entity);
<a name="l07238"></a>07238               g_free (response);
<a name="l07239"></a>07239               <span class="keywordflow">return</span> -1;
<a name="l07240"></a>07240             }
<a name="l07241"></a>07241 
<a name="l07242"></a>07242           <span class="comment">/* Run the OMP command. */</span>
<a name="l07243"></a>07243 
<a name="l07244"></a>07244           g_free (response);
<a name="l07245"></a>07245           response = NULL;
<a name="l07246"></a>07246           ret = run_command (run_command_data, omp, &amp;response);
<a name="l07247"></a>07247           <span class="keywordflow">if</span> (ret == 3)
<a name="l07248"></a>07248             {
<a name="l07249"></a>07249               <span class="comment">/* Parent after a start_task fork. */</span>
<a name="l07250"></a>07250               forked = 1;
<a name="l07251"></a>07251             }
<a name="l07252"></a>07252           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == 0)
<a name="l07253"></a>07253             {
<a name="l07254"></a>07254               <span class="comment">/* Command succeeded. */</span>
<a name="l07255"></a>07255             }
<a name="l07256"></a>07256           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == 2)
<a name="l07257"></a>07257             {
<a name="l07258"></a>07258               <span class="comment">/* Process forked to run a task. */</span>
<a name="l07259"></a>07259               free_entity (entity);
<a name="l07260"></a>07260               g_free (response);
<a name="l07261"></a>07261               <span class="keywordflow">return</span> 2;
<a name="l07262"></a>07262             }
<a name="l07263"></a>07263           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == -10)
<a name="l07264"></a>07264             {
<a name="l07265"></a>07265               <span class="comment">/* Process forked to run a task.  Task start failed. */</span>
<a name="l07266"></a>07266               free_entity (entity);
<a name="l07267"></a>07267               g_free (response);
<a name="l07268"></a>07268               <span class="keywordflow">return</span> -10;
<a name="l07269"></a>07269             }
<a name="l07270"></a>07270           <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ret == -2)
<a name="l07271"></a>07271             {
<a name="l07272"></a>07272               <span class="comment">/* to_scanner buffer full. */</span>
<a name="l07273"></a>07273               free_entity (entity);
<a name="l07274"></a>07274               g_free (response);
<a name="l07275"></a>07275               <span class="keywordflow">return</span> -2;
<a name="l07276"></a>07276             }
<a name="l07277"></a>07277           <span class="keywordflow">else</span>
<a name="l07278"></a>07278             {
<a name="l07279"></a>07279               free_entity (entity);
<a name="l07280"></a>07280               g_free (response);
<a name="l07281"></a>07281               <span class="keywordflow">return</span> -1;
<a name="l07282"></a>07282             }
<a name="l07283"></a>07283 
<a name="l07284"></a>07284           <span class="comment">/* Exit if the command failed. */</span>
<a name="l07285"></a>07285 
<a name="l07286"></a>07286           <span class="keywordflow">if</span> (response)
<a name="l07287"></a>07287             {
<a name="l07288"></a>07288               <span class="keyword">const</span> <span class="keywordtype">char</span> *status;
<a name="l07289"></a>07289               entity_t response_entity;
<a name="l07290"></a>07290 
<a name="l07291"></a>07291               response_entity = NULL;
<a name="l07292"></a>07292               <span class="keywordflow">if</span> (parse_entity (response, &amp;response_entity))
<a name="l07293"></a>07293                 {
<a name="l07294"></a>07294                   g_warning (<span class="stringliteral">&quot;%s: Wizard failed to parse response\n&quot;</span>,
<a name="l07295"></a>07295                              __FUNCTION__);
<a name="l07296"></a>07296                   free_entity (entity);
<a name="l07297"></a>07297                   g_free (response);
<a name="l07298"></a>07298                   <span class="keywordflow">return</span> -1;
<a name="l07299"></a>07299                 }
<a name="l07300"></a>07300 
<a name="l07301"></a>07301               status = entity_attribute (response_entity, <span class="stringliteral">&quot;status&quot;</span>);
<a name="l07302"></a>07302               <span class="keywordflow">if</span> ((status == NULL)
<a name="l07303"></a>07303                   || (strlen (status) == 0)
<a name="l07304"></a>07304                   || (status[0] != <span class="charliteral">&apos;2&apos;</span>))
<a name="l07305"></a>07305                 {
<a name="l07306"></a>07306                   <a class="code" href="tracef_8h.html#a70d339a461f334e16086ab23b83cedc4" title="Formatted trace output.">tracef</a> (<span class="stringliteral">&quot;response was %s\n&quot;</span>, response);
<a name="l07307"></a>07307                   <span class="keywordflow">if</span> (command_error)
<a name="l07308"></a>07308                     {
<a name="l07309"></a>07309                       <span class="keyword">const</span> <span class="keywordtype">char</span> *text;
<a name="l07310"></a>07310                       text = entity_attribute (response_entity, <span class="stringliteral">&quot;status_text&quot;</span>);
<a name="l07311"></a>07311                       <span class="keywordflow">if</span> (text)
<a name="l07312"></a>07312                         *command_error = g_strdup (text);
<a name="l07313"></a>07313                     }
<a name="l07314"></a>07314                   free_entity (response_entity);
<a name="l07315"></a>07315                   free_entity (entity);
<a name="l07316"></a>07316                   g_free (response);
<a name="l07317"></a>07317                   <span class="keywordflow">return</span> 4;
<a name="l07318"></a>07318                 }
<a name="l07319"></a>07319 
<a name="l07320"></a>07320               free_entity (response_entity);
<a name="l07321"></a>07321             }
<a name="l07322"></a>07322         }
<a name="l07323"></a>07323       steps = next_entities (steps);
<a name="l07324"></a>07324     }
<a name="l07325"></a>07325   *ret_response = g_strdup (response);
<a name="l07326"></a>07326   free_entity (entity);
<a name="l07327"></a>07327   g_free (response);
<a name="l07328"></a>07328 
<a name="l07329"></a>07329   <span class="comment">/* All the steps succeeded. */</span>
<a name="l07330"></a>07330 
<a name="l07331"></a>07331   <span class="keywordflow">if</span> (forked)
<a name="l07332"></a>07332     <span class="keywordflow">return</span> 3;
<a name="l07333"></a>07333   <span class="keywordflow">return</span> 0;
<a name="l07334"></a>07334 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a96e51a91a2564436e25f4390402c4e84"></a><!-- doxytag: member="manage.c::manage_scap_update_time" ref="a96e51a91a2564436e25f4390402c4e84" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* manage_scap_update_time </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>GET SCAP update time, as a string. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Last update time as a static string, or "" on error. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05731">5731</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8c_source.html#l00126">SCAP_TIMESTAMP_FILENAME</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05732"></a>05732 {
<a name="l05733"></a>05733   gchar *content;
<a name="l05734"></a>05734   GError *error;
<a name="l05735"></a>05735   gsize content_size;
<a name="l05736"></a>05736   <span class="keyword">struct </span>tm update_time;
<a name="l05737"></a>05737 
<a name="l05738"></a>05738   <span class="comment">/* Read in the contents. */</span>
<a name="l05739"></a>05739 
<a name="l05740"></a>05740   error = NULL;
<a name="l05741"></a>05741   <span class="keywordflow">if</span> (g_file_get_contents (<a class="code" href="manage_8c.html#a6829ef55fec66a0b53ff57cbfab63b8d" title="SCAP timestamp location.">SCAP_TIMESTAMP_FILENAME</a>,
<a name="l05742"></a>05742                            &amp;content,
<a name="l05743"></a>05743                            &amp;content_size,
<a name="l05744"></a>05744                            &amp;error)
<a name="l05745"></a>05745       == FALSE)
<a name="l05746"></a>05746     {
<a name="l05747"></a>05747       <span class="keywordflow">if</span> (error)
<a name="l05748"></a>05748         {
<a name="l05749"></a>05749           g_debug (<span class="stringliteral">&quot;%s: failed to read %s: %s&quot;</span>,
<a name="l05750"></a>05750                    __FUNCTION__, <a class="code" href="manage_8c.html#a6829ef55fec66a0b53ff57cbfab63b8d" title="SCAP timestamp location.">SCAP_TIMESTAMP_FILENAME</a>, error-&gt;message);
<a name="l05751"></a>05751           g_error_free (error);
<a name="l05752"></a>05752         }
<a name="l05753"></a>05753       <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l05754"></a>05754     }
<a name="l05755"></a>05755 
<a name="l05756"></a>05756   memset (&amp;update_time, 0, <span class="keyword">sizeof</span> (<span class="keyword">struct</span> tm));
<a name="l05757"></a>05757   <span class="keywordflow">if</span> (strptime (content, <span class="stringliteral">&quot;%Y%m%d%H%M&quot;</span>, &amp;update_time))
<a name="l05758"></a>05758     {
<a name="l05759"></a>05759       <span class="keyword">static</span> <span class="keywordtype">char</span> time_string[100];
<a name="l05760"></a>05760       strftime (time_string, 99, <span class="stringliteral">&quot;%FT%T.000%z&quot;</span>, &amp;update_time);
<a name="l05761"></a>05761       <span class="keywordflow">return</span> time_string;
<a name="l05762"></a>05762     }
<a name="l05763"></a>05763   <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l05764"></a>05764 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9096e0134ed78f75befe1b1ba2690743"></a><!-- doxytag: member="manage.c::manage_schedule" ref="a9096e0134ed78f75befe1b1ba2690743" args="(int(*fork_connection)(int *, gnutls_session_t *, gnutls_certificate_credentials_t *, gchar *), gboolean run_tasks)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int manage_schedule </td>
          <td>(</td>
          <td class="paramtype">int(*)(int *, gnutls_session_t *, gnutls_certificate_credentials_t *, gchar *)&nbsp;</td>
          <td class="paramname"> <em>fork_connection</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gboolean&nbsp;</td>
          <td class="paramname"> <em>run_tasks</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Schedule any actions that are due. </p>
<p>In openvasmd, periodically called from the main daemon loop.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>fork_connection</em>&nbsp;</td><td>Function that forks a child which is connected to the Manager. Must return PID in parent, 0 in child, or -1 on error. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>run_tasks</em>&nbsp;</td><td>Whether to run scheduled tasks.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 success, 1 failed to get lock, -1 error. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04475">4475</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage__sql_8c_source.html#l37963">add_months()</a>, <a class="el" href="manage__sql_8c_source.html#l38260">cleanup_task_schedule_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l01016">current_offset()</a>, <a class="el" href="manage__sql_8c_source.html#l38233">init_task_schedule_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l09679">manage_update_nvti_cache()</a>, <a class="el" href="manage__sql_8c_source.html#l37898">months_between()</a>, <a class="el" href="sql_8c_source.html#l02253">next()</a>, <a class="el" href="manage__sql_8c_source.html#l09552">reinit_manage_process()</a>, <a class="el" href="manage_8c_source.html#l04440">reschedule_task()</a>, <a class="el" href="manage__sql_8c_source.html#l13828">set_task_schedule_next_time()</a>, <a class="el" href="manage__sql_8c_source.html#l38354">task_schedule_iterator_duration()</a>, <a class="el" href="manage__sql_8c_source.html#l38340">task_schedule_iterator_first_time()</a>, <a class="el" href="manage__sql_8c_source.html#l38408">task_schedule_iterator_initial_offset()</a>, <a class="el" href="manage__sql_8h.html#a88a3a30293dacc45142cdc9bcfe37ea3">task_schedule_iterator_owner_name()</a>, <a class="el" href="manage__sql_8h.html#abadef25a6616c3b44df4799203a73688">task_schedule_iterator_owner_uuid()</a>, <a class="el" href="manage__sql_8c_source.html#l38312">task_schedule_iterator_period()</a>, <a class="el" href="manage__sql_8c_source.html#l38326">task_schedule_iterator_period_months()</a>, <a class="el" href="manage__sql_8c_source.html#l38422">task_schedule_iterator_start_due()</a>, <a class="el" href="manage__sql_8c_source.html#l38456">task_schedule_iterator_stop_due()</a>, <a class="el" href="manage__sql_8c_source.html#l38274">task_schedule_iterator_task()</a>, <a class="el" href="manage__sql_8h.html#aba667ef2b1d68eaa10e65f5394b26ded">task_schedule_iterator_task_uuid()</a>, <a class="el" href="manage__sql_8h.html#a4d7d56043c79fe9c341967ccd90501d6">task_schedule_iterator_timezone()</a>, and <a class="el" href="manage__sql_8c_source.html#l12724">task_uuid()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04480"></a>04480 {
<a name="l04481"></a>04481   <a class="code" href="structiterator__t.html" title="A generic SQL iterator.">iterator_t</a> schedules;
<a name="l04482"></a>04482   GSList *starts = NULL, *stops = NULL;
<a name="l04483"></a>04483   <span class="keywordtype">int</span> ret;
<a name="l04484"></a>04484 
<a name="l04485"></a>04485   <a class="code" href="manage__sql_8c.html#a5c926e55c35c77dbd14a9ac8b900915f" title="Update the memory cache of NVTs, if this has been requested.">manage_update_nvti_cache</a> ();
<a name="l04486"></a>04486 
<a name="l04487"></a>04487   <span class="keywordflow">if</span> (run_tasks == 0)
<a name="l04488"></a>04488     <span class="keywordflow">return</span> 0;
<a name="l04489"></a>04489 
<a name="l04490"></a>04490   <span class="comment">/* Assemble &quot;starts&quot; and &quot;stops&quot; list containing task uuid and owner name</span>
<a name="l04491"></a>04491 <span class="comment">   * for each (scheduled) task to start or stop. */</span>
<a name="l04492"></a>04492 
<a name="l04493"></a>04493   ret = <a class="code" href="manage__sql_8c.html#aa7177a660f8c5c5a6d8911e956f45b4b" title="Initialise a task schedule iterator.">init_task_schedule_iterator</a> (&amp;schedules);
<a name="l04494"></a>04494   <span class="keywordflow">if</span> (ret)
<a name="l04495"></a>04495     {
<a name="l04496"></a>04496       <span class="keywordflow">if</span> (ret == -1)
<a name="l04497"></a>04497         g_warning (<span class="stringliteral">&quot;%s: iterator init error\n&quot;</span>, __FUNCTION__);
<a name="l04498"></a>04498       <span class="keywordflow">return</span> ret;
<a name="l04499"></a>04499     }
<a name="l04500"></a>04500   <span class="comment">/* This iterator runs in an exclusive transaction, so this loop is atomic. */</span>
<a name="l04501"></a>04501   <span class="keywordflow">while</span> (<a class="code" href="manage_8h.html#a821a1a0d4e2daaa3fb6a485ebf0ac67a" title="Increment an iterator.">next</a> (&amp;schedules))
<a name="l04502"></a>04502     <span class="keywordflow">if</span> (<a class="code" href="manage__sql_8c.html#ad69801112986c577362e6891d58f611d" title="Get the start due state from a task schedule iterator.">task_schedule_iterator_start_due</a> (&amp;schedules))
<a name="l04503"></a>04503       {
<a name="l04504"></a>04504         time_t period, period_months;
<a name="l04505"></a>04505 
<a name="l04506"></a>04506         <span class="comment">/* Update the task schedule info to prevent multiple schedules. */</span>
<a name="l04507"></a>04507 
<a name="l04508"></a>04508         period = <a class="code" href="manage__sql_8c.html#ad484f19669b6b29e624a088be089327e" title="Get the period from a task schedule iterator.">task_schedule_iterator_period</a> (&amp;schedules);
<a name="l04509"></a>04509         period_months = <a class="code" href="manage__sql_8c.html#af07d25dee29fdf628a9e5be314689280" title="Get the period months from a task schedule iterator.">task_schedule_iterator_period_months</a> (&amp;schedules);
<a name="l04510"></a>04510 
<a name="l04511"></a>04511         <span class="keywordflow">if</span> (period)
<a name="l04512"></a>04512           {
<a name="l04513"></a>04513             time_t now = time (NULL);
<a name="l04514"></a>04514             time_t first = <a class="code" href="manage__sql_8c.html#a5658787271de19886e28d099a8184f0d" title="Get the first time from a task schedule iterator.">task_schedule_iterator_first_time</a> (&amp;schedules);
<a name="l04515"></a>04515             time_t duration = <a class="code" href="manage__sql_8c.html#a240516b3dbf961fe7226616f99548b75" title="Get the duration from a task schedule iterator.">task_schedule_iterator_duration</a> (&amp;schedules);
<a name="l04516"></a>04516 
<a name="l04517"></a>04517             assert (first &lt;= now);
<a name="l04518"></a>04518 
<a name="l04519"></a>04519             <span class="comment">/* In the database keep the times in UTC... */</span>
<a name="l04520"></a>04520             <a class="code" href="manage__sql_8c.html#a145f27fc3308e74324c30689a20a2f40" title="Set the next time a scheduled task will be due.">set_task_schedule_next_time</a>
<a name="l04521"></a>04521              (<a class="code" href="manage__sql_8c.html#afdcf8f727799b924087daf594de32f18" title="Get the task from a task schedule iterator.">task_schedule_iterator_task</a> (&amp;schedules),
<a name="l04522"></a>04522               first + ((((now - first) / period) + 1) * period));
<a name="l04523"></a>04523 
<a name="l04524"></a>04524             <span class="comment">/* ...but for the calculations offset for daylight saving. */</span>
<a name="l04525"></a>04525             first += <a class="code" href="manage__sql_8c.html#a81e6f340b209a7f5d041d8dff71e1807" title="Get the initial offset from a task schedule iterator.">task_schedule_iterator_initial_offset</a> (&amp;schedules)
<a name="l04526"></a>04526                       - <a class="code" href="manage_8h.html#ad947be3bcf7a587257a8f42c1837def1" title="Get the current offset from UTC of a timezone.">current_offset</a> (<a class="code" href="manage__sql_8h.html#a4d7d56043c79fe9c341967ccd90501d6">task_schedule_iterator_timezone</a>
<a name="l04527"></a>04527                                          (&amp;schedules));
<a name="l04528"></a>04528 
<a name="l04529"></a>04529             <span class="comment">/* Ensure that the task starts within the duration if it has one. */</span>
<a name="l04530"></a>04530             <span class="keywordflow">if</span> (duration &amp;&amp; (((now - first) % period) &gt; duration))
<a name="l04531"></a>04531               <span class="keywordflow">continue</span>;
<a name="l04532"></a>04532           }
<a name="l04533"></a>04533         <span class="keywordflow">else</span> <span class="keywordflow">if</span> (period_months)
<a name="l04534"></a>04534           {
<a name="l04535"></a>04535             time_t now = time (NULL);
<a name="l04536"></a>04536             time_t first = <a class="code" href="manage__sql_8c.html#a5658787271de19886e28d099a8184f0d" title="Get the first time from a task schedule iterator.">task_schedule_iterator_first_time</a> (&amp;schedules);
<a name="l04537"></a>04537             time_t duration = <a class="code" href="manage__sql_8c.html#a240516b3dbf961fe7226616f99548b75" title="Get the duration from a task schedule iterator.">task_schedule_iterator_duration</a> (&amp;schedules);
<a name="l04538"></a>04538 
<a name="l04539"></a>04539             assert (first &lt;= now);
<a name="l04540"></a>04540 
<a name="l04541"></a>04541             <span class="comment">/* In the database keep the times in UTC... */</span>
<a name="l04542"></a>04542             <a class="code" href="manage__sql_8c.html#a145f27fc3308e74324c30689a20a2f40" title="Set the next time a scheduled task will be due.">set_task_schedule_next_time</a>
<a name="l04543"></a>04543              (<a class="code" href="manage__sql_8c.html#afdcf8f727799b924087daf594de32f18" title="Get the task from a task schedule iterator.">task_schedule_iterator_task</a> (&amp;schedules),
<a name="l04544"></a>04544               <a class="code" href="manage__sql_8c.html#ac2f93247e09ac165faff05bc66621da0" title="Add months to a time.">add_months</a> (first, <a class="code" href="manage__sql_8c.html#a4d8a11f127b4ed1ddc697d5c4af30bf5" title="Count number of full months between two times.">months_between</a> (first, now) + 1));
<a name="l04545"></a>04545 
<a name="l04546"></a>04546             <span class="comment">/* ...but for the calculations offset for daylight saving. */</span>
<a name="l04547"></a>04547             first += <a class="code" href="manage__sql_8c.html#a81e6f340b209a7f5d041d8dff71e1807" title="Get the initial offset from a task schedule iterator.">task_schedule_iterator_initial_offset</a> (&amp;schedules)
<a name="l04548"></a>04548                       - <a class="code" href="manage_8h.html#ad947be3bcf7a587257a8f42c1837def1" title="Get the current offset from UTC of a timezone.">current_offset</a> (<a class="code" href="manage__sql_8h.html#a4d7d56043c79fe9c341967ccd90501d6">task_schedule_iterator_timezone</a>
<a name="l04549"></a>04549                                          (&amp;schedules));
<a name="l04550"></a>04550 
<a name="l04551"></a>04551             <span class="comment">/* Ensure that the task starts within the duration if it has one. */</span>
<a name="l04552"></a>04552             <span class="keywordflow">if</span> (duration
<a name="l04553"></a>04553                 &amp;&amp; ((now - <a class="code" href="manage__sql_8c.html#ac2f93247e09ac165faff05bc66621da0" title="Add months to a time.">add_months</a> (first, <a class="code" href="manage__sql_8c.html#a4d8a11f127b4ed1ddc697d5c4af30bf5" title="Count number of full months between two times.">months_between</a> (first, now)))
<a name="l04554"></a>04554                     &gt; duration))
<a name="l04555"></a>04555               <span class="keywordflow">continue</span>;
<a name="l04556"></a>04556           }
<a name="l04557"></a>04557         <span class="keywordflow">else</span>
<a name="l04558"></a>04558           <a class="code" href="manage__sql_8c.html#a145f27fc3308e74324c30689a20a2f40" title="Set the next time a scheduled task will be due.">set_task_schedule_next_time</a>
<a name="l04559"></a>04559            (<a class="code" href="manage__sql_8c.html#afdcf8f727799b924087daf594de32f18" title="Get the task from a task schedule iterator.">task_schedule_iterator_task</a> (&amp;schedules), 0);
<a name="l04560"></a>04560 
<a name="l04561"></a>04561         <span class="comment">/* Add task UUID and owner name and UUID to the list. */</span>
<a name="l04562"></a>04562 
<a name="l04563"></a>04563         starts = g_slist_prepend
<a name="l04564"></a>04564                   (starts,
<a name="l04565"></a>04565                    g_strdup (<a class="code" href="manage__sql_8h.html#aba667ef2b1d68eaa10e65f5394b26ded">task_schedule_iterator_task_uuid</a> (&amp;schedules)));
<a name="l04566"></a>04566         starts = g_slist_prepend
<a name="l04567"></a>04567                   (starts,
<a name="l04568"></a>04568                    g_strdup (<a class="code" href="manage__sql_8h.html#abadef25a6616c3b44df4799203a73688">task_schedule_iterator_owner_uuid</a> (&amp;schedules)));
<a name="l04569"></a>04569         starts = g_slist_prepend
<a name="l04570"></a>04570                   (starts,
<a name="l04571"></a>04571                    g_strdup (<a class="code" href="manage__sql_8h.html#a88a3a30293dacc45142cdc9bcfe37ea3">task_schedule_iterator_owner_name</a> (&amp;schedules)));
<a name="l04572"></a>04572       }
<a name="l04573"></a>04573     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="manage__sql_8c.html#a4de703beff7bc688000149ff8ab3300c" title="Get the stop due state from a task schedule iterator.">task_schedule_iterator_stop_due</a> (&amp;schedules))
<a name="l04574"></a>04574       {
<a name="l04575"></a>04575         <span class="comment">/* Add task UUID and owner name and UUID to the list. */</span>
<a name="l04576"></a>04576 
<a name="l04577"></a>04577         stops = g_slist_prepend
<a name="l04578"></a>04578                  (stops,
<a name="l04579"></a>04579                   g_strdup (<a class="code" href="manage__sql_8h.html#aba667ef2b1d68eaa10e65f5394b26ded">task_schedule_iterator_task_uuid</a> (&amp;schedules)));
<a name="l04580"></a>04580         stops = g_slist_prepend
<a name="l04581"></a>04581                  (stops,
<a name="l04582"></a>04582                   g_strdup (<a class="code" href="manage__sql_8h.html#abadef25a6616c3b44df4799203a73688">task_schedule_iterator_owner_uuid</a> (&amp;schedules)));
<a name="l04583"></a>04583         stops = g_slist_prepend
<a name="l04584"></a>04584                  (stops,
<a name="l04585"></a>04585                   g_strdup (<a class="code" href="manage__sql_8h.html#a88a3a30293dacc45142cdc9bcfe37ea3">task_schedule_iterator_owner_name</a> (&amp;schedules)));
<a name="l04586"></a>04586       }
<a name="l04587"></a>04587   <a class="code" href="manage__sql_8c.html#a9914804b926963b5ee7bef259ea8dfed" title="Cleanup a task schedule iterator.">cleanup_task_schedule_iterator</a> (&amp;schedules);
<a name="l04588"></a>04588 
<a name="l04589"></a>04589   <span class="comment">/* Start tasks in forked processes, now that the SQL statement is closed. */</span>
<a name="l04590"></a>04590 
<a name="l04591"></a>04591   <span class="keywordflow">while</span> (starts)
<a name="l04592"></a>04592     {
<a name="l04593"></a>04593       <span class="keywordtype">int</span> socket, pid;
<a name="l04594"></a>04594       gnutls_session_t session;
<a name="l04595"></a>04595       gnutls_certificate_credentials_t credentials;
<a name="l04596"></a>04596       gchar *<a class="code" href="manage_8h.html#a7c5ca575001be2933e3ad2af24678f47" title="Return the UUID of a task.">task_uuid</a>, *owner, *owner_uuid;
<a name="l04597"></a>04597       GSList *head;
<a name="l04598"></a>04598 
<a name="l04599"></a>04599       owner = starts-&gt;data;
<a name="l04600"></a>04600       assert (starts-&gt;next);
<a name="l04601"></a>04601       owner_uuid = starts-&gt;next-&gt;data;
<a name="l04602"></a>04602       assert (starts-&gt;next-&gt;next);
<a name="l04603"></a>04603       task_uuid = starts-&gt;next-&gt;next-&gt;data;
<a name="l04604"></a>04604 
<a name="l04605"></a>04605       head = starts;
<a name="l04606"></a>04606       starts = starts-&gt;next-&gt;next-&gt;next;
<a name="l04607"></a>04607       g_slist_free_1 (head-&gt;next-&gt;next);
<a name="l04608"></a>04608       g_slist_free_1 (head-&gt;next);
<a name="l04609"></a>04609       g_slist_free_1 (head);
<a name="l04610"></a>04610 
<a name="l04611"></a>04611       <span class="comment">/* Fork a child to start the task and wait for the response, so that the</span>
<a name="l04612"></a>04612 <span class="comment">       * parent can return to the main loop. */</span>
<a name="l04613"></a>04613 
<a name="l04614"></a>04614       pid = fork ();
<a name="l04615"></a>04615       <span class="keywordflow">switch</span> (pid)
<a name="l04616"></a>04616         {
<a name="l04617"></a>04617           <span class="keywordflow">case</span> 0:
<a name="l04618"></a>04618             <span class="comment">/* Child.  Carry on to start the task, reopen the database (required</span>
<a name="l04619"></a>04619 <span class="comment">             * after fork). */</span>
<a name="l04620"></a>04620             <a class="code" href="manage__sql_8c.html#a7fb02014e697e65c02e7d82e7ff0512b" title="Reinitialize the manage library for a process.">reinit_manage_process</a> ();
<a name="l04621"></a>04621             <span class="keywordflow">while</span> (starts)
<a name="l04622"></a>04622               {
<a name="l04623"></a>04623                 g_free (starts-&gt;data);
<a name="l04624"></a>04624                 starts = g_slist_delete_link (starts, starts);
<a name="l04625"></a>04625               }
<a name="l04626"></a>04626             <span class="keywordflow">break</span>;
<a name="l04627"></a>04627 
<a name="l04628"></a>04628           <span class="keywordflow">case</span> -1:
<a name="l04629"></a>04629             <span class="comment">/* Parent on error.  Reschedule and continue to next task. */</span>
<a name="l04630"></a>04630             g_warning (<span class="stringliteral">&quot;%s: fork failed\n&quot;</span>, __FUNCTION__);
<a name="l04631"></a>04631             <a class="code" href="manage_8c.html#a4855b1e67b70882496413511bcd2426e" title="Set a task&amp;#39;s schedule so that it runs again next scheduling round.">reschedule_task</a> (task_uuid);
<a name="l04632"></a>04632             g_free (task_uuid);
<a name="l04633"></a>04633             g_free (owner);
<a name="l04634"></a>04634             g_free (owner_uuid);
<a name="l04635"></a>04635             <span class="keywordflow">continue</span>;
<a name="l04636"></a>04636 
<a name="l04637"></a>04637           <span class="keywordflow">default</span>:
<a name="l04638"></a>04638             <span class="comment">/* Parent.  Continue to next task. */</span>
<a name="l04639"></a>04639             g_debug (<span class="stringliteral">&quot;%s: %i forked %i&quot;</span>, __FUNCTION__, getpid (), pid);
<a name="l04640"></a>04640             g_free (task_uuid);
<a name="l04641"></a>04641             g_free (owner);
<a name="l04642"></a>04642             g_free (owner_uuid);
<a name="l04643"></a>04643             <span class="keywordflow">continue</span>;
<a name="l04644"></a>04644 
<a name="l04645"></a>04645         }
<a name="l04646"></a>04646 
<a name="l04647"></a>04647       <span class="comment">/* Run the callback to fork a child connected to the Manager. */</span>
<a name="l04648"></a>04648 
<a name="l04649"></a>04649       pid = fork_connection (&amp;socket, &amp;session, &amp;credentials, owner_uuid);
<a name="l04650"></a>04650       <span class="keywordflow">switch</span> (pid)
<a name="l04651"></a>04651         {
<a name="l04652"></a>04652           <span class="keywordflow">case</span> 0:
<a name="l04653"></a>04653             <span class="comment">/* Child.  Break, start task, exit. */</span>
<a name="l04654"></a>04654             g_free (owner_uuid);
<a name="l04655"></a>04655             <span class="keywordflow">break</span>;
<a name="l04656"></a>04656 
<a name="l04657"></a>04657           <span class="keywordflow">case</span> -1:
<a name="l04658"></a>04658             <span class="comment">/* Parent on error. */</span>
<a name="l04659"></a>04659             g_warning (<span class="stringliteral">&quot;%s: fork_connection failed\n&quot;</span>, __FUNCTION__);
<a name="l04660"></a>04660             <a class="code" href="manage_8c.html#a4855b1e67b70882496413511bcd2426e" title="Set a task&amp;#39;s schedule so that it runs again next scheduling round.">reschedule_task</a> (task_uuid);
<a name="l04661"></a>04661             g_free (task_uuid);
<a name="l04662"></a>04662             g_free (owner);
<a name="l04663"></a>04663             g_free (owner_uuid);
<a name="l04664"></a>04664             exit (EXIT_FAILURE);
<a name="l04665"></a>04665 
<a name="l04666"></a>04666           <span class="keywordflow">default</span>:
<a name="l04667"></a>04667             {
<a name="l04668"></a>04668               <span class="keywordtype">int</span> status;
<a name="l04669"></a>04669 
<a name="l04670"></a>04670               <span class="comment">/* Parent.  Wait for child, to check return. */</span>
<a name="l04671"></a>04671 
<a name="l04672"></a>04672               g_debug (<span class="stringliteral">&quot;%s: %i fork_connectioned %i&quot;</span>,
<a name="l04673"></a>04673                        __FUNCTION__, getpid (), pid);
<a name="l04674"></a>04674 
<a name="l04675"></a>04675               g_free (owner);
<a name="l04676"></a>04676               g_free (owner_uuid);
<a name="l04677"></a>04677 
<a name="l04678"></a>04678               <span class="keywordflow">if</span> (signal (SIGCHLD, SIG_DFL) == SIG_ERR)
<a name="l04679"></a>04679                 g_warning (<span class="stringliteral">&quot;%s: failed to set SIGCHLD&quot;</span>, __FUNCTION__);
<a name="l04680"></a>04680               <span class="keywordflow">while</span> (waitpid (pid, &amp;status, 0) &lt; 0)
<a name="l04681"></a>04681                 {
<a name="l04682"></a>04682                   <span class="keywordflow">if</span> (errno == ECHILD)
<a name="l04683"></a>04683                     {
<a name="l04684"></a>04684                       g_warning (<span class="stringliteral">&quot;%s: Failed to get child exit,&quot;</span>
<a name="l04685"></a>04685                                  <span class="stringliteral">&quot; so task &apos;%s&apos; may not have been scheduled&quot;</span>,
<a name="l04686"></a>04686                                  __FUNCTION__,
<a name="l04687"></a>04687                                  task_uuid);
<a name="l04688"></a>04688                       g_free (task_uuid);
<a name="l04689"></a>04689                       exit (EXIT_FAILURE);
<a name="l04690"></a>04690                     }
<a name="l04691"></a>04691                   <span class="keywordflow">if</span> (errno == EINTR)
<a name="l04692"></a>04692                     <span class="keywordflow">continue</span>;
<a name="l04693"></a>04693                   g_warning (<span class="stringliteral">&quot;%s: waitpid: %s&quot;</span>,
<a name="l04694"></a>04694                              __FUNCTION__,
<a name="l04695"></a>04695                              strerror (errno));
<a name="l04696"></a>04696                   g_warning (<span class="stringliteral">&quot;%s: As a result, task &apos;%s&apos; may not have been&quot;</span>
<a name="l04697"></a>04697                              <span class="stringliteral">&quot; scheduled&quot;</span>,
<a name="l04698"></a>04698                              __FUNCTION__,
<a name="l04699"></a>04699                              task_uuid);
<a name="l04700"></a>04700                   g_free (task_uuid);
<a name="l04701"></a>04701                   exit (EXIT_FAILURE);
<a name="l04702"></a>04702                 }
<a name="l04703"></a>04703               <span class="keywordflow">if</span> (WIFEXITED (status))
<a name="l04704"></a>04704                 <span class="keywordflow">switch</span> (WEXITSTATUS (status))
<a name="l04705"></a>04705                   {
<a name="l04706"></a>04706                     <span class="keywordflow">case</span> EXIT_SUCCESS:
<a name="l04707"></a>04707                       <span class="comment">/* Child succeeded. */</span>
<a name="l04708"></a>04708                       g_free (task_uuid);
<a name="l04709"></a>04709                       exit (EXIT_SUCCESS);
<a name="l04710"></a>04710 
<a name="l04711"></a>04711                     <span class="keywordflow">case</span> EXIT_FAILURE:
<a name="l04712"></a>04712                     <span class="keywordflow">default</span>:
<a name="l04713"></a>04713                       <span class="keywordflow">break</span>;
<a name="l04714"></a>04714                   }
<a name="l04715"></a>04715 
<a name="l04716"></a>04716               <span class="comment">/* Child failed, reset task schedule time and exit. */</span>
<a name="l04717"></a>04717 
<a name="l04718"></a>04718               g_warning (<span class="stringliteral">&quot;%s: child failed\n&quot;</span>, __FUNCTION__);
<a name="l04719"></a>04719               <a class="code" href="manage_8c.html#a4855b1e67b70882496413511bcd2426e" title="Set a task&amp;#39;s schedule so that it runs again next scheduling round.">reschedule_task</a> (task_uuid);
<a name="l04720"></a>04720               g_free (task_uuid);
<a name="l04721"></a>04721 
<a name="l04722"></a>04722               exit (EXIT_FAILURE);
<a name="l04723"></a>04723             }
<a name="l04724"></a>04724         }
<a name="l04725"></a>04725 
<a name="l04726"></a>04726       <span class="comment">/* Start the task. */</span>
<a name="l04727"></a>04727 
<a name="l04728"></a>04728       <span class="keywordflow">if</span> (omp_authenticate (&amp;session, owner, <span class="stringliteral">&quot;&quot;</span>))
<a name="l04729"></a>04729         {
<a name="l04730"></a>04730           g_warning (<span class="stringliteral">&quot;%s: omp_authenticate failed&quot;</span>, __FUNCTION__);
<a name="l04731"></a>04731           g_free (task_uuid);
<a name="l04732"></a>04732           g_free (owner);
<a name="l04733"></a>04733           openvas_server_free (socket, session, credentials);
<a name="l04734"></a>04734           exit (EXIT_FAILURE);
<a name="l04735"></a>04735         }
<a name="l04736"></a>04736 
<a name="l04737"></a>04737       g_free (owner);
<a name="l04738"></a>04738 
<a name="l04739"></a>04739       <span class="keywordflow">if</span> (omp_resume_or_start_task (&amp;session, task_uuid))
<a name="l04740"></a>04740         {
<a name="l04741"></a>04741           g_warning (<span class="stringliteral">&quot;%s: omp_resume_or_start_task failed&quot;</span>, __FUNCTION__);
<a name="l04742"></a>04742           g_free (task_uuid);
<a name="l04743"></a>04743           openvas_server_free (socket, session, credentials);
<a name="l04744"></a>04744           exit (EXIT_FAILURE);
<a name="l04745"></a>04745         }
<a name="l04746"></a>04746 
<a name="l04747"></a>04747       g_free (task_uuid);
<a name="l04748"></a>04748       openvas_server_free (socket, session, credentials);
<a name="l04749"></a>04749       exit (EXIT_SUCCESS);
<a name="l04750"></a>04750    }
<a name="l04751"></a>04751 
<a name="l04752"></a>04752   <span class="comment">/* Stop tasks in forked processes, now that the SQL statement is closed. */</span>
<a name="l04753"></a>04753 
<a name="l04754"></a>04754   <span class="keywordflow">while</span> (stops)
<a name="l04755"></a>04755     {
<a name="l04756"></a>04756       <span class="keywordtype">int</span> socket;
<a name="l04757"></a>04757       gnutls_session_t session;
<a name="l04758"></a>04758       gnutls_certificate_credentials_t credentials;
<a name="l04759"></a>04759       gchar *task_uuid, *owner, *owner_uuid;
<a name="l04760"></a>04760       GSList *head;
<a name="l04761"></a>04761 
<a name="l04762"></a>04762       owner = stops-&gt;data;
<a name="l04763"></a>04763       assert (stops-&gt;next);
<a name="l04764"></a>04764       owner_uuid = stops-&gt;next-&gt;data;
<a name="l04765"></a>04765       assert (stops-&gt;next-&gt;next);
<a name="l04766"></a>04766       task_uuid = stops-&gt;next-&gt;next-&gt;data;
<a name="l04767"></a>04767 
<a name="l04768"></a>04768       head = stops;
<a name="l04769"></a>04769       stops = stops-&gt;next-&gt;next-&gt;next;
<a name="l04770"></a>04770       g_slist_free_1 (head-&gt;next-&gt;next);
<a name="l04771"></a>04771       g_slist_free_1 (head-&gt;next);
<a name="l04772"></a>04772       g_slist_free_1 (head);
<a name="l04773"></a>04773 
<a name="l04774"></a>04774       <span class="comment">/* TODO As with starts above, this should retry if the stop failed. */</span>
<a name="l04775"></a>04775 
<a name="l04776"></a>04776       <span class="comment">/* Run the callback to fork a child connected to the Manager. */</span>
<a name="l04777"></a>04777 
<a name="l04778"></a>04778       <span class="keywordflow">switch</span> (fork_connection (&amp;socket, &amp;session, &amp;credentials, owner_uuid))
<a name="l04779"></a>04779         {
<a name="l04780"></a>04780           <span class="keywordflow">case</span> 0:
<a name="l04781"></a>04781             <span class="comment">/* Child.  Break, stop task, exit. */</span>
<a name="l04782"></a>04782             <span class="keywordflow">while</span> (stops)
<a name="l04783"></a>04783               {
<a name="l04784"></a>04784                 g_free (stops-&gt;data);
<a name="l04785"></a>04785                 stops = g_slist_delete_link (stops, stops);
<a name="l04786"></a>04786               }
<a name="l04787"></a>04787             <span class="keywordflow">break</span>;
<a name="l04788"></a>04788 
<a name="l04789"></a>04789           <span class="keywordflow">case</span> -1:
<a name="l04790"></a>04790             <span class="comment">/* Parent on error. */</span>
<a name="l04791"></a>04791             g_free (task_uuid);
<a name="l04792"></a>04792             g_free (owner);
<a name="l04793"></a>04793             g_free (owner_uuid);
<a name="l04794"></a>04794             <span class="keywordflow">while</span> (stops)
<a name="l04795"></a>04795               {
<a name="l04796"></a>04796                 g_free (stops-&gt;data);
<a name="l04797"></a>04797                 stops = g_slist_delete_link (stops, stops);
<a name="l04798"></a>04798               }
<a name="l04799"></a>04799             g_warning (<span class="stringliteral">&quot;%s: stop fork failed\n&quot;</span>, __FUNCTION__);
<a name="l04800"></a>04800             <span class="keywordflow">return</span> -1;
<a name="l04801"></a>04801             <span class="keywordflow">break</span>;
<a name="l04802"></a>04802 
<a name="l04803"></a>04803           <span class="keywordflow">default</span>:
<a name="l04804"></a>04804             <span class="comment">/* Parent.  Continue to next task. */</span>
<a name="l04805"></a>04805             g_free (task_uuid);
<a name="l04806"></a>04806             g_free (owner);
<a name="l04807"></a>04807             g_free (owner_uuid);
<a name="l04808"></a>04808             <span class="keywordflow">continue</span>;
<a name="l04809"></a>04809             <span class="keywordflow">break</span>;
<a name="l04810"></a>04810         }
<a name="l04811"></a>04811 
<a name="l04812"></a>04812       <span class="comment">/* Stop the task. */</span>
<a name="l04813"></a>04813 
<a name="l04814"></a>04814       <span class="keywordflow">if</span> (omp_authenticate (&amp;session, owner, <span class="stringliteral">&quot;&quot;</span>))
<a name="l04815"></a>04815         {
<a name="l04816"></a>04816           g_free (task_uuid);
<a name="l04817"></a>04817           g_free (owner);
<a name="l04818"></a>04818           g_free (owner_uuid);
<a name="l04819"></a>04819           openvas_server_free (socket, session, credentials);
<a name="l04820"></a>04820           exit (EXIT_FAILURE);
<a name="l04821"></a>04821         }
<a name="l04822"></a>04822 
<a name="l04823"></a>04823       <span class="keywordflow">if</span> (omp_stop_task (&amp;session, task_uuid))
<a name="l04824"></a>04824         {
<a name="l04825"></a>04825           g_free (task_uuid);
<a name="l04826"></a>04826           g_free (owner);
<a name="l04827"></a>04827           g_free (owner_uuid);
<a name="l04828"></a>04828           openvas_server_free (socket, session, credentials);
<a name="l04829"></a>04829           exit (EXIT_FAILURE);
<a name="l04830"></a>04830         }
<a name="l04831"></a>04831 
<a name="l04832"></a>04832       g_free (task_uuid);
<a name="l04833"></a>04833       g_free (owner);
<a name="l04834"></a>04834       g_free (owner_uuid);
<a name="l04835"></a>04835       openvas_server_free (socket, session, credentials);
<a name="l04836"></a>04836       exit (EXIT_SUCCESS);
<a name="l04837"></a>04837    }
<a name="l04838"></a>04838 
<a name="l04839"></a>04839   <span class="keywordflow">return</span> 0;
<a name="l04840"></a>04840 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a75d60659cab32889f30876e3e53e88bc"></a><!-- doxytag: member="manage.c::manage_system_report" ref="a75d60659cab32889f30876e3e53e88bc" args="(const char *name, const char *duration, const char *slave_id, char **report)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int manage_system_report </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>duration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>slave_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>report</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get a system report. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>Name of report. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>duration</em>&nbsp;</td><td>Time range of report, in seconds. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>slave_id</em>&nbsp;</td><td>ID of slave to get report from. 0 for local. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>report</em>&nbsp;</td><td>On success, report in base64 if such a report exists else NULL. Arbitrary on error.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if successful (including failure to find report), -1 on error, 3 if used the fallback report. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04257">4257</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8c_source.html#l04239">FALLBACK_SYSTEM_REPORT_HEADER</a>, <a class="el" href="manage_8c_source.html#l04257">manage_system_report()</a>, and <a class="el" href="tracef_8h_source.html#l00089">tracef</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l04257">manage_system_report()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04259"></a>04259 {
<a name="l04260"></a>04260   gchar *astdout = NULL;
<a name="l04261"></a>04261   gchar *astderr = NULL;
<a name="l04262"></a>04262   GError *err = NULL;
<a name="l04263"></a>04263   gint exit_status;
<a name="l04264"></a>04264   gchar *command;
<a name="l04265"></a>04265 
<a name="l04266"></a>04266   assert (name);
<a name="l04267"></a>04267 
<a name="l04268"></a>04268   <span class="keywordflow">if</span> (duration == NULL)
<a name="l04269"></a>04269     duration = <span class="stringliteral">&quot;86400&quot;</span>;
<a name="l04270"></a>04270 
<a name="l04271"></a>04271   <span class="keywordflow">if</span> (slave_id &amp;&amp; strcmp (slave_id, <span class="stringliteral">&quot;0&quot;</span>))
<a name="l04272"></a>04272     <span class="keywordflow">return</span> slave_system_report (name, duration, slave_id, report);
<a name="l04273"></a>04273 
<a name="l04274"></a>04274   <span class="comment">/* For simplicity, it&apos;s up to the command to do the base64 encoding. */</span>
<a name="l04275"></a>04275   command = g_strdup_printf (<span class="stringliteral">&quot;openvasmr %s %s&quot;</span>, duration, name);
<a name="l04276"></a>04276 
<a name="l04277"></a>04277   <a class="code" href="tracef_8h.html#a70d339a461f334e16086ab23b83cedc4" title="Formatted trace output.">tracef</a> (<span class="stringliteral">&quot;   command: %s&quot;</span>, command);
<a name="l04278"></a>04278 
<a name="l04279"></a>04279   <span class="keywordflow">if</span> ((g_spawn_command_line_sync (command,
<a name="l04280"></a>04280                                   &amp;astdout,
<a name="l04281"></a>04281                                   &amp;astderr,
<a name="l04282"></a>04282                                   &amp;exit_status,
<a name="l04283"></a>04283                                   &amp;err)
<a name="l04284"></a>04284        == FALSE)
<a name="l04285"></a>04285       || (WIFEXITED (exit_status) == 0)
<a name="l04286"></a>04286       || WEXITSTATUS (exit_status))
<a name="l04287"></a>04287     {
<a name="l04288"></a>04288       <span class="keywordtype">int</span> ret;
<a name="l04289"></a>04289       <span class="keywordtype">double</span> load[3];
<a name="l04290"></a>04290       GError *get_error;
<a name="l04291"></a>04291       gchar *output;
<a name="l04292"></a>04292       gsize output_len;
<a name="l04293"></a>04293       GString *buffer;
<a name="l04294"></a>04294 
<a name="l04295"></a>04295       <a class="code" href="tracef_8h.html#a70d339a461f334e16086ab23b83cedc4" title="Formatted trace output.">tracef</a> (<span class="stringliteral">&quot;%s: openvasmr failed with %d&quot;</span>, __FUNCTION__, exit_status);
<a name="l04296"></a>04296       <a class="code" href="tracef_8h.html#a70d339a461f334e16086ab23b83cedc4" title="Formatted trace output.">tracef</a> (<span class="stringliteral">&quot;%s: stdout: %s&quot;</span>, __FUNCTION__, astdout);
<a name="l04297"></a>04297       <a class="code" href="tracef_8h.html#a70d339a461f334e16086ab23b83cedc4" title="Formatted trace output.">tracef</a> (<span class="stringliteral">&quot;%s: stderr: %s&quot;</span>, __FUNCTION__, astderr);
<a name="l04298"></a>04298       g_free (astdout);
<a name="l04299"></a>04299       g_free (astderr);
<a name="l04300"></a>04300       g_free (command);
<a name="l04301"></a>04301 
<a name="l04302"></a>04302       buffer = g_string_new (<a class="code" href="manage_8c.html#af6e390f828fc5640de75627d993a623e" title="Header for fallback system report.">FALLBACK_SYSTEM_REPORT_HEADER</a>);
<a name="l04303"></a>04303 
<a name="l04304"></a>04304       ret = getloadavg (load, 3);
<a name="l04305"></a>04305       <span class="keywordflow">if</span> (ret == 3)
<a name="l04306"></a>04306         {
<a name="l04307"></a>04307           g_string_append_printf (buffer,
<a name="l04308"></a>04308                                   <span class="stringliteral">&quot;Load average for past minute:     %.1f\n&quot;</span>,
<a name="l04309"></a>04309                                   load[0]);
<a name="l04310"></a>04310           g_string_append_printf (buffer,
<a name="l04311"></a>04311                                   <span class="stringliteral">&quot;Load average for past 5 minutes:  %.1f\n&quot;</span>,
<a name="l04312"></a>04312                                   load[1]);
<a name="l04313"></a>04313           g_string_append_printf (buffer,
<a name="l04314"></a>04314                                   <span class="stringliteral">&quot;Load average for past 15 minutes: %.1f\n&quot;</span>,
<a name="l04315"></a>04315                                   load[2]);
<a name="l04316"></a>04316         }
<a name="l04317"></a>04317       <span class="keywordflow">else</span>
<a name="l04318"></a>04318         g_string_append (buffer, <span class="stringliteral">&quot;Error getting load averages.\n&quot;</span>);
<a name="l04319"></a>04319 
<a name="l04320"></a>04320       get_error = NULL;
<a name="l04321"></a>04321       g_file_get_contents (<span class="stringliteral">&quot;/proc/meminfo&quot;</span>,
<a name="l04322"></a>04322                            &amp;output,
<a name="l04323"></a>04323                            &amp;output_len,
<a name="l04324"></a>04324                            &amp;get_error);
<a name="l04325"></a>04325       <span class="keywordflow">if</span> (get_error)
<a name="l04326"></a>04326         g_error_free (get_error);
<a name="l04327"></a>04327       <span class="keywordflow">else</span>
<a name="l04328"></a>04328         {
<a name="l04329"></a>04329           gchar *safe;
<a name="l04330"></a>04330           g_string_append (buffer, <span class="stringliteral">&quot;\n/proc/meminfo:\n\n&quot;</span>);
<a name="l04331"></a>04331           safe = g_markup_escape_text (output, strlen (output));
<a name="l04332"></a>04332           g_free (output);
<a name="l04333"></a>04333           g_string_append (buffer, safe);
<a name="l04334"></a>04334           g_free (safe);
<a name="l04335"></a>04335         }
<a name="l04336"></a>04336 
<a name="l04337"></a>04337       *report = g_string_free (buffer, FALSE);
<a name="l04338"></a>04338       <span class="keywordflow">return</span> 3;
<a name="l04339"></a>04339     }
<a name="l04340"></a>04340   g_free (astderr);
<a name="l04341"></a>04341   g_free (command);
<a name="l04342"></a>04342   <span class="keywordflow">if</span> (astdout == NULL || strlen (astdout) == 0)
<a name="l04343"></a>04343     {
<a name="l04344"></a>04344       g_free (astdout);
<a name="l04345"></a>04345       <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;blank&quot;</span>) == 0)
<a name="l04346"></a>04346         <span class="keywordflow">return</span> -1;
<a name="l04347"></a>04347       <span class="keywordflow">return</span> <a class="code" href="manage_8c.html#a75d60659cab32889f30876e3e53e88bc" title="Get a system report.">manage_system_report</a> (<span class="stringliteral">&quot;blank&quot;</span>, duration, NULL, report);
<a name="l04348"></a>04348     }
<a name="l04349"></a>04349   <span class="keywordflow">else</span>
<a name="l04350"></a>04350     *report = astdout;
<a name="l04351"></a>04351   <span class="keywordflow">return</span> 0;
<a name="l04352"></a>04352 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a66adb3baa17b97367ce9e3db83c15f37"></a><!-- doxytag: member="manage.c::message_type_threat" ref="a66adb3baa17b97367ce9e3db83c15f37" args="(const char *type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* message_type_threat </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>type</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the threat of a message type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>type</em>&nbsp;</td><td>Message type.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Static threat name if type names a message type, else NULL. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00178">178</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l36410">note_iterator_threat()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00179"></a>00179 {
<a name="l00180"></a>00180   <span class="keywordflow">if</span> (strcasecmp (type, <span class="stringliteral">&quot;Alarm&quot;</span>) == 0)
<a name="l00181"></a>00181     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Alarm&quot;</span>;
<a name="l00182"></a>00182   <span class="keywordflow">if</span> (strcasecmp (type, <span class="stringliteral">&quot;Security Hole&quot;</span>) == 0)
<a name="l00183"></a>00183     <span class="keywordflow">return</span> <span class="stringliteral">&quot;High&quot;</span>;
<a name="l00184"></a>00184   <span class="keywordflow">if</span> (strcasecmp (type, <span class="stringliteral">&quot;Security Warning&quot;</span>) == 0)
<a name="l00185"></a>00185     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Medium&quot;</span>;
<a name="l00186"></a>00186   <span class="keywordflow">if</span> (strcasecmp (type, <span class="stringliteral">&quot;Security Note&quot;</span>) == 0)
<a name="l00187"></a>00187     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Low&quot;</span>;
<a name="l00188"></a>00188   <span class="keywordflow">if</span> (strcasecmp (type, <span class="stringliteral">&quot;Log Message&quot;</span>) == 0)
<a name="l00189"></a>00189     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Log&quot;</span>;
<a name="l00190"></a>00190   <span class="keywordflow">if</span> (strcasecmp (type, <span class="stringliteral">&quot;Debug Message&quot;</span>) == 0)
<a name="l00191"></a>00191     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Debug&quot;</span>;
<a name="l00192"></a>00192   <span class="keywordflow">if</span> (strcasecmp (type, <span class="stringliteral">&quot;False Positive&quot;</span>) == 0)
<a name="l00193"></a>00193     <span class="keywordflow">return</span> <span class="stringliteral">&quot;False Positive&quot;</span>;
<a name="l00194"></a>00194   <span class="keywordflow">return</span> NULL;
<a name="l00195"></a>00195 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="af79592f2381960eb3644312fcc345600"></a><!-- doxytag: member="manage.c::next_file" ref="af79592f2381960eb3644312fcc345600" args="(file_iterator_t *iterator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean next_file </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structfile__iterator__t.html">file_iterator_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Increment a report type iterator. </p>
<p>The caller must stop using this after it returns FALSE.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>iterator</em>&nbsp;</td><td>Task iterator.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE if there was a next item, else FALSE. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05048">5048</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l02358">file_iterator_t::current</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l40106">verify_report_format_internal()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05049"></a>05049 {
<a name="l05050"></a>05050   iterator-&gt;<a class="code" href="structfile__iterator__t.html#a47f952665998ffcaef59a7bd2be9433c" title="Current file.">current</a>++;
<a name="l05051"></a>05051   <span class="keywordflow">if</span> (*iterator-&gt;<a class="code" href="structfile__iterator__t.html#a47f952665998ffcaef59a7bd2be9433c" title="Current file.">current</a> == NULL) <span class="keywordflow">return</span> FALSE;
<a name="l05052"></a>05052   <span class="keywordflow">return</span> TRUE;
<a name="l05053"></a>05053 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a83cda8461bc3072ba25435729d665de4"></a><!-- doxytag: member="manage.c::next_report_type" ref="a83cda8461bc3072ba25435729d665de4" args="(report_type_iterator_t *iterator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean next_report_type </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structreport__type__iterator__t.html">report_type_iterator_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Increment a report type iterator. </p>
<p>The caller must stop using this after it returns FALSE.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>iterator</em>&nbsp;</td><td>Task iterator.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE if there was a next item, else FALSE. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04119">4119</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l02074">report_type_iterator_t::current</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04120"></a>04120 {
<a name="l04121"></a>04121   iterator-&gt;<a class="code" href="structreport__type__iterator__t.html#aef30e4a63f98728f2d7c7db8f7ff9b61" title="Current type.">current</a>++;
<a name="l04122"></a>04122   <span class="keywordflow">if</span> (*iterator-&gt;<a class="code" href="structreport__type__iterator__t.html#aef30e4a63f98728f2d7c7db8f7ff9b61" title="Current type.">current</a> == NULL) <span class="keywordflow">return</span> FALSE;
<a name="l04123"></a>04123   <span class="keywordflow">return</span> TRUE;
<a name="l04124"></a>04124 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9b642d8002942f0f0b8fb3cb3d3937b7"></a><!-- doxytag: member="manage.c::next_time" ref="a9b642d8002942f0f0b8fb3cb3d3937b7" args="(time_t first, int period, int period_months)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t next_time </td>
          <td>(</td>
          <td class="paramtype">time_t&nbsp;</td>
          <td class="paramname"> <em>first</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>period</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>period_months</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate the next time from now given a start time and a period. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>first</em>&nbsp;</td><td>The first time. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>period</em>&nbsp;</td><td>The period in seconds. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>period_months</em>&nbsp;</td><td>The period in months.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the next time a schedule with the given times is due. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04378">4378</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage__sql_8c_source.html#l37963">add_months()</a>, and <a class="el" href="manage__sql_8c_source.html#l37898">months_between()</a>.</p>

<p>Referenced by <a class="el" href="sql_8c_source.html#l01041">sql_next_time()</a>, and <a class="el" href="manage__sql_8c_source.html#l13789">task_schedule_next_time_tz()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04379"></a>04379 {
<a name="l04380"></a>04380   <span class="keywordtype">int</span> periods_diff;
<a name="l04381"></a>04381   time_t now = time (NULL);
<a name="l04382"></a>04382 
<a name="l04383"></a>04383   <span class="keywordflow">if</span> (first &gt;= now)
<a name="l04384"></a>04384     {
<a name="l04385"></a>04385       <span class="keywordflow">return</span> first;
<a name="l04386"></a>04386     }
<a name="l04387"></a>04387   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (period &gt; 0)
<a name="l04388"></a>04388     {
<a name="l04389"></a>04389       <span class="keywordflow">return</span> first + ((((now - first) / period) + 1) * period);
<a name="l04390"></a>04390     }
<a name="l04391"></a>04391   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (period_months &gt; 0)
<a name="l04392"></a>04392     {
<a name="l04393"></a>04393       periods_diff = <a class="code" href="manage__sql_8c.html#a4d8a11f127b4ed1ddc697d5c4af30bf5" title="Count number of full months between two times.">months_between</a> (first, now) / period_months;
<a name="l04394"></a>04394       <span class="keywordflow">if</span> (<a class="code" href="manage__sql_8c.html#ac2f93247e09ac165faff05bc66621da0" title="Add months to a time.">add_months</a> (first, (periods_diff + 1) * period_months)
<a name="l04395"></a>04395           &gt;= now)
<a name="l04396"></a>04396         <span class="keywordflow">return</span> <a class="code" href="manage__sql_8c.html#ac2f93247e09ac165faff05bc66621da0" title="Add months to a time.">add_months</a> (first, (periods_diff + 1) * period_months);
<a name="l04397"></a>04397       <span class="keywordflow">else</span>
<a name="l04398"></a>04398         <span class="keywordflow">return</span> <a class="code" href="manage__sql_8c.html#ac2f93247e09ac165faff05bc66621da0" title="Add months to a time.">add_months</a> (first, periods_diff * period_months);
<a name="l04399"></a>04399     }
<a name="l04400"></a>04400   <span class="keywordflow">return</span> 0;
<a name="l04401"></a>04401 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ae8b0f2cd415f9029da6b7881bf6ac041"></a><!-- doxytag: member="manage.c::openvas_current_sync" ref="ae8b0f2cd415f9029da6b7881bf6ac041" args="(const gchar *sync_script, gchar **timestamp, gchar **user)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int openvas_current_sync </td>
          <td>(</td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>sync_script</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar **&nbsp;</td>
          <td class="paramname"> <em>timestamp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar **&nbsp;</td>
          <td class="paramname"> <em>user</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Determine if the administrator is synchronizing with a feed. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sync_script</em>&nbsp;</td><td>The file name of the synchronization script. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>timestamp</em>&nbsp;</td><td>Newly allocated time that sync started, if syncing. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>user</em>&nbsp;</td><td>Newly allocated user who started sync, if syncing.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 success, 1 success when sync in progress, -1 error. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l06791">6791</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l06793"></a>06793 {
<a name="l06794"></a>06794   gchar *lockfile_name, *content, **lines;
<a name="l06795"></a>06795   GError *error = NULL;
<a name="l06796"></a>06796 
<a name="l06797"></a>06797   g_assert (sync_script);
<a name="l06798"></a>06798 
<a name="l06799"></a>06799   lockfile_name =
<a name="l06800"></a>06800     g_build_filename (g_get_tmp_dir (), <span class="stringliteral">&quot;openvas-feed-sync&quot;</span>, sync_script, NULL);
<a name="l06801"></a>06801   <span class="keywordflow">if</span> (!g_file_get_contents (lockfile_name, &amp;content, NULL, &amp;error))
<a name="l06802"></a>06802     {
<a name="l06803"></a>06803       <span class="keywordflow">if</span> (g_error_matches (error, G_FILE_ERROR, G_FILE_ERROR_NOENT)
<a name="l06804"></a>06804           || g_error_matches (error, G_FILE_ERROR, G_FILE_ERROR_ACCES))
<a name="l06805"></a>06805         {
<a name="l06806"></a>06806           g_error_free (error);
<a name="l06807"></a>06807           g_free (lockfile_name);
<a name="l06808"></a>06808           <span class="keywordflow">return</span> 0;
<a name="l06809"></a>06809         }
<a name="l06810"></a>06810 
<a name="l06811"></a>06811       g_warning (<span class="stringliteral">&quot;%s: %s&quot;</span>, __FUNCTION__, error-&gt;message);
<a name="l06812"></a>06812       g_error_free (error);
<a name="l06813"></a>06813       g_free (lockfile_name);
<a name="l06814"></a>06814       <span class="keywordflow">return</span> -1;
<a name="l06815"></a>06815     }
<a name="l06816"></a>06816 
<a name="l06817"></a>06817   lines = g_strsplit (content, <span class="stringliteral">&quot;\n&quot;</span>, 2);
<a name="l06818"></a>06818   g_free (content);
<a name="l06819"></a>06819   <span class="keywordflow">if</span> (lines[0] &amp;&amp; lines[1])
<a name="l06820"></a>06820     {
<a name="l06821"></a>06821       *timestamp = g_strdup (lines[0]);
<a name="l06822"></a>06822       *user = g_strdup (lines[1]);
<a name="l06823"></a>06823 
<a name="l06824"></a>06824       g_free (lockfile_name);
<a name="l06825"></a>06825       g_strfreev (lines);
<a name="l06826"></a>06826       <span class="keywordflow">return</span> 1;
<a name="l06827"></a>06827     }
<a name="l06828"></a>06828 
<a name="l06829"></a>06829   g_free (lockfile_name);
<a name="l06830"></a>06830   g_strfreev (lines);
<a name="l06831"></a>06831   <span class="keywordflow">return</span> -1;
<a name="l06832"></a>06832 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9c689855cdd11bbca15deaed4afe1208"></a><!-- doxytag: member="manage.c::openvas_get_sync_script_description" ref="a9c689855cdd11bbca15deaed4afe1208" args="(const gchar *sync_script, gchar **description)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean openvas_get_sync_script_description </td>
          <td>(</td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>sync_script</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar **&nbsp;</td>
          <td class="paramname"> <em>description</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieves description of a feed sync script, with basic validation. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sync_script</em>&nbsp;</td><td>The file name of the synchronization script. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>description</em>&nbsp;</td><td>Return location of the description string.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE if the description was retrieved, or FALSE if an error occured. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l06133">6133</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l06135"></a>06135 {
<a name="l06136"></a>06136   g_assert (sync_script);
<a name="l06137"></a>06137   g_assert_cmpstr (*description, ==, NULL);
<a name="l06138"></a>06138 
<a name="l06139"></a>06139   gchar *script_working_dir = g_path_get_dirname (sync_script);
<a name="l06140"></a>06140 
<a name="l06141"></a>06141   gchar **argv = (gchar **) g_malloc (3 * <span class="keyword">sizeof</span> (gchar *));
<a name="l06142"></a>06142   argv[0] = g_strdup (sync_script);
<a name="l06143"></a>06143   argv[1] = g_strdup (<span class="stringliteral">&quot;--describe&quot;</span>);
<a name="l06144"></a>06144   argv[2] = NULL;
<a name="l06145"></a>06145 
<a name="l06146"></a>06146   gchar *script_out;
<a name="l06147"></a>06147   gchar *script_err;
<a name="l06148"></a>06148   gint script_exit;
<a name="l06149"></a>06149   GError *error = NULL;
<a name="l06150"></a>06150 
<a name="l06151"></a>06151   <span class="keywordflow">if</span> (!g_spawn_sync
<a name="l06152"></a>06152       (script_working_dir, argv, NULL, 0, NULL, NULL, &amp;script_out, &amp;script_err,
<a name="l06153"></a>06153        &amp;script_exit, &amp;error))
<a name="l06154"></a>06154     {
<a name="l06155"></a>06155       g_warning (<span class="stringliteral">&quot;Failed to execute %s: %s&quot;</span>, sync_script, error-&gt;message);
<a name="l06156"></a>06156 
<a name="l06157"></a>06157       g_free (script_working_dir);
<a name="l06158"></a>06158       g_strfreev (argv);
<a name="l06159"></a>06159       g_free (script_out);
<a name="l06160"></a>06160       g_free (script_err);
<a name="l06161"></a>06161       g_error_free (error);
<a name="l06162"></a>06162 
<a name="l06163"></a>06163       <span class="keywordflow">return</span> FALSE;
<a name="l06164"></a>06164     }
<a name="l06165"></a>06165 
<a name="l06166"></a>06166   <span class="keywordflow">if</span> (script_exit != 0)
<a name="l06167"></a>06167     {
<a name="l06168"></a>06168       g_warning (<span class="stringliteral">&quot;%s returned a non-zero exit code.&quot;</span>, sync_script);
<a name="l06169"></a>06169 
<a name="l06170"></a>06170       g_free (script_working_dir);
<a name="l06171"></a>06171       g_strfreev (argv);
<a name="l06172"></a>06172       g_free (script_out);
<a name="l06173"></a>06173       g_free (script_err);
<a name="l06174"></a>06174 
<a name="l06175"></a>06175       <span class="keywordflow">return</span> FALSE;
<a name="l06176"></a>06176     }
<a name="l06177"></a>06177 
<a name="l06178"></a>06178   *description = g_strdup (script_out);
<a name="l06179"></a>06179 
<a name="l06180"></a>06180   g_free (script_working_dir);
<a name="l06181"></a>06181   g_strfreev (argv);
<a name="l06182"></a>06182   g_free (script_out);
<a name="l06183"></a>06183   g_free (script_err);
<a name="l06184"></a>06184 
<a name="l06185"></a>06185   <span class="keywordflow">return</span> TRUE;
<a name="l06186"></a>06186 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8515ab3691396e6faca41b210490d31e"></a><!-- doxytag: member="manage.c::openvas_get_sync_script_feed_version" ref="a8515ab3691396e6faca41b210490d31e" args="(const gchar *sync_script, gchar **feed_version)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean openvas_get_sync_script_feed_version </td>
          <td>(</td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>sync_script</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar **&nbsp;</td>
          <td class="paramname"> <em>feed_version</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieves the version of a feed handled by the sync, with basic validation. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sync_script</em>&nbsp;</td><td>The file name of the synchronization script. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>feed_version</em>&nbsp;</td><td>Return location of the feed version string.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE if the feed version was retrieved, or FALSE if an error occured. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l06199">6199</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l06201"></a>06201 {
<a name="l06202"></a>06202   g_assert (sync_script);
<a name="l06203"></a>06203   g_assert_cmpstr (*feed_version, ==, NULL);
<a name="l06204"></a>06204 
<a name="l06205"></a>06205   gchar *script_working_dir = g_path_get_dirname (sync_script);
<a name="l06206"></a>06206 
<a name="l06207"></a>06207   gchar **argv = (gchar **) g_malloc (3 * <span class="keyword">sizeof</span> (gchar *));
<a name="l06208"></a>06208   argv[0] = g_strdup (sync_script);
<a name="l06209"></a>06209   argv[1] = g_strdup (<span class="stringliteral">&quot;--feedversion&quot;</span>);
<a name="l06210"></a>06210   argv[2] = NULL;
<a name="l06211"></a>06211 
<a name="l06212"></a>06212   gchar *script_out;
<a name="l06213"></a>06213   gchar *script_err;
<a name="l06214"></a>06214   gint script_exit;
<a name="l06215"></a>06215   GError *error = NULL;
<a name="l06216"></a>06216 
<a name="l06217"></a>06217   <span class="keywordflow">if</span> (!g_spawn_sync
<a name="l06218"></a>06218       (script_working_dir, argv, NULL, 0, NULL, NULL, &amp;script_out, &amp;script_err,
<a name="l06219"></a>06219        &amp;script_exit, &amp;error))
<a name="l06220"></a>06220     {
<a name="l06221"></a>06221       g_warning (<span class="stringliteral">&quot;Failed to execute %s: %s&quot;</span>, sync_script, error-&gt;message);
<a name="l06222"></a>06222 
<a name="l06223"></a>06223       g_free (script_working_dir);
<a name="l06224"></a>06224       g_strfreev (argv);
<a name="l06225"></a>06225       g_free (script_out);
<a name="l06226"></a>06226       g_free (script_err);
<a name="l06227"></a>06227       g_error_free (error);
<a name="l06228"></a>06228 
<a name="l06229"></a>06229       <span class="keywordflow">return</span> FALSE;
<a name="l06230"></a>06230     }
<a name="l06231"></a>06231 
<a name="l06232"></a>06232   <span class="keywordflow">if</span> (script_exit != 0)
<a name="l06233"></a>06233     {
<a name="l06234"></a>06234       g_warning (<span class="stringliteral">&quot;%s returned a non-zero exit code.&quot;</span>, sync_script);
<a name="l06235"></a>06235 
<a name="l06236"></a>06236       g_free (script_working_dir);
<a name="l06237"></a>06237       g_strfreev (argv);
<a name="l06238"></a>06238       g_free (script_out);
<a name="l06239"></a>06239       g_free (script_err);
<a name="l06240"></a>06240 
<a name="l06241"></a>06241       <span class="keywordflow">return</span> FALSE;
<a name="l06242"></a>06242     }
<a name="l06243"></a>06243 
<a name="l06244"></a>06244   *feed_version = g_strdup (script_out);
<a name="l06245"></a>06245 
<a name="l06246"></a>06246   g_free (script_working_dir);
<a name="l06247"></a>06247   g_strfreev (argv);
<a name="l06248"></a>06248   g_free (script_out);
<a name="l06249"></a>06249   g_free (script_err);
<a name="l06250"></a>06250 
<a name="l06251"></a>06251   <span class="keywordflow">return</span> TRUE;
<a name="l06252"></a>06252 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab7aa1701e03a8578fa8e80f8f8eefdfa"></a><!-- doxytag: member="manage.c::openvas_get_sync_script_identification" ref="ab7aa1701e03a8578fa8e80f8f8eefdfa" args="(const gchar *sync_script, gchar **identification, int feed_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean openvas_get_sync_script_identification </td>
          <td>(</td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>sync_script</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar **&nbsp;</td>
          <td class="paramname"> <em>identification</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>feed_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Retrieves the ID string of a feed sync script, with basic validation. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sync_script</em>&nbsp;</td><td>The file name of the synchronization script. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>identification</em>&nbsp;</td><td>Return location of the identification string. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>feed_type</em>&nbsp;</td><td>Could be NVT_FEED, SCAP_FEED or CERT_FEED.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE if the identification string was retrieved, or FALSE if an error occured. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l06038">6038</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l03367">CERT_FEED</a>, <a class="el" href="manage_8h_source.html#l03365">NVT_FEED</a>, and <a class="el" href="manage_8h_source.html#l03366">SCAP_FEED</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l06564">openvas_migrate_secinfo()</a>, and <a class="el" href="manage_8c_source.html#l06268">openvas_sync_feed()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l06041"></a>06041 {
<a name="l06042"></a>06042   g_assert (sync_script);
<a name="l06043"></a>06043   <span class="keywordflow">if</span> (identification)
<a name="l06044"></a>06044     g_assert_cmpstr (*identification, ==, NULL);
<a name="l06045"></a>06045 
<a name="l06046"></a>06046   gchar *script_working_dir = g_path_get_dirname (sync_script);
<a name="l06047"></a>06047 
<a name="l06048"></a>06048   gchar **argv = (gchar **) g_malloc (3 * <span class="keyword">sizeof</span> (gchar *));
<a name="l06049"></a>06049   argv[0] = g_strdup (sync_script);
<a name="l06050"></a>06050   argv[1] = g_strdup (<span class="stringliteral">&quot;--identify&quot;</span>);
<a name="l06051"></a>06051   argv[2] = NULL;
<a name="l06052"></a>06052 
<a name="l06053"></a>06053   gchar *script_out;
<a name="l06054"></a>06054   gchar *script_err;
<a name="l06055"></a>06055   gint script_exit;
<a name="l06056"></a>06056   GError *error = NULL;
<a name="l06057"></a>06057 
<a name="l06058"></a>06058   gchar **script_identification;
<a name="l06059"></a>06059 
<a name="l06060"></a>06060   <span class="keywordflow">if</span> (!g_spawn_sync
<a name="l06061"></a>06061       (script_working_dir, argv, NULL, 0, NULL, NULL, &amp;script_out, &amp;script_err,
<a name="l06062"></a>06062        &amp;script_exit, &amp;error))
<a name="l06063"></a>06063     {
<a name="l06064"></a>06064       g_warning (<span class="stringliteral">&quot;Failed to execute %s: %s&quot;</span>, sync_script, error-&gt;message);
<a name="l06065"></a>06065 
<a name="l06066"></a>06066       g_free (script_working_dir);
<a name="l06067"></a>06067       g_strfreev (argv);
<a name="l06068"></a>06068       g_free (script_out);
<a name="l06069"></a>06069       g_free (script_err);
<a name="l06070"></a>06070       g_error_free (error);
<a name="l06071"></a>06071 
<a name="l06072"></a>06072       <span class="keywordflow">return</span> FALSE;
<a name="l06073"></a>06073     }
<a name="l06074"></a>06074 
<a name="l06075"></a>06075   <span class="keywordflow">if</span> (script_exit != 0)
<a name="l06076"></a>06076     {
<a name="l06077"></a>06077       g_warning (<span class="stringliteral">&quot;%s returned a non-zero exit code.&quot;</span>, sync_script);
<a name="l06078"></a>06078 
<a name="l06079"></a>06079       g_free (script_working_dir);
<a name="l06080"></a>06080       g_strfreev (argv);
<a name="l06081"></a>06081       g_free (script_out);
<a name="l06082"></a>06082       g_free (script_err);
<a name="l06083"></a>06083 
<a name="l06084"></a>06084       <span class="keywordflow">return</span> FALSE;
<a name="l06085"></a>06085     }
<a name="l06086"></a>06086 
<a name="l06087"></a>06087   script_identification = g_strsplit (script_out, <span class="stringliteral">&quot;|&quot;</span>, 6);
<a name="l06088"></a>06088 
<a name="l06089"></a>06089   <span class="keywordflow">if</span> ((script_identification[0] == NULL)
<a name="l06090"></a>06090       || (feed_type == <a class="code" href="manage_8h.html#a4a0fd5480c0298aa2d4d8b0184caf009">NVT_FEED</a>
<a name="l06091"></a>06091           &amp;&amp; g_ascii_strncasecmp (script_identification[0],<span class="stringliteral">&quot;NVTSYNC&quot;</span>,7))
<a name="l06092"></a>06092       || (feed_type == <a class="code" href="manage_8h.html#a434d40dbaaf8b412dfe89eb6f0b910e2">SCAP_FEED</a>
<a name="l06093"></a>06093           &amp;&amp; g_ascii_strncasecmp (script_identification[0],<span class="stringliteral">&quot;SCAPSYNC&quot;</span>,7))
<a name="l06094"></a>06094       || (feed_type == <a class="code" href="manage_8h.html#a0a7b2c4fdbfb3ead0048db6dee0f8592">CERT_FEED</a>
<a name="l06095"></a>06095           &amp;&amp; g_ascii_strncasecmp (script_identification[0],<span class="stringliteral">&quot;CERTSYNC&quot;</span>,7))
<a name="l06096"></a>06096       || g_ascii_strncasecmp (script_identification[0], script_identification[5], 7))
<a name="l06097"></a>06097     {
<a name="l06098"></a>06098       g_warning (<span class="stringliteral">&quot;%s is not a NVT synchronization script.&quot;</span>, sync_script);
<a name="l06099"></a>06099 
<a name="l06100"></a>06100       g_free (script_working_dir);
<a name="l06101"></a>06101       g_strfreev (argv);
<a name="l06102"></a>06102       g_free (script_out);
<a name="l06103"></a>06103       g_free (script_err);
<a name="l06104"></a>06104 
<a name="l06105"></a>06105       g_strfreev (script_identification);
<a name="l06106"></a>06106 
<a name="l06107"></a>06107       <span class="keywordflow">return</span> FALSE;
<a name="l06108"></a>06108     }
<a name="l06109"></a>06109 
<a name="l06110"></a>06110   <span class="keywordflow">if</span> (identification)
<a name="l06111"></a>06111     *identification = g_strdup (script_out);
<a name="l06112"></a>06112 
<a name="l06113"></a>06113   g_free (script_working_dir);
<a name="l06114"></a>06114   g_strfreev (argv);
<a name="l06115"></a>06115   g_free (script_out);
<a name="l06116"></a>06116   g_free (script_err);
<a name="l06117"></a>06117 
<a name="l06118"></a>06118   g_strfreev (script_identification);
<a name="l06119"></a>06119 
<a name="l06120"></a>06120   <span class="keywordflow">return</span> TRUE;
<a name="l06121"></a>06121 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ae0fa5c3311b9864d36373726eae9ba6a"></a><!-- doxytag: member="manage.c::openvas_migrate_secinfo" ref="ae0fa5c3311b9864d36373726eae9ba6a" args="(const gchar *sync_script, int feed_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int openvas_migrate_secinfo </td>
          <td>(</td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>sync_script</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>feed_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Migrates SCAP or CERT database, waiting until migration terminates. </p>
<p>Calls a sync script to migrate the SCAP or CERT database.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sync_script</em>&nbsp;</td><td>The file name of the synchronization script. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>feed_type</em>&nbsp;</td><td>Could be SCAP_FEED or CERT_FEED.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 sync complete, 1 sync already in progress, -1 error </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l06564">6564</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l03367">CERT_FEED</a>, <a class="el" href="manage_8c_source.html#l06038">openvas_get_sync_script_identification()</a>, and <a class="el" href="manage_8h_source.html#l03366">SCAP_FEED</a>.</p>

<p>Referenced by <a class="el" href="manage__migrators_8c_source.html#l09220">manage_migrate()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l06565"></a>06565 {
<a name="l06566"></a>06566   <span class="keywordtype">int</span> fd, ret = 0;
<a name="l06567"></a>06567   gchar *lockfile_name, *lockfile_dirname;
<a name="l06568"></a>06568   pid_t pid;
<a name="l06569"></a>06569   mode_t old_mask;
<a name="l06570"></a>06570 
<a name="l06571"></a>06571   g_assert (sync_script);
<a name="l06572"></a>06572 
<a name="l06573"></a>06573   <span class="keywordflow">if</span> (feed_type != <a class="code" href="manage_8h.html#a434d40dbaaf8b412dfe89eb6f0b910e2">SCAP_FEED</a> &amp;&amp; feed_type != <a class="code" href="manage_8h.html#a0a7b2c4fdbfb3ead0048db6dee0f8592">CERT_FEED</a>)
<a name="l06574"></a>06574     {
<a name="l06575"></a>06575       g_warning (<span class="stringliteral">&quot;Unsupported feed_type!&quot;</span>);
<a name="l06576"></a>06576       <span class="keywordflow">return</span> -1;
<a name="l06577"></a>06577     }
<a name="l06578"></a>06578 
<a name="l06579"></a>06579   <span class="keywordflow">if</span> (!<a class="code" href="manage_8c.html#ab7aa1701e03a8578fa8e80f8f8eefdfa" title="Retrieves the ID string of a feed sync script, with basic validation.">openvas_get_sync_script_identification</a>
<a name="l06580"></a>06580       (sync_script, NULL, feed_type))
<a name="l06581"></a>06581     {
<a name="l06582"></a>06582       g_warning (<span class="stringliteral">&quot;No valid synchronization script supplied!&quot;</span>);
<a name="l06583"></a>06583       <span class="keywordflow">return</span> -1;
<a name="l06584"></a>06584     }
<a name="l06585"></a>06585 
<a name="l06586"></a>06586   <span class="comment">/* Open the lock file. */</span>
<a name="l06587"></a>06587 
<a name="l06588"></a>06588   lockfile_name =
<a name="l06589"></a>06589     g_build_filename (g_get_tmp_dir (), <span class="stringliteral">&quot;openvas-feed-sync&quot;</span>, sync_script, NULL);
<a name="l06590"></a>06590   lockfile_dirname = g_path_get_dirname (lockfile_name);
<a name="l06591"></a>06591   old_mask = umask (0);
<a name="l06592"></a>06592   <span class="keywordflow">if</span> (g_mkdir_with_parents (lockfile_dirname,
<a name="l06593"></a>06593                             <span class="comment">/* &quot;-rwxrwxrwx&quot; */</span>
<a name="l06594"></a>06594                             S_IRWXU | S_IRWXG | S_IRWXO))
<a name="l06595"></a>06595     {
<a name="l06596"></a>06596       umask (old_mask);
<a name="l06597"></a>06597       g_warning (<span class="stringliteral">&quot;Failed to create lock dir &apos;%s&apos;: %s&quot;</span>, lockfile_dirname,
<a name="l06598"></a>06598                  strerror (errno));
<a name="l06599"></a>06599       g_free (lockfile_name);
<a name="l06600"></a>06600       g_free (lockfile_dirname);
<a name="l06601"></a>06601       <span class="keywordflow">return</span> -1;
<a name="l06602"></a>06602     }
<a name="l06603"></a>06603   umask (old_mask);
<a name="l06604"></a>06604   g_free (lockfile_dirname);
<a name="l06605"></a>06605 
<a name="l06606"></a>06606   fd =
<a name="l06607"></a>06607     open (lockfile_name, O_RDWR | O_CREAT | O_EXCL,
<a name="l06608"></a>06608           S_IWUSR | S_IRUSR | S_IROTH | S_IRGRP <span class="comment">/* &quot;-rw-r--r--&quot; */</span> );
<a name="l06609"></a>06609   <span class="keywordflow">if</span> (fd == -1)
<a name="l06610"></a>06610     {
<a name="l06611"></a>06611       <span class="keywordflow">if</span> (errno == EEXIST)
<a name="l06612"></a>06612         <span class="keywordflow">return</span> 1;
<a name="l06613"></a>06613       g_warning (<span class="stringliteral">&quot;Failed to open lock file &apos;%s&apos;: %s&quot;</span>, lockfile_name,
<a name="l06614"></a>06614                  strerror (errno));
<a name="l06615"></a>06615       g_free (lockfile_name);
<a name="l06616"></a>06616       <span class="keywordflow">return</span> -1;
<a name="l06617"></a>06617     }
<a name="l06618"></a>06618 
<a name="l06619"></a>06619   <span class="comment">/* Write the current time and user to the lock file. */</span>
<a name="l06620"></a>06620   {
<a name="l06621"></a>06621     <span class="keyword">const</span> <span class="keywordtype">char</span> *output;
<a name="l06622"></a>06622     <span class="keywordtype">int</span> count, left;
<a name="l06623"></a>06623     time_t now;
<a name="l06624"></a>06624 
<a name="l06625"></a>06625     time (&amp;now);
<a name="l06626"></a>06626     output = ctime (&amp;now);
<a name="l06627"></a>06627     left = strlen (output);
<a name="l06628"></a>06628     <span class="keywordflow">while</span> (1)
<a name="l06629"></a>06629       {
<a name="l06630"></a>06630         count = write (fd, output, left);
<a name="l06631"></a>06631         <span class="keywordflow">if</span> (count &lt; 0)
<a name="l06632"></a>06632           {
<a name="l06633"></a>06633             <span class="keywordflow">if</span> (errno == EINTR || errno == EAGAIN)
<a name="l06634"></a>06634               <span class="keywordflow">continue</span>;
<a name="l06635"></a>06635             g_warning (<span class="stringliteral">&quot;%s: write: %s&quot;</span>, __FUNCTION__, strerror (errno));
<a name="l06636"></a>06636             <span class="keywordflow">goto</span> exit;
<a name="l06637"></a>06637           }
<a name="l06638"></a>06638         <span class="keywordflow">if</span> (count == left)
<a name="l06639"></a>06639           <span class="keywordflow">break</span>;
<a name="l06640"></a>06640         left -= count;
<a name="l06641"></a>06641         output += count;
<a name="l06642"></a>06642       }
<a name="l06643"></a>06643 
<a name="l06644"></a>06644     output = <span class="stringliteral">&quot;&quot;</span>; <span class="comment">// user name</span>
<a name="l06645"></a>06645     left = strlen (output);
<a name="l06646"></a>06646     <span class="keywordflow">while</span> (1)
<a name="l06647"></a>06647       {
<a name="l06648"></a>06648         count = write (fd, output, left);
<a name="l06649"></a>06649         <span class="keywordflow">if</span> (count &lt; 0)
<a name="l06650"></a>06650           {
<a name="l06651"></a>06651             <span class="keywordflow">if</span> (errno == EINTR || errno == EAGAIN)
<a name="l06652"></a>06652               <span class="keywordflow">continue</span>;
<a name="l06653"></a>06653             g_warning (<span class="stringliteral">&quot;%s: write: %s&quot;</span>, __FUNCTION__, strerror (errno));
<a name="l06654"></a>06654             <span class="keywordflow">goto</span> exit;
<a name="l06655"></a>06655           }
<a name="l06656"></a>06656         <span class="keywordflow">if</span> (count == left)
<a name="l06657"></a>06657           <span class="keywordflow">break</span>;
<a name="l06658"></a>06658         left -= count;
<a name="l06659"></a>06659         output += count;
<a name="l06660"></a>06660       }
<a name="l06661"></a>06661 
<a name="l06662"></a>06662     <span class="keywordflow">while</span> (1)
<a name="l06663"></a>06663       {
<a name="l06664"></a>06664         count = write (fd, <span class="stringliteral">&quot;\n&quot;</span>, 1);
<a name="l06665"></a>06665         <span class="keywordflow">if</span> (count &lt; 0)
<a name="l06666"></a>06666           {
<a name="l06667"></a>06667             <span class="keywordflow">if</span> (errno == EINTR || errno == EAGAIN)
<a name="l06668"></a>06668               <span class="keywordflow">continue</span>;
<a name="l06669"></a>06669             g_warning (<span class="stringliteral">&quot;%s: write: %s&quot;</span>, __FUNCTION__, strerror (errno));
<a name="l06670"></a>06670             <span class="keywordflow">goto</span> exit;
<a name="l06671"></a>06671           }
<a name="l06672"></a>06672         <span class="keywordflow">if</span> (count == 1)
<a name="l06673"></a>06673           <span class="keywordflow">break</span>;
<a name="l06674"></a>06674       }
<a name="l06675"></a>06675   }
<a name="l06676"></a>06676 
<a name="l06677"></a>06677   <span class="comment">/* Fork a child to be the sync process. */</span>
<a name="l06678"></a>06678 
<a name="l06679"></a>06679   pid = fork ();
<a name="l06680"></a>06680   <span class="keywordflow">switch</span> (pid)
<a name="l06681"></a>06681     {
<a name="l06682"></a>06682     <span class="keywordflow">case</span> 0:
<a name="l06683"></a>06683       {
<a name="l06684"></a>06684         <span class="comment">/* Child.  Become the sync process. */</span>
<a name="l06685"></a>06685 
<a name="l06686"></a>06686         <span class="keywordflow">if</span> (freopen (<span class="stringliteral">&quot;/tmp/openvasad_sync_out&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>, stdout) == NULL)
<a name="l06687"></a>06687           {
<a name="l06688"></a>06688             g_warning (<span class="stringliteral">&quot;Failed to reopen stdout: %s&quot;</span>, strerror (errno));
<a name="l06689"></a>06689             exit (EXIT_FAILURE);
<a name="l06690"></a>06690           }
<a name="l06691"></a>06691 
<a name="l06692"></a>06692         <span class="keywordflow">if</span> (freopen (<span class="stringliteral">&quot;/tmp/openvasad_sync_err&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>, stderr) == NULL)
<a name="l06693"></a>06693           {
<a name="l06694"></a>06694             g_warning (<span class="stringliteral">&quot;Failed to reopen stderr: %s&quot;</span>, strerror (errno));
<a name="l06695"></a>06695             exit (EXIT_FAILURE);
<a name="l06696"></a>06696           }
<a name="l06697"></a>06697 
<a name="l06698"></a>06698         <span class="keywordflow">if</span> (execl (sync_script, sync_script, <span class="stringliteral">&quot;--migrate&quot;</span>, (<span class="keywordtype">char</span> *) NULL))
<a name="l06699"></a>06699           {
<a name="l06700"></a>06700             g_warning (<span class="stringliteral">&quot;Failed to execl %s: %s&quot;</span>, sync_script, strerror (errno));
<a name="l06701"></a>06701             exit (EXIT_FAILURE);
<a name="l06702"></a>06702           }
<a name="l06703"></a>06703         <span class="comment">/*@notreached@ */</span>
<a name="l06704"></a>06704         exit (EXIT_FAILURE);
<a name="l06705"></a>06705         <span class="keywordflow">break</span>;
<a name="l06706"></a>06706       }
<a name="l06707"></a>06707     <span class="keywordflow">case</span> -1:
<a name="l06708"></a>06708       <span class="comment">/* Parent when error. */</span>
<a name="l06709"></a>06709 
<a name="l06710"></a>06710       g_warning (<span class="stringliteral">&quot;%s: failed to fork syncer: %s\n&quot;</span>, __FUNCTION__,
<a name="l06711"></a>06711                  strerror (errno));
<a name="l06712"></a>06712       ret = -1;
<a name="l06713"></a>06713       <span class="keywordflow">goto</span> exit;
<a name="l06714"></a>06714       <span class="keywordflow">break</span>;
<a name="l06715"></a>06715     <span class="keywordflow">default</span>:
<a name="l06716"></a>06716       {
<a name="l06717"></a>06717         <span class="keywordtype">int</span> status;
<a name="l06718"></a>06718 
<a name="l06719"></a>06719         <span class="comment">/* Parent on success.  Wait for child, and handle result. */</span>
<a name="l06720"></a>06720 
<a name="l06721"></a>06721         <span class="keywordflow">while</span> (wait (&amp;status) &lt; 0)
<a name="l06722"></a>06722           {
<a name="l06723"></a>06723             <span class="keywordflow">if</span> (errno == ECHILD)
<a name="l06724"></a>06724               {
<a name="l06725"></a>06725                 g_warning (<span class="stringliteral">&quot;Failed to get child exit status&quot;</span>);
<a name="l06726"></a>06726                 ret = -1;
<a name="l06727"></a>06727                 <span class="keywordflow">goto</span> exit;
<a name="l06728"></a>06728               }
<a name="l06729"></a>06729             <span class="keywordflow">if</span> (errno == EINTR)
<a name="l06730"></a>06730               <span class="keywordflow">continue</span>;
<a name="l06731"></a>06731             g_warning (<span class="stringliteral">&quot;wait: %s&quot;</span>, strerror (errno));
<a name="l06732"></a>06732             ret = -1;
<a name="l06733"></a>06733             <span class="keywordflow">goto</span> exit;
<a name="l06734"></a>06734           }
<a name="l06735"></a>06735         <span class="keywordflow">if</span> (WIFEXITED (status))
<a name="l06736"></a>06736           <span class="keywordflow">switch</span> (WEXITSTATUS (status))
<a name="l06737"></a>06737             {
<a name="l06738"></a>06738               <span class="keywordflow">case</span> EXIT_SUCCESS:
<a name="l06739"></a>06739                 <span class="keywordflow">break</span>;
<a name="l06740"></a>06740               <span class="keywordflow">case</span> EXIT_FAILURE:
<a name="l06741"></a>06741               <span class="keywordflow">default</span>:
<a name="l06742"></a>06742                 g_warning (<span class="stringliteral">&quot;Error during SecInfo migration.&quot;</span>);
<a name="l06743"></a>06743                 ret = -1;
<a name="l06744"></a>06744                 <span class="keywordflow">break</span>;
<a name="l06745"></a>06745             }
<a name="l06746"></a>06746         <span class="keywordflow">else</span>
<a name="l06747"></a>06747           {
<a name="l06748"></a>06748             g_message (<span class="stringliteral">&quot;Error during SecInfo migration.&quot;</span>);
<a name="l06749"></a>06749             ret = -1;
<a name="l06750"></a>06750           }
<a name="l06751"></a>06751 
<a name="l06752"></a>06752         <span class="keywordflow">break</span>;
<a name="l06753"></a>06753       }
<a name="l06754"></a>06754     }
<a name="l06755"></a>06755 
<a name="l06756"></a>06756 exit:
<a name="l06757"></a>06757 
<a name="l06758"></a>06758   <span class="comment">/* Close the lock file. */</span>
<a name="l06759"></a>06759 
<a name="l06760"></a>06760   <span class="keywordflow">if</span> (close (fd))
<a name="l06761"></a>06761     {
<a name="l06762"></a>06762       g_free (lockfile_name);
<a name="l06763"></a>06763       g_warning (<span class="stringliteral">&quot;Failed to close lock file: %s&quot;</span>, strerror (errno));
<a name="l06764"></a>06764       <span class="keywordflow">return</span> -1;
<a name="l06765"></a>06765     }
<a name="l06766"></a>06766 
<a name="l06767"></a>06767   <span class="comment">/* Remove the lock file. */</span>
<a name="l06768"></a>06768 
<a name="l06769"></a>06769   <span class="keywordflow">if</span> (unlink (lockfile_name))
<a name="l06770"></a>06770     {
<a name="l06771"></a>06771       g_free (lockfile_name);
<a name="l06772"></a>06772       g_warning (<span class="stringliteral">&quot;Failed to remove lock file: %s&quot;</span>, strerror (errno));
<a name="l06773"></a>06773       <span class="keywordflow">return</span> -1;
<a name="l06774"></a>06774     }
<a name="l06775"></a>06775 
<a name="l06776"></a>06776   g_free (lockfile_name);
<a name="l06777"></a>06777 
<a name="l06778"></a>06778   <span class="keywordflow">return</span> ret;
<a name="l06779"></a>06779 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a55bfda01381e5d1a0eadfb863ca1df1c"></a><!-- doxytag: member="manage.c::openvas_sync_feed" ref="a55bfda01381e5d1a0eadfb863ca1df1c" args="(const gchar *sync_script, const gchar *current_user, int feed_type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int openvas_sync_feed </td>
          <td>(</td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>sync_script</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>current_user</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>feed_type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Forks a child to synchronize the local feed collection. </p>
<p>The forked process calls a sync script to sync the feed.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sync_script</em>&nbsp;</td><td>The file name of the synchronization script. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>current_user</em>&nbsp;</td><td>The user currently authenticated. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>feed_type</em>&nbsp;</td><td>Could be NVT_FEED, SCAP_FEED or CERT_FEED.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 sync requested (parent), 1 sync already in progress (parent), -1 error (parent), 2 sync complete (child), 11 sync in progress (child), -10 error (child), 99 permission denied. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l06268">6268</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l03365">NVT_FEED</a>, <a class="el" href="manage_8c_source.html#l06038">openvas_get_sync_script_identification()</a>, <a class="el" href="manage_8h_source.html#l03366">SCAP_FEED</a>, and <a class="el" href="manage__acl_8c_source.html#l00050">user_may()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l06270"></a>06270 {
<a name="l06271"></a>06271   <span class="keywordtype">int</span> fd, ret = 2;
<a name="l06272"></a>06272   gchar *lockfile_name, *lockfile_dirname;
<a name="l06273"></a>06273   gchar *script_identification_string = NULL;
<a name="l06274"></a>06274   pid_t pid;
<a name="l06275"></a>06275   mode_t old_mask;
<a name="l06276"></a>06276 
<a name="l06277"></a>06277   g_assert (sync_script);
<a name="l06278"></a>06278   g_assert (current_user);
<a name="l06279"></a>06279 
<a name="l06280"></a>06280   <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#abe056c751dd156a61be8677666039d29" title="Test whether a user may perform an operation.">user_may</a> (feed_type == <a class="code" href="manage_8h.html#a4a0fd5480c0298aa2d4d8b0184caf009">NVT_FEED</a>
<a name="l06281"></a>06281                  ? <span class="stringliteral">&quot;sync_feed&quot;</span>
<a name="l06282"></a>06282                  : (feed_type == <a class="code" href="manage_8h.html#a434d40dbaaf8b412dfe89eb6f0b910e2">SCAP_FEED</a>)
<a name="l06283"></a>06283                      ? <span class="stringliteral">&quot;sync_scap&quot;</span>
<a name="l06284"></a>06284                      : <span class="stringliteral">&quot;sync_cert&quot;</span>) == 0)
<a name="l06285"></a>06285     <span class="keywordflow">return</span> 99;
<a name="l06286"></a>06286 
<a name="l06287"></a>06287   <span class="keywordflow">if</span> (!<a class="code" href="manage_8c.html#ab7aa1701e03a8578fa8e80f8f8eefdfa" title="Retrieves the ID string of a feed sync script, with basic validation.">openvas_get_sync_script_identification</a>
<a name="l06288"></a>06288       (sync_script, &amp;script_identification_string, feed_type))
<a name="l06289"></a>06289     {
<a name="l06290"></a>06290       g_warning (<span class="stringliteral">&quot;No valid synchronization script supplied!&quot;</span>);
<a name="l06291"></a>06291       <span class="keywordflow">return</span> -1;
<a name="l06292"></a>06292     }
<a name="l06293"></a>06293 
<a name="l06294"></a>06294   <span class="comment">/* Open the lock file. */</span>
<a name="l06295"></a>06295 
<a name="l06296"></a>06296   lockfile_name =
<a name="l06297"></a>06297     g_build_filename (g_get_tmp_dir (), <span class="stringliteral">&quot;openvas-feed-sync&quot;</span>, sync_script, NULL);
<a name="l06298"></a>06298   lockfile_dirname = g_path_get_dirname (lockfile_name);
<a name="l06299"></a>06299   old_mask = umask (0);
<a name="l06300"></a>06300   <span class="keywordflow">if</span> (g_mkdir_with_parents (lockfile_dirname,
<a name="l06301"></a>06301                             <span class="comment">/* &quot;-rwxrwxrwx&quot; */</span>
<a name="l06302"></a>06302                             S_IRWXU | S_IRWXG | S_IRWXO))
<a name="l06303"></a>06303     {
<a name="l06304"></a>06304       umask (old_mask);
<a name="l06305"></a>06305       g_warning (<span class="stringliteral">&quot;Failed to create lock dir &apos;%s&apos;: %s&quot;</span>, lockfile_dirname,
<a name="l06306"></a>06306                  strerror (errno));
<a name="l06307"></a>06307       g_free (lockfile_name);
<a name="l06308"></a>06308       g_free (lockfile_dirname);
<a name="l06309"></a>06309       <span class="keywordflow">return</span> -1;
<a name="l06310"></a>06310     }
<a name="l06311"></a>06311   umask (old_mask);
<a name="l06312"></a>06312   g_free (lockfile_dirname);
<a name="l06313"></a>06313 
<a name="l06314"></a>06314   fd =
<a name="l06315"></a>06315     open (lockfile_name, O_RDWR | O_CREAT | O_EXCL,
<a name="l06316"></a>06316           S_IWUSR | S_IRUSR | S_IROTH | S_IRGRP <span class="comment">/* &quot;-rw-r--r--&quot; */</span> );
<a name="l06317"></a>06317   <span class="keywordflow">if</span> (fd == -1)
<a name="l06318"></a>06318     {
<a name="l06319"></a>06319       <span class="keywordflow">if</span> (errno == EEXIST)
<a name="l06320"></a>06320         <span class="keywordflow">return</span> 1;
<a name="l06321"></a>06321       g_warning (<span class="stringliteral">&quot;Failed to open lock file &apos;%s&apos;: %s&quot;</span>, lockfile_name,
<a name="l06322"></a>06322                  strerror (errno));
<a name="l06323"></a>06323       g_free (lockfile_name);
<a name="l06324"></a>06324       <span class="keywordflow">return</span> -1;
<a name="l06325"></a>06325     }
<a name="l06326"></a>06326 
<a name="l06327"></a>06327   <span class="comment">/* Close and remove the lock file around the fork.  Another process may get</span>
<a name="l06328"></a>06328 <span class="comment">   * the lock here, in which case the child will simply fail to get the</span>
<a name="l06329"></a>06329 <span class="comment">   * lock. */</span>
<a name="l06330"></a>06330 
<a name="l06331"></a>06331   <span class="keywordflow">if</span> (close (fd))
<a name="l06332"></a>06332     {
<a name="l06333"></a>06333       g_free (lockfile_name);
<a name="l06334"></a>06334       g_warning (<span class="stringliteral">&quot;Failed to close lock file: %s&quot;</span>, strerror (errno));
<a name="l06335"></a>06335       <span class="keywordflow">return</span> -1;
<a name="l06336"></a>06336     }
<a name="l06337"></a>06337 
<a name="l06338"></a>06338   <span class="keywordflow">if</span> (unlink (lockfile_name))
<a name="l06339"></a>06339     {
<a name="l06340"></a>06340       g_free (lockfile_name);
<a name="l06341"></a>06341       g_warning (<span class="stringliteral">&quot;Failed to remove lock file: %s&quot;</span>, strerror (errno));
<a name="l06342"></a>06342       <span class="keywordflow">return</span> -1;
<a name="l06343"></a>06343     }
<a name="l06344"></a>06344 
<a name="l06345"></a>06345   <span class="comment">/* Setup SIGCHLD for waiting. */</span>
<a name="l06346"></a>06346 
<a name="l06347"></a>06347   <span class="comment">/* RATS: ignore, this is SIG_DFL damnit. */</span>
<a name="l06348"></a>06348   <span class="keywordflow">if</span> (signal (SIGCHLD, SIG_DFL) == SIG_ERR)
<a name="l06349"></a>06349     {
<a name="l06350"></a>06350       g_warning (<span class="stringliteral">&quot;Failed to set SIG_DFL&quot;</span>);
<a name="l06351"></a>06351       <span class="keywordflow">return</span> -1;
<a name="l06352"></a>06352     }
<a name="l06353"></a>06353 
<a name="l06354"></a>06354   <span class="comment">/* Fork a child to run the sync while the parent responds to</span>
<a name="l06355"></a>06355 <span class="comment">   * the client. */</span>
<a name="l06356"></a>06356 
<a name="l06357"></a>06357   pid = fork ();
<a name="l06358"></a>06358   <span class="keywordflow">switch</span> (pid)
<a name="l06359"></a>06359     {
<a name="l06360"></a>06360     <span class="keywordflow">case</span> 0:
<a name="l06361"></a>06361       <span class="comment">/* Child.  Carry on to sync. */</span>
<a name="l06362"></a>06362       <span class="keywordflow">break</span>;
<a name="l06363"></a>06363     <span class="keywordflow">case</span> -1:
<a name="l06364"></a>06364       <span class="comment">/* Parent when error. */</span>
<a name="l06365"></a>06365       g_warning (<span class="stringliteral">&quot;%s: failed to fork sync child: %s\n&quot;</span>, __FUNCTION__,
<a name="l06366"></a>06366                  strerror (errno));
<a name="l06367"></a>06367       <span class="keywordflow">return</span> -1;
<a name="l06368"></a>06368       <span class="keywordflow">break</span>;
<a name="l06369"></a>06369     <span class="keywordflow">default</span>:
<a name="l06370"></a>06370       <span class="comment">/* Parent.  Return in order to respond to client. */</span>
<a name="l06371"></a>06371       <span class="keywordflow">return</span> 0;
<a name="l06372"></a>06372       <span class="keywordflow">break</span>;
<a name="l06373"></a>06373     }
<a name="l06374"></a>06374 
<a name="l06375"></a>06375   <span class="comment">/* Open the lock file. */</span>
<a name="l06376"></a>06376 
<a name="l06377"></a>06377   fd =
<a name="l06378"></a>06378     open (lockfile_name, O_RDWR | O_CREAT | O_EXCL,
<a name="l06379"></a>06379           S_IWUSR | S_IRUSR | S_IROTH | S_IRGRP <span class="comment">/* &quot;-rw-r--r--&quot; */</span> );
<a name="l06380"></a>06380   <span class="keywordflow">if</span> (fd == -1)
<a name="l06381"></a>06381     {
<a name="l06382"></a>06382       <span class="keywordflow">if</span> (errno == EEXIST)
<a name="l06383"></a>06383         <span class="keywordflow">return</span> 11;
<a name="l06384"></a>06384       g_warning (<span class="stringliteral">&quot;Failed to open lock file &apos;%s&apos; (child): %s&quot;</span>, lockfile_name,
<a name="l06385"></a>06385                  strerror (errno));
<a name="l06386"></a>06386       g_free (lockfile_name);
<a name="l06387"></a>06387       <span class="keywordflow">return</span> -10;
<a name="l06388"></a>06388     }
<a name="l06389"></a>06389 
<a name="l06390"></a>06390   <span class="comment">/* Write the current time and user to the lock file. */</span>
<a name="l06391"></a>06391 
<a name="l06392"></a>06392   {
<a name="l06393"></a>06393     <span class="keyword">const</span> <span class="keywordtype">char</span> *output;
<a name="l06394"></a>06394     <span class="keywordtype">int</span> count, left;
<a name="l06395"></a>06395     time_t now;
<a name="l06396"></a>06396 
<a name="l06397"></a>06397     time (&amp;now);
<a name="l06398"></a>06398     output = ctime (&amp;now);
<a name="l06399"></a>06399     left = strlen (output);
<a name="l06400"></a>06400     <span class="keywordflow">while</span> (1)
<a name="l06401"></a>06401       {
<a name="l06402"></a>06402         count = write (fd, output, left);
<a name="l06403"></a>06403         <span class="keywordflow">if</span> (count &lt; 0)
<a name="l06404"></a>06404           {
<a name="l06405"></a>06405             <span class="keywordflow">if</span> (errno == EINTR || errno == EAGAIN)
<a name="l06406"></a>06406               <span class="keywordflow">continue</span>;
<a name="l06407"></a>06407             g_warning (<span class="stringliteral">&quot;%s: write: %s&quot;</span>, __FUNCTION__, strerror (errno));
<a name="l06408"></a>06408             <span class="keywordflow">goto</span> exit;
<a name="l06409"></a>06409           }
<a name="l06410"></a>06410         <span class="keywordflow">if</span> (count == left)
<a name="l06411"></a>06411           <span class="keywordflow">break</span>;
<a name="l06412"></a>06412         left -= count;
<a name="l06413"></a>06413         output += count;
<a name="l06414"></a>06414       }
<a name="l06415"></a>06415 
<a name="l06416"></a>06416     output = current_user;
<a name="l06417"></a>06417     left = strlen (output);
<a name="l06418"></a>06418     <span class="keywordflow">while</span> (1)
<a name="l06419"></a>06419       {
<a name="l06420"></a>06420         count = write (fd, output, left);
<a name="l06421"></a>06421         <span class="keywordflow">if</span> (count &lt; 0)
<a name="l06422"></a>06422           {
<a name="l06423"></a>06423             <span class="keywordflow">if</span> (errno == EINTR || errno == EAGAIN)
<a name="l06424"></a>06424               <span class="keywordflow">continue</span>;
<a name="l06425"></a>06425             g_warning (<span class="stringliteral">&quot;%s: write: %s&quot;</span>, __FUNCTION__, strerror (errno));
<a name="l06426"></a>06426             <span class="keywordflow">goto</span> exit;
<a name="l06427"></a>06427           }
<a name="l06428"></a>06428         <span class="keywordflow">if</span> (count == left)
<a name="l06429"></a>06429           <span class="keywordflow">break</span>;
<a name="l06430"></a>06430         left -= count;
<a name="l06431"></a>06431         output += count;
<a name="l06432"></a>06432       }
<a name="l06433"></a>06433 
<a name="l06434"></a>06434     <span class="keywordflow">while</span> (1)
<a name="l06435"></a>06435       {
<a name="l06436"></a>06436         count = write (fd, <span class="stringliteral">&quot;\n&quot;</span>, 1);
<a name="l06437"></a>06437         <span class="keywordflow">if</span> (count &lt; 0)
<a name="l06438"></a>06438           {
<a name="l06439"></a>06439             <span class="keywordflow">if</span> (errno == EINTR || errno == EAGAIN)
<a name="l06440"></a>06440               <span class="keywordflow">continue</span>;
<a name="l06441"></a>06441             g_warning (<span class="stringliteral">&quot;%s: write: %s&quot;</span>, __FUNCTION__, strerror (errno));
<a name="l06442"></a>06442             <span class="keywordflow">goto</span> exit;
<a name="l06443"></a>06443           }
<a name="l06444"></a>06444         <span class="keywordflow">if</span> (count == 1)
<a name="l06445"></a>06445           <span class="keywordflow">break</span>;
<a name="l06446"></a>06446       }
<a name="l06447"></a>06447   }
<a name="l06448"></a>06448 
<a name="l06449"></a>06449   <span class="comment">/* Fork a child to be the sync process. */</span>
<a name="l06450"></a>06450 
<a name="l06451"></a>06451   pid = fork ();
<a name="l06452"></a>06452   <span class="keywordflow">switch</span> (pid)
<a name="l06453"></a>06453     {
<a name="l06454"></a>06454     <span class="keywordflow">case</span> 0:
<a name="l06455"></a>06455       {
<a name="l06456"></a>06456         <span class="comment">/* Child.  Become the sync process. */</span>
<a name="l06457"></a>06457 
<a name="l06458"></a>06458         <span class="keywordflow">if</span> (freopen (<span class="stringliteral">&quot;/tmp/openvasad_sync_out&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>, stdout) == NULL)
<a name="l06459"></a>06459           {
<a name="l06460"></a>06460             g_warning (<span class="stringliteral">&quot;Failed to reopen stdout: %s&quot;</span>, strerror (errno));
<a name="l06461"></a>06461             exit (EXIT_FAILURE);
<a name="l06462"></a>06462           }
<a name="l06463"></a>06463 
<a name="l06464"></a>06464         <span class="keywordflow">if</span> (freopen (<span class="stringliteral">&quot;/tmp/openvasad_sync_err&quot;</span>, <span class="stringliteral">&quot;w&quot;</span>, stderr) == NULL)
<a name="l06465"></a>06465           {
<a name="l06466"></a>06466             g_warning (<span class="stringliteral">&quot;Failed to reopen stderr: %s&quot;</span>, strerror (errno));
<a name="l06467"></a>06467             exit (EXIT_FAILURE);
<a name="l06468"></a>06468           }
<a name="l06469"></a>06469 
<a name="l06470"></a>06470         <span class="keywordflow">if</span> (execl (sync_script, sync_script, (<span class="keywordtype">char</span> *) NULL))
<a name="l06471"></a>06471           {
<a name="l06472"></a>06472             g_warning (<span class="stringliteral">&quot;Failed to execl %s: %s&quot;</span>, sync_script, strerror (errno));
<a name="l06473"></a>06473             exit (EXIT_FAILURE);
<a name="l06474"></a>06474           }
<a name="l06475"></a>06475         <span class="comment">/*@notreached@ */</span>
<a name="l06476"></a>06476         exit (EXIT_FAILURE);
<a name="l06477"></a>06477         <span class="keywordflow">break</span>;
<a name="l06478"></a>06478       }
<a name="l06479"></a>06479     <span class="keywordflow">case</span> -1:
<a name="l06480"></a>06480       <span class="comment">/* Parent when error. */</span>
<a name="l06481"></a>06481 
<a name="l06482"></a>06482       g_warning (<span class="stringliteral">&quot;%s: failed to fork syncer: %s\n&quot;</span>, __FUNCTION__,
<a name="l06483"></a>06483                  strerror (errno));
<a name="l06484"></a>06484       ret = -1;
<a name="l06485"></a>06485       <span class="keywordflow">goto</span> exit;
<a name="l06486"></a>06486       <span class="keywordflow">break</span>;
<a name="l06487"></a>06487     <span class="keywordflow">default</span>:
<a name="l06488"></a>06488       {
<a name="l06489"></a>06489         <span class="keywordtype">int</span> status;
<a name="l06490"></a>06490 
<a name="l06491"></a>06491         <span class="comment">/* Parent on success.  Wait for child, and handle result. */</span>
<a name="l06492"></a>06492 
<a name="l06493"></a>06493         <span class="keywordflow">while</span> (wait (&amp;status) &lt; 0)
<a name="l06494"></a>06494           {
<a name="l06495"></a>06495             <span class="keywordflow">if</span> (errno == ECHILD)
<a name="l06496"></a>06496               {
<a name="l06497"></a>06497                 g_warning (<span class="stringliteral">&quot;Failed to get child exit status&quot;</span>);
<a name="l06498"></a>06498                 ret = -10;
<a name="l06499"></a>06499                 <span class="keywordflow">goto</span> exit;
<a name="l06500"></a>06500               }
<a name="l06501"></a>06501             <span class="keywordflow">if</span> (errno == EINTR)
<a name="l06502"></a>06502               <span class="keywordflow">continue</span>;
<a name="l06503"></a>06503             g_warning (<span class="stringliteral">&quot;wait: %s&quot;</span>, strerror (errno));
<a name="l06504"></a>06504             ret = -10;
<a name="l06505"></a>06505             <span class="keywordflow">goto</span> exit;
<a name="l06506"></a>06506           }
<a name="l06507"></a>06507         <span class="keywordflow">if</span> (WIFEXITED (status))
<a name="l06508"></a>06508           <span class="keywordflow">switch</span> (WEXITSTATUS (status))
<a name="l06509"></a>06509             {
<a name="l06510"></a>06510             <span class="keywordflow">case</span> EXIT_SUCCESS:
<a name="l06511"></a>06511               <span class="keywordflow">break</span>;
<a name="l06512"></a>06512             <span class="keywordflow">case</span> EXIT_FAILURE:
<a name="l06513"></a>06513             <span class="keywordflow">default</span>:
<a name="l06514"></a>06514               g_warning (<span class="stringliteral">&quot;Error during synchronization.&quot;</span>);
<a name="l06515"></a>06515               ret = -10;
<a name="l06516"></a>06516               <span class="keywordflow">break</span>;
<a name="l06517"></a>06517             }
<a name="l06518"></a>06518         <span class="keywordflow">else</span>
<a name="l06519"></a>06519           {
<a name="l06520"></a>06520             g_message (<span class="stringliteral">&quot;Error during synchronization.&quot;</span>);
<a name="l06521"></a>06521             ret = -10;
<a name="l06522"></a>06522           }
<a name="l06523"></a>06523 
<a name="l06524"></a>06524         <span class="keywordflow">break</span>;
<a name="l06525"></a>06525       }
<a name="l06526"></a>06526     }
<a name="l06527"></a>06527 
<a name="l06528"></a>06528 exit:
<a name="l06529"></a>06529 
<a name="l06530"></a>06530   <span class="comment">/* Close the lock file. */</span>
<a name="l06531"></a>06531 
<a name="l06532"></a>06532   <span class="keywordflow">if</span> (close (fd))
<a name="l06533"></a>06533     {
<a name="l06534"></a>06534       g_free (lockfile_name);
<a name="l06535"></a>06535       g_warning (<span class="stringliteral">&quot;Failed to close lock file (child): %s&quot;</span>, strerror (errno));
<a name="l06536"></a>06536       <span class="keywordflow">return</span> -10;
<a name="l06537"></a>06537     }
<a name="l06538"></a>06538 
<a name="l06539"></a>06539   <span class="comment">/* Remove the lock file. */</span>
<a name="l06540"></a>06540 
<a name="l06541"></a>06541   <span class="keywordflow">if</span> (unlink (lockfile_name))
<a name="l06542"></a>06542     {
<a name="l06543"></a>06543       g_free (lockfile_name);
<a name="l06544"></a>06544       g_warning (<span class="stringliteral">&quot;Failed to remove lock file (child): %s&quot;</span>, strerror (errno));
<a name="l06545"></a>06545       <span class="keywordflow">return</span> -10;
<a name="l06546"></a>06546     }
<a name="l06547"></a>06547 
<a name="l06548"></a>06548   g_free (lockfile_name);
<a name="l06549"></a>06549 
<a name="l06550"></a>06550   <span class="keywordflow">return</span> ret;
<a name="l06551"></a>06551 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ac3293f4c788610ea413627459d26ed7a"></a><!-- doxytag: member="manage.c::openvas_sync_script_perform_selftest" ref="ac3293f4c788610ea413627459d26ed7a" args="(const gchar *sync_script, gchar **result)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gboolean openvas_sync_script_perform_selftest </td>
          <td>(</td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>sync_script</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar **&nbsp;</td>
          <td class="paramname"> <em>result</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Request a feed synchronization script selftest. </p>
<p>Ask a feed synchronization script to perform a selftest and report the results.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>sync_script</em>&nbsp;</td><td>The file name of the synchronization script. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>result</em>&nbsp;</td><td>Return location for selftest errors, or NULL.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>TRUE if the selftest was successful, or FALSE if an error occured. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05966">5966</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05968"></a>05968 {
<a name="l05969"></a>05969   g_assert (sync_script);
<a name="l05970"></a>05970   g_assert_cmpstr (*result, ==, NULL);
<a name="l05971"></a>05971 
<a name="l05972"></a>05972   gchar *script_working_dir = g_path_get_dirname (sync_script);
<a name="l05973"></a>05973 
<a name="l05974"></a>05974   gchar **argv = (gchar **) g_malloc (3 * <span class="keyword">sizeof</span> (gchar *));
<a name="l05975"></a>05975   argv[0] = g_strdup (sync_script);
<a name="l05976"></a>05976   argv[1] = g_strdup (<span class="stringliteral">&quot;--selftest&quot;</span>);
<a name="l05977"></a>05977   argv[2] = NULL;
<a name="l05978"></a>05978 
<a name="l05979"></a>05979   gchar *script_out;
<a name="l05980"></a>05980   gchar *script_err;
<a name="l05981"></a>05981   gint script_exit;
<a name="l05982"></a>05982   GError *error = NULL;
<a name="l05983"></a>05983 
<a name="l05984"></a>05984   <span class="keywordflow">if</span> (!g_spawn_sync
<a name="l05985"></a>05985       (script_working_dir, argv, NULL, 0, NULL, NULL, &amp;script_out, &amp;script_err,
<a name="l05986"></a>05986        &amp;script_exit, &amp;error))
<a name="l05987"></a>05987     {
<a name="l05988"></a>05988       <span class="keywordflow">if</span> (*result != NULL)
<a name="l05989"></a>05989         {
<a name="l05990"></a>05990           *result =
<a name="l05991"></a>05991             g_strdup_printf (<span class="stringliteral">&quot;Failed to execute synchronization &quot;</span> <span class="stringliteral">&quot;script: %s&quot;</span>,
<a name="l05992"></a>05992                              error-&gt;message);
<a name="l05993"></a>05993         }
<a name="l05994"></a>05994 
<a name="l05995"></a>05995       g_free (script_working_dir);
<a name="l05996"></a>05996       g_strfreev (argv);
<a name="l05997"></a>05997       g_free (script_out);
<a name="l05998"></a>05998       g_free (script_err);
<a name="l05999"></a>05999       g_error_free (error);
<a name="l06000"></a>06000 
<a name="l06001"></a>06001       <span class="keywordflow">return</span> FALSE;
<a name="l06002"></a>06002     }
<a name="l06003"></a>06003 
<a name="l06004"></a>06004   <span class="keywordflow">if</span> (script_exit != 0)
<a name="l06005"></a>06005     {
<a name="l06006"></a>06006       <span class="keywordflow">if</span> (script_err != NULL)
<a name="l06007"></a>06007         {
<a name="l06008"></a>06008           *result = g_strdup_printf (<span class="stringliteral">&quot;%s&quot;</span>, script_err);
<a name="l06009"></a>06009         }
<a name="l06010"></a>06010 
<a name="l06011"></a>06011       g_free (script_working_dir);
<a name="l06012"></a>06012       g_strfreev (argv);
<a name="l06013"></a>06013       g_free (script_out);
<a name="l06014"></a>06014       g_free (script_err);
<a name="l06015"></a>06015 
<a name="l06016"></a>06016       <span class="keywordflow">return</span> FALSE;
<a name="l06017"></a>06017     }
<a name="l06018"></a>06018 
<a name="l06019"></a>06019   g_free (script_working_dir);
<a name="l06020"></a>06020   g_strfreev (argv);
<a name="l06021"></a>06021   g_free (script_out);
<a name="l06022"></a>06022   g_free (script_err);
<a name="l06023"></a>06023 
<a name="l06024"></a>06024   <span class="keywordflow">return</span> TRUE;
<a name="l06025"></a>06025 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4a67fcc3149b754284506a48c427f9f5"></a><!-- doxytag: member="manage.c::parse_tags" ref="a4a67fcc3149b754284506a48c427f9f5" args="(const char *scanner_tags, gchar **tags, gchar **cvss_base, gchar **risk_factor)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void parse_tags </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>scanner_tags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar **&nbsp;</td>
          <td class="paramname"> <em>tags</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar **&nbsp;</td>
          <td class="paramname"> <em>cvss_base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar **&nbsp;</td>
          <td class="paramname"> <em>risk_factor</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Split up the tags received from the scanner. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>scanner_tags</em>&nbsp;</td><td>The tags sent by the scanner. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>tags</em>&nbsp;</td><td>Tags. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>cvss_base</em>&nbsp;</td><td>CVSS base. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>risk_factor</em>&nbsp;</td><td>Risk factor. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05131">5131</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage__migrators_8c_source.html#l01661">migrate_16_to_17()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05133"></a>05133 {
<a name="l05134"></a>05134   gchar **split, **point;
<a name="l05135"></a>05135   GString *tags_buffer;
<a name="l05136"></a>05136   gboolean first;
<a name="l05137"></a>05137 
<a name="l05138"></a>05138   tags_buffer = g_string_new (<span class="stringliteral">&quot;&quot;</span>);
<a name="l05139"></a>05139   split = g_strsplit (scanner_tags, <span class="stringliteral">&quot;|&quot;</span>, 0);
<a name="l05140"></a>05140   point = split;
<a name="l05141"></a>05141   *cvss_base = NULL;
<a name="l05142"></a>05142   *risk_factor = NULL;
<a name="l05143"></a>05143   first = TRUE;
<a name="l05144"></a>05144 
<a name="l05145"></a>05145   <span class="keywordflow">while</span> (*point)
<a name="l05146"></a>05146     {
<a name="l05147"></a>05147       <span class="keywordflow">if</span> (strncmp (*point, <span class="stringliteral">&quot;cvss_base=&quot;</span>, strlen (<span class="stringliteral">&quot;cvss_base=&quot;</span>)) == 0)
<a name="l05148"></a>05148         {
<a name="l05149"></a>05149           <span class="keywordflow">if</span> (*cvss_base == NULL)
<a name="l05150"></a>05150             *cvss_base = g_strdup (*point + strlen (<span class="stringliteral">&quot;cvss_base=&quot;</span>));
<a name="l05151"></a>05151         }
<a name="l05152"></a>05152       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strncmp (*point, <span class="stringliteral">&quot;risk_factor=&quot;</span>, strlen (<span class="stringliteral">&quot;risk_factor=&quot;</span>)) == 0)
<a name="l05153"></a>05153         {
<a name="l05154"></a>05154           <span class="keywordflow">if</span> (*risk_factor == NULL)
<a name="l05155"></a>05155             *risk_factor = g_strdup (*point + strlen (<span class="stringliteral">&quot;risk_factor=&quot;</span>));
<a name="l05156"></a>05156         }
<a name="l05157"></a>05157       <span class="keywordflow">else</span>
<a name="l05158"></a>05158         {
<a name="l05159"></a>05159           <span class="keywordflow">if</span> (first)
<a name="l05160"></a>05160             first = FALSE;
<a name="l05161"></a>05161           <span class="keywordflow">else</span>
<a name="l05162"></a>05162             g_string_append_c (tags_buffer, <span class="charliteral">&apos;|&apos;</span>);
<a name="l05163"></a>05163           g_string_append (tags_buffer, *point);
<a name="l05164"></a>05164         }
<a name="l05165"></a>05165       point++;
<a name="l05166"></a>05166     }
<a name="l05167"></a>05167 
<a name="l05168"></a>05168   <span class="keywordflow">if</span> (tags_buffer-&gt;len == 0)
<a name="l05169"></a>05169     {
<a name="l05170"></a>05170       g_string_free (tags_buffer, TRUE);
<a name="l05171"></a>05171       *tags = g_strdup (<span class="stringliteral">&quot;NOTAG&quot;</span>);
<a name="l05172"></a>05172     }
<a name="l05173"></a>05173   <span class="keywordflow">else</span>
<a name="l05174"></a>05174     *tags = g_string_free (tags_buffer, FALSE);
<a name="l05175"></a>05175   g_strfreev (split);
<a name="l05176"></a>05176 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="aa4623de8fbd13a0ea5818a68b59774d1"></a><!-- doxytag: member="manage.c::pause_task" ref="aa4623de8fbd13a0ea5818a68b59774d1" args="(const char *task_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int pause_task </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>task_id</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initiate pausing of a task. </p>
<p>Use <a class="el" href="ovas-mngr-comm_8h.html#a4190e998fca6ff7f6566f520b9fe4000">send_to_server</a> to queue the task pause sequence in the scanner output buffer.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>task_id</em>&nbsp;</td><td>Task UUID.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, 1 if pause requested, 3 failed to find task, 99 permission denied, -1 internal error, -3 if out of space in scanner output buffer, -5 scanner down. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l03633">3633</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8c_source.html#l00775">current_scanner_task</a>, <a class="el" href="manage__sql_8c_source.html#l26206">find_task_with_permission()</a>, <a class="el" href="manage_8c_source.html#l00760">scanner_up</a>, <a class="el" href="ovas-mngr-comm_8c_source.html#l00155">send_to_server()</a>, <a class="el" href="manage__sql_8c_source.html#l13141">set_task_run_status()</a>, <a class="el" href="manage__sql_8c_source.html#l13127">task_run_status()</a>, <a class="el" href="manage_8h_source.html#l00172">TASK_STATUS_PAUSE_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00170">TASK_STATUS_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00171">TASK_STATUS_RUNNING</a>, and <a class="el" href="manage__acl_8c_source.html#l00050">user_may()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03634"></a>03634 {
<a name="l03635"></a>03635   <a class="code" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a> task;
<a name="l03636"></a>03636   <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65" title="Task statuses, also used as scan/report statuses.">task_status_t</a> run_status;
<a name="l03637"></a>03637 
<a name="l03638"></a>03638   <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#abe056c751dd156a61be8677666039d29" title="Test whether a user may perform an operation.">user_may</a> (<span class="stringliteral">&quot;pause_task&quot;</span>) == 0)
<a name="l03639"></a>03639     <span class="keywordflow">return</span> 99;
<a name="l03640"></a>03640 
<a name="l03641"></a>03641   task = 0;
<a name="l03642"></a>03642   <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#a6d78c3b661d76fd8c51d81bb15d0ad9f" title="Find a task for a specific permission, given a UUID.">find_task_with_permission</a> (<a class="code" href="manage_8h.html#ac91862710d5a515ab542fe0229f1c6dc" title="Return the identifier of a task.">task_id</a>, &amp;task, <span class="stringliteral">&quot;pause_task&quot;</span>))
<a name="l03643"></a>03643     <span class="keywordflow">return</span> -1;
<a name="l03644"></a>03644   <span class="keywordflow">if</span> (task == 0)
<a name="l03645"></a>03645     <span class="keywordflow">return</span> 3;
<a name="l03646"></a>03646 
<a name="l03647"></a>03647   <span class="keywordflow">if</span> (<a class="code" href="manage_8c.html#afa812d6ddd8794083a9964ae2293b2d3" title="Scanner available flag.">scanner_up</a> == 0)
<a name="l03648"></a>03648     <span class="keywordflow">return</span> -5;
<a name="l03649"></a>03649 
<a name="l03650"></a>03650   run_status = <a class="code" href="manage_8h.html#a6ee81446351e254b95a54483210f1ada" title="Return the run state of a task.">task_run_status</a> (task);
<a name="l03651"></a>03651   <span class="keywordflow">if</span> (run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0a268852134eeb744236e9196514e460">TASK_STATUS_REQUESTED</a>
<a name="l03652"></a>03652       || run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a71652716ef97001ba2420436c93e0d96">TASK_STATUS_RUNNING</a>)
<a name="l03653"></a>03653     {
<a name="l03654"></a>03654       <span class="keywordflow">if</span> (<a class="code" href="manage_8c.html#a448b7803b3f0a72e88d11cece0fc8aa6" title="The task currently running on the scanner.">current_scanner_task</a> == task
<a name="l03655"></a>03655           &amp;&amp; <a class="code" href="ovas-mngr-comm_8c.html#a5e8ebd680f5948035731df580f52bbab" title="Send a message to the server.">send_to_server</a> (<span class="stringliteral">&quot;CLIENT &lt;|&gt; PAUSE_WHOLE_TEST &lt;|&gt; CLIENT\n&quot;</span>))
<a name="l03656"></a>03656         <span class="keywordflow">return</span> -3;
<a name="l03657"></a>03657       <a class="code" href="manage_8h.html#a8607acfa50914954cc41f17d045775e6" title="Set the run state of a task.">set_task_run_status</a> (task, <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65ad734252ff7130810a12e395498625d8b">TASK_STATUS_PAUSE_REQUESTED</a>);
<a name="l03658"></a>03658       <span class="keywordflow">return</span> 1;
<a name="l03659"></a>03659     }
<a name="l03660"></a>03660 
<a name="l03661"></a>03661   <span class="keywordflow">return</span> 0;
<a name="l03662"></a>03662 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a4177e98f768a761e753eaf016926a511"></a><!-- doxytag: member="manage.c::rc_preference" ref="a4177e98f768a761e753eaf016926a511" args="(const char *desc, const char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">char* rc_preference </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>desc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return a preference from an RC. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000006">Todo:</a></b></dt><dd>Test these RC parsing functions. </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>desc</em>&nbsp;</td><td>The RC. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>The name of the preference.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The preference on success, else NULL. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l01090">1090</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="tracef_8h_source.html#l00089">tracef</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l25504">set_task_parameter()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01091"></a>01091 {
<a name="l01092"></a>01092   <span class="keywordtype">char</span>* seek;
<a name="l01093"></a>01093 
<a name="l01094"></a>01094   <span class="keywordflow">if</span> (desc == NULL)
<a name="l01095"></a>01095     {
<a name="l01096"></a>01096       <a class="code" href="tracef_8h.html#a70d339a461f334e16086ab23b83cedc4" title="Formatted trace output.">tracef</a> (<span class="stringliteral">&quot;   desc NULL\n&quot;</span>);
<a name="l01097"></a>01097       <span class="keywordflow">return</span> NULL;
<a name="l01098"></a>01098     }
<a name="l01099"></a>01099 
<a name="l01100"></a>01100   <span class="keywordflow">while</span> ((seek = strchr (desc, <span class="charliteral">&apos;\n&apos;</span>)))
<a name="l01101"></a>01101     {
<a name="l01102"></a>01102       <span class="keywordtype">char</span>* eq = seek
<a name="l01103"></a>01103                  ? memchr (desc, <span class="charliteral">&apos;=&apos;</span>, seek - desc)
<a name="l01104"></a>01104                  : strchr (desc, <span class="stringliteral">&apos;=&apos;</span>);
<a name="l01105"></a>01105       <span class="keywordflow">if</span> (eq)
<a name="l01106"></a>01106         {
<a name="l01107"></a>01107 <span class="preprocessor">#if 0</span>
<a name="l01108"></a>01108 <span class="preprocessor"></span>          <a class="code" href="tracef_8h.html#a70d339a461f334e16086ab23b83cedc4" title="Formatted trace output.">tracef</a> (<span class="stringliteral">&quot;   1 found: %.*s\n&quot;</span>,
<a name="l01109"></a>01109                   seek ? seek - desc : strlen (seek),
<a name="l01110"></a>01110                   desc);
<a name="l01111"></a>01111 <span class="preprocessor">#endif</span>
<a name="l01112"></a>01112 <span class="preprocessor"></span>          <span class="keywordflow">if</span> (strncmp (desc, name, eq - desc - 1) == 0)
<a name="l01113"></a>01113             {
<a name="l01114"></a>01114               gchar* ret;
<a name="l01115"></a>01115               <span class="keywordflow">if</span> (seek &gt; eq + 1)
<a name="l01116"></a>01116                 ret = g_strndup (eq + 2,
<a name="l01117"></a>01117                                  seek ? seek - (eq + 2) : strlen (seek));
<a name="l01118"></a>01118               <span class="keywordflow">else</span>
<a name="l01119"></a>01119                 ret = g_strdup (<span class="stringliteral">&quot;&quot;</span>);
<a name="l01120"></a>01120               <span class="keywordflow">return</span> ret;
<a name="l01121"></a>01121             }
<a name="l01122"></a>01122         }
<a name="l01123"></a>01123       <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((seek ? seek - desc &gt; 7 : 1)
<a name="l01124"></a>01124                &amp;&amp; strncmp (desc, <span class="stringliteral">&quot;begin(&quot;</span>, 6) == 0)
<a name="l01125"></a>01125         {
<a name="l01126"></a>01126           <span class="comment">/* Read over the section. */</span>
<a name="l01127"></a>01127           desc = seek + 1;
<a name="l01128"></a>01128           <span class="keywordflow">while</span> ((seek = strchr (desc, <span class="charliteral">&apos;\n&apos;</span>)))
<a name="l01129"></a>01129             {
<a name="l01130"></a>01130               <span class="keywordflow">if</span> ((seek ? seek - desc &gt; 5 : 1)
<a name="l01131"></a>01131                   &amp;&amp; strncmp (desc, <span class="stringliteral">&quot;end(&quot;</span>, 4) == 0)
<a name="l01132"></a>01132                 {
<a name="l01133"></a>01133                   <span class="keywordflow">break</span>;
<a name="l01134"></a>01134                 }
<a name="l01135"></a>01135 <span class="preprocessor">#if 0</span>
<a name="l01136"></a>01136 <span class="preprocessor"></span>              <a class="code" href="tracef_8h.html#a70d339a461f334e16086ab23b83cedc4" title="Formatted trace output.">tracef</a> (<span class="stringliteral">&quot;   1 skip: %.*s\n&quot;</span>,
<a name="l01137"></a>01137                       seek ? seek - desc : strlen (seek),
<a name="l01138"></a>01138                       desc);
<a name="l01139"></a>01139 <span class="preprocessor">#endif</span>
<a name="l01140"></a>01140 <span class="preprocessor"></span>              desc = seek + 1;
<a name="l01141"></a>01141             }
<a name="l01142"></a>01142         }
<a name="l01143"></a>01143       <span class="keywordflow">if</span> (seek == NULL) <span class="keywordflow">break</span>;
<a name="l01144"></a>01144       desc = seek + 1;
<a name="l01145"></a>01145     }
<a name="l01146"></a>01146   <span class="keywordflow">return</span> NULL;
<a name="l01147"></a>01147 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a5f097d2cdfebc96b171bec3eb0217766"></a><!-- doxytag: member="manage.c::report_format_param_type_from_name" ref="a5f097d2cdfebc96b171bec3eb0217766" args="(const char *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12aff">report_format_param_type_t</a> report_format_param_type_from_name </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get a report format param type from a name. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>Param type name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The param type. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04882">4882</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l02385">REPORT_FORMAT_PARAM_TYPE_BOOLEAN</a>, <a class="el" href="manage_8h_source.html#l02390">REPORT_FORMAT_PARAM_TYPE_ERROR</a>, <a class="el" href="manage_8h_source.html#l02386">REPORT_FORMAT_PARAM_TYPE_INTEGER</a>, <a class="el" href="manage_8h_source.html#l02387">REPORT_FORMAT_PARAM_TYPE_SELECTION</a>, <a class="el" href="manage_8h_source.html#l02388">REPORT_FORMAT_PARAM_TYPE_STRING</a>, and <a class="el" href="manage_8h_source.html#l02389">REPORT_FORMAT_PARAM_TYPE_TEXT</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l38915">create_report_format()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04883"></a>04883 {
<a name="l04884"></a>04884   <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;boolean&quot;</span>) == 0)
<a name="l04885"></a>04885     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12affaecae0cb84f6b401a5beb0caea7f1fac2">REPORT_FORMAT_PARAM_TYPE_BOOLEAN</a>;
<a name="l04886"></a>04886   <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;integer&quot;</span>) == 0)
<a name="l04887"></a>04887     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12affa63f6bdc059c66eed8976fefe0d719ffe">REPORT_FORMAT_PARAM_TYPE_INTEGER</a>;
<a name="l04888"></a>04888   <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;selection&quot;</span>) == 0)
<a name="l04889"></a>04889     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12affa8b350ef31961d122a001e21d4698f342">REPORT_FORMAT_PARAM_TYPE_SELECTION</a>;
<a name="l04890"></a>04890   <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;string&quot;</span>) == 0)
<a name="l04891"></a>04891     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12affaf44575176b01686532624f26f8e702db">REPORT_FORMAT_PARAM_TYPE_STRING</a>;
<a name="l04892"></a>04892   <span class="keywordflow">if</span> (strcmp (name, <span class="stringliteral">&quot;text&quot;</span>) == 0)
<a name="l04893"></a>04893     <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12affa6c729a78498a13f6a0104e4de7e878ce">REPORT_FORMAT_PARAM_TYPE_TEXT</a>;
<a name="l04894"></a>04894   <span class="keywordflow">return</span> <a class="code" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12affa55448cf4c663854024030c9a494c3e07">REPORT_FORMAT_PARAM_TYPE_ERROR</a>;
<a name="l04895"></a>04895 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a64375f2483bd69cd05553ac74758307d"></a><!-- doxytag: member="manage.c::report_format_param_type_name" ref="a64375f2483bd69cd05553ac74758307d" args="(report_format_param_type_t type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* report_format_param_type_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12aff">report_format_param_type_t</a>&nbsp;</td>
          <td class="paramname"> <em>type</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the name of a report format param type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>type</em>&nbsp;</td><td>Param type.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The name of the param type. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04853">4853</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l02385">REPORT_FORMAT_PARAM_TYPE_BOOLEAN</a>, <a class="el" href="manage_8h_source.html#l02390">REPORT_FORMAT_PARAM_TYPE_ERROR</a>, <a class="el" href="manage_8h_source.html#l02386">REPORT_FORMAT_PARAM_TYPE_INTEGER</a>, <a class="el" href="manage_8h_source.html#l02387">REPORT_FORMAT_PARAM_TYPE_SELECTION</a>, <a class="el" href="manage_8h_source.html#l02388">REPORT_FORMAT_PARAM_TYPE_STRING</a>, and <a class="el" href="manage_8h_source.html#l02389">REPORT_FORMAT_PARAM_TYPE_TEXT</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l41216">report_format_param_iterator_type_name()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04854"></a>04854 {
<a name="l04855"></a>04855   <span class="keywordflow">switch</span> (type)
<a name="l04856"></a>04856     {
<a name="l04857"></a>04857       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12affaecae0cb84f6b401a5beb0caea7f1fac2">REPORT_FORMAT_PARAM_TYPE_BOOLEAN</a>:
<a name="l04858"></a>04858         <span class="keywordflow">return</span> <span class="stringliteral">&quot;boolean&quot;</span>;
<a name="l04859"></a>04859       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12affa63f6bdc059c66eed8976fefe0d719ffe">REPORT_FORMAT_PARAM_TYPE_INTEGER</a>:
<a name="l04860"></a>04860         <span class="keywordflow">return</span> <span class="stringliteral">&quot;integer&quot;</span>;
<a name="l04861"></a>04861       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12affa8b350ef31961d122a001e21d4698f342">REPORT_FORMAT_PARAM_TYPE_SELECTION</a>:
<a name="l04862"></a>04862         <span class="keywordflow">return</span> <span class="stringliteral">&quot;selection&quot;</span>;
<a name="l04863"></a>04863       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12affaf44575176b01686532624f26f8e702db">REPORT_FORMAT_PARAM_TYPE_STRING</a>:
<a name="l04864"></a>04864         <span class="keywordflow">return</span> <span class="stringliteral">&quot;string&quot;</span>;
<a name="l04865"></a>04865       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12affa6c729a78498a13f6a0104e4de7e878ce">REPORT_FORMAT_PARAM_TYPE_TEXT</a>:
<a name="l04866"></a>04866         <span class="keywordflow">return</span> <span class="stringliteral">&quot;text&quot;</span>;
<a name="l04867"></a>04867       <span class="keywordflow">default</span>:
<a name="l04868"></a>04868         assert (0);
<a name="l04869"></a>04869       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#a56b5a74be9a4b98545fe9d6d4ab12affa55448cf4c663854024030c9a494c3e07">REPORT_FORMAT_PARAM_TYPE_ERROR</a>:
<a name="l04870"></a>04870         <span class="keywordflow">return</span> <span class="stringliteral">&quot;ERROR&quot;</span>;
<a name="l04871"></a>04871     }
<a name="l04872"></a>04872 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a22e0436f979225a5317232910991c5ce"></a><!-- doxytag: member="manage.c::report_type_iterator_name" ref="a22e0436f979225a5317232910991c5ce" args="(report_type_iterator_t *iterator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* report_type_iterator_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structreport__type__iterator__t.html">report_type_iterator_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the name from a report type iterator. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>iterator</em>&nbsp;</td><td>Iterator.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Name. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04134">4134</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l02074">report_type_iterator_t::current</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04135"></a>04135 {
<a name="l04136"></a>04136   <span class="keywordflow">return</span> (<span class="keyword">const</span> <span class="keywordtype">char</span>*) *iterator-&gt;<a class="code" href="structreport__type__iterator__t.html#aef30e4a63f98728f2d7c7db8f7ff9b61" title="Current type.">current</a>;
<a name="l04137"></a>04137 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a99c82539e8e835517df4a830c3f090e9"></a><!-- doxytag: member="manage.c::report_type_iterator_title" ref="a99c82539e8e835517df4a830c3f090e9" args="(report_type_iterator_t *iterator)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* report_type_iterator_title </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structreport__type__iterator__t.html">report_type_iterator_t</a> *&nbsp;</td>
          <td class="paramname"> <em>iterator</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Return the title from a report type iterator. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>iterator</em>&nbsp;</td><td>Iterator.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Title. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04147">4147</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l02074">report_type_iterator_t::current</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04148"></a>04148 {
<a name="l04149"></a>04149   <span class="keyword">const</span> <span class="keywordtype">char</span> *name = *iterator-&gt;<a class="code" href="structreport__type__iterator__t.html#aef30e4a63f98728f2d7c7db8f7ff9b61" title="Current type.">current</a>;
<a name="l04150"></a>04150   <span class="keywordflow">return</span> name + strlen (name) + 1;
<a name="l04151"></a>04151 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4855b1e67b70882496413511bcd2426e"></a><!-- doxytag: member="manage.c::reschedule_task" ref="a4855b1e67b70882496413511bcd2426e" args="(const gchar *task_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void reschedule_task </td>
          <td>(</td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>task_id</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set a task's schedule so that it runs again next scheduling round. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>task_id</em>&nbsp;</td><td>UUID of task. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04440">4440</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage__sql_8c_source.html#l13828">set_task_schedule_next_time()</a>, and <a class="el" href="sql_8c_source.html#l00692">sql_int64()</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l04475">manage_schedule()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04441"></a>04441 {
<a name="l04442"></a>04442   <a class="code" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a> task;
<a name="l04443"></a>04443   task = 0;
<a name="l04444"></a>04444   <span class="keywordflow">switch</span> (<a class="code" href="sql_8c.html#a50fc1089978be8363ad4c0316db3ec1e" title="Get a particular cell from a SQL query, as an int64.">sql_int64</a> (&amp;task, 0, 0,
<a name="l04445"></a>04445                      <span class="stringliteral">&quot;SELECT id FROM tasks WHERE uuid = &apos;%s&apos;&quot;</span>
<a name="l04446"></a>04446                      <span class="stringliteral">&quot; AND hidden != 2;&quot;</span>,
<a name="l04447"></a>04447                      <a class="code" href="manage_8h.html#ac91862710d5a515ab542fe0229f1c6dc" title="Return the identifier of a task.">task_id</a>))
<a name="l04448"></a>04448     {
<a name="l04449"></a>04449       <span class="keywordflow">case</span> 0:
<a name="l04450"></a>04450         g_warning (<span class="stringliteral">&quot;%s: rescheduling task &apos;%s&apos;\n&quot;</span>, __FUNCTION__, <a class="code" href="manage_8h.html#ac91862710d5a515ab542fe0229f1c6dc" title="Return the identifier of a task.">task_id</a>);
<a name="l04451"></a>04451         <a class="code" href="manage__sql_8c.html#a145f27fc3308e74324c30689a20a2f40" title="Set the next time a scheduled task will be due.">set_task_schedule_next_time</a> (task, time (NULL) - 1);
<a name="l04452"></a>04452         <span class="keywordflow">break</span>;
<a name="l04453"></a>04453       <span class="keywordflow">case</span> 1:        <span class="comment">/* Too few rows in result of query. */</span>
<a name="l04454"></a>04454         <span class="keywordflow">break</span>;
<a name="l04455"></a>04455       <span class="keywordflow">default</span>:       <span class="comment">/* Programming error. */</span>
<a name="l04456"></a>04456         assert (0);
<a name="l04457"></a>04457       <span class="keywordflow">case</span> -1:
<a name="l04458"></a>04458         <span class="keywordflow">break</span>;
<a name="l04459"></a>04459     }
<a name="l04460"></a>04460 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a9533a90e24d2872b28730986918e3fb4"></a><!-- doxytag: member="manage.c::resume_or_start_task" ref="a9533a90e24d2872b28730986918e3fb4" args="(const char *task_id, char **report_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int resume_or_start_task </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>task_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>report_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Resume task if stopped, else start task. </p>
<p>Only one task can run at a time in a process.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>task_id</em>&nbsp;</td><td>The task ID. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>report_id</em>&nbsp;</td><td>The report ID.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Any start_task error. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l03749">3749</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage__acl_8c_source.html#l00050">user_may()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03750"></a>03750 {
<a name="l03751"></a>03751   <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#abe056c751dd156a61be8677666039d29" title="Test whether a user may perform an operation.">user_may</a> (<span class="stringliteral">&quot;resume_or_start_task&quot;</span>) == 0)
<a name="l03752"></a>03752     <span class="keywordflow">return</span> 99;
<a name="l03753"></a>03753 
<a name="l03754"></a>03754   <span class="keywordflow">return</span> run_task (<a class="code" href="manage_8h.html#ac91862710d5a515ab542fe0229f1c6dc" title="Return the identifier of a task.">task_id</a>, report_id, 2, <span class="stringliteral">&quot;resume_or_start_task&quot;</span>);
<a name="l03755"></a>03755 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a47934e18995a389f8186527ccb09745a"></a><!-- doxytag: member="manage.c::resume_paused_task" ref="a47934e18995a389f8186527ccb09745a" args="(const char *task_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int resume_paused_task </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>task_id</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initiate resuming of a task. </p>
<p>Use <a class="el" href="ovas-mngr-comm_8h.html#a4190e998fca6ff7f6566f520b9fe4000">send_to_server</a> to queue the task resume sequence in the scanner output buffer.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>task_id</em>&nbsp;</td><td>Task UUID.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, 1 if resume requested, 3 failed to find task, 99 permission denied, -1 if out of space in scanner output buffer, -5 scanner down. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l03677">3677</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8c_source.html#l00775">current_scanner_task</a>, <a class="el" href="manage__sql_8c_source.html#l26206">find_task_with_permission()</a>, <a class="el" href="manage_8c_source.html#l00760">scanner_up</a>, <a class="el" href="ovas-mngr-comm_8c_source.html#l00155">send_to_server()</a>, <a class="el" href="manage__sql_8c_source.html#l13141">set_task_run_status()</a>, <a class="el" href="manage__sql_8c_source.html#l13127">task_run_status()</a>, <a class="el" href="manage_8h_source.html#l00172">TASK_STATUS_PAUSE_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00174">TASK_STATUS_PAUSED</a>, <a class="el" href="manage_8h_source.html#l00175">TASK_STATUS_RESUME_REQUESTED</a>, and <a class="el" href="manage__acl_8c_source.html#l00050">user_may()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03678"></a>03678 {
<a name="l03679"></a>03679   <a class="code" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a> task;
<a name="l03680"></a>03680   <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65" title="Task statuses, also used as scan/report statuses.">task_status_t</a> run_status;
<a name="l03681"></a>03681 
<a name="l03682"></a>03682   <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#abe056c751dd156a61be8677666039d29" title="Test whether a user may perform an operation.">user_may</a> (<span class="stringliteral">&quot;resume_paused_task&quot;</span>) == 0)
<a name="l03683"></a>03683     <span class="keywordflow">return</span> 99;
<a name="l03684"></a>03684 
<a name="l03685"></a>03685   task = 0;
<a name="l03686"></a>03686   <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#a6d78c3b661d76fd8c51d81bb15d0ad9f" title="Find a task for a specific permission, given a UUID.">find_task_with_permission</a> (<a class="code" href="manage_8h.html#ac91862710d5a515ab542fe0229f1c6dc" title="Return the identifier of a task.">task_id</a>, &amp;task, <span class="stringliteral">&quot;resume_paused_task&quot;</span>))
<a name="l03687"></a>03687     <span class="keywordflow">return</span> -1;
<a name="l03688"></a>03688   <span class="keywordflow">if</span> (task == 0)
<a name="l03689"></a>03689     <span class="keywordflow">return</span> 3;
<a name="l03690"></a>03690 
<a name="l03691"></a>03691   <span class="keywordflow">if</span> (<a class="code" href="manage_8c.html#afa812d6ddd8794083a9964ae2293b2d3" title="Scanner available flag.">scanner_up</a> == 0)
<a name="l03692"></a>03692     <span class="keywordflow">return</span> -5;
<a name="l03693"></a>03693 
<a name="l03694"></a>03694   run_status = <a class="code" href="manage_8h.html#a6ee81446351e254b95a54483210f1ada" title="Return the run state of a task.">task_run_status</a> (task);
<a name="l03695"></a>03695   <span class="keywordflow">if</span> (run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65ad734252ff7130810a12e395498625d8b">TASK_STATUS_PAUSE_REQUESTED</a>
<a name="l03696"></a>03696       || run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0b77333c1d4ae0d0eabc67464554f400">TASK_STATUS_PAUSED</a>)
<a name="l03697"></a>03697     {
<a name="l03698"></a>03698       <span class="keywordflow">if</span> (<a class="code" href="manage_8c.html#a448b7803b3f0a72e88d11cece0fc8aa6" title="The task currently running on the scanner.">current_scanner_task</a> == task
<a name="l03699"></a>03699           &amp;&amp; <a class="code" href="ovas-mngr-comm_8c.html#a5e8ebd680f5948035731df580f52bbab" title="Send a message to the server.">send_to_server</a> (<span class="stringliteral">&quot;CLIENT &lt;|&gt; RESUME_WHOLE_TEST &lt;|&gt; CLIENT\n&quot;</span>))
<a name="l03700"></a>03700         <span class="keywordflow">return</span> -1;
<a name="l03701"></a>03701       <a class="code" href="manage_8h.html#a8607acfa50914954cc41f17d045775e6" title="Set the run state of a task.">set_task_run_status</a> (task, <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65aab2e7d18cbd9530b261a6293ddef8317">TASK_STATUS_RESUME_REQUESTED</a>);
<a name="l03702"></a>03702       <span class="keywordflow">return</span> 1;
<a name="l03703"></a>03703     }
<a name="l03704"></a>03704 
<a name="l03705"></a>03705   <span class="keywordflow">return</span> 0;
<a name="l03706"></a>03706 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a5913ba5511f7c1b97b81a5e3ec243412"></a><!-- doxytag: member="manage.c::resume_stopped_task" ref="a5913ba5511f7c1b97b81a5e3ec243412" args="(const char *task_id, char **report_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int resume_stopped_task </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>task_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>report_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Resume a stopped task. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>task_id</em>&nbsp;</td><td>Task UUID. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>report_id</em>&nbsp;</td><td>If successful, ID of the resultant report.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>22 caller error (task must be in "stopped" state), or any start_task error. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l03718">3718</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage__sql_8c_source.html#l26206">find_task_with_permission()</a>, <a class="el" href="manage__sql_8c_source.html#l13127">task_run_status()</a>, <a class="el" href="manage_8h_source.html#l00179">TASK_STATUS_STOPPED</a>, and <a class="el" href="manage__acl_8c_source.html#l00050">user_may()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03719"></a>03719 {
<a name="l03720"></a>03720   <a class="code" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a> task;
<a name="l03721"></a>03721   <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65" title="Task statuses, also used as scan/report statuses.">task_status_t</a> run_status;
<a name="l03722"></a>03722 
<a name="l03723"></a>03723   <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#abe056c751dd156a61be8677666039d29" title="Test whether a user may perform an operation.">user_may</a> (<span class="stringliteral">&quot;resume_stopped_task&quot;</span>) == 0)
<a name="l03724"></a>03724     <span class="keywordflow">return</span> 99;
<a name="l03725"></a>03725 
<a name="l03726"></a>03726   task = 0;
<a name="l03727"></a>03727   <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#a6d78c3b661d76fd8c51d81bb15d0ad9f" title="Find a task for a specific permission, given a UUID.">find_task_with_permission</a> (<a class="code" href="manage_8h.html#ac91862710d5a515ab542fe0229f1c6dc" title="Return the identifier of a task.">task_id</a>, &amp;task, <span class="stringliteral">&quot;resume_stopped_task&quot;</span>))
<a name="l03728"></a>03728     <span class="keywordflow">return</span> -1;
<a name="l03729"></a>03729   <span class="keywordflow">if</span> (task == 0)
<a name="l03730"></a>03730     <span class="keywordflow">return</span> 3;
<a name="l03731"></a>03731 
<a name="l03732"></a>03732   run_status = <a class="code" href="manage_8h.html#a6ee81446351e254b95a54483210f1ada" title="Return the run state of a task.">task_run_status</a> (task);
<a name="l03733"></a>03733   <span class="keywordflow">if</span> (run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65afd9ce62ed6527ce4538d459aef435175">TASK_STATUS_STOPPED</a>)
<a name="l03734"></a>03734     <span class="keywordflow">return</span> run_task (<a class="code" href="manage_8h.html#ac91862710d5a515ab542fe0229f1c6dc" title="Return the identifier of a task.">task_id</a>, report_id, 1, <span class="stringliteral">&quot;resume_stopped_task&quot;</span>);
<a name="l03735"></a>03735   <span class="keywordflow">return</span> 22;
<a name="l03736"></a>03736 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a8fd61b9a4fc00435cccfc0a13dba3378"></a><!-- doxytag: member="manage.c::run_status_name" ref="a8fd61b9a4fc00435cccfc0a13dba3378" args="(task_status_t status)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* run_status_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65">task_status_t</a>&nbsp;</td>
          <td class="paramname"> <em>status</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the name of a run status. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>status</em>&nbsp;</td><td>Run status.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The name of the status (for example, "Done" or "Running"). </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00979">979</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00167">TASK_STATUS_DELETE_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00181">TASK_STATUS_DELETE_ULTIMATE_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00184">TASK_STATUS_DELETE_ULTIMATE_WAITING</a>, <a class="el" href="manage_8h_source.html#l00183">TASK_STATUS_DELETE_WAITING</a>, <a class="el" href="manage_8h_source.html#l00168">TASK_STATUS_DONE</a>, <a class="el" href="manage_8h_source.html#l00169">TASK_STATUS_NEW</a>, <a class="el" href="manage_8h_source.html#l00172">TASK_STATUS_PAUSE_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00173">TASK_STATUS_PAUSE_WAITING</a>, <a class="el" href="manage_8h_source.html#l00174">TASK_STATUS_PAUSED</a>, <a class="el" href="manage_8h_source.html#l00170">TASK_STATUS_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00175">TASK_STATUS_RESUME_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00176">TASK_STATUS_RESUME_WAITING</a>, <a class="el" href="manage_8h_source.html#l00171">TASK_STATUS_RUNNING</a>, <a class="el" href="manage_8h_source.html#l00177">TASK_STATUS_STOP_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00182">TASK_STATUS_STOP_REQUESTED_GIVEUP</a>, <a class="el" href="manage_8h_source.html#l00178">TASK_STATUS_STOP_WAITING</a>, and <a class="el" href="manage_8h_source.html#l00179">TASK_STATUS_STOPPED</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l00872">event_description()</a>, <a class="el" href="manage__sql_8c_source.html#l13141">set_task_run_status()</a>, <a class="el" href="sql_8c_source.html#l01854">sql_run_status_name()</a>, and <a class="el" href="manage_8c_source.html#l01074">task_run_status_name()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00980"></a>00980 {
<a name="l00981"></a>00981   <span class="keywordflow">switch</span> (status)
<a name="l00982"></a>00982     {
<a name="l00983"></a>00983       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65aeb14e9b0d17875aea2e578740ea73511">TASK_STATUS_DELETE_REQUESTED</a>:
<a name="l00984"></a>00984       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a6b6345e4c6f5777b557bba05babe38e1">TASK_STATUS_DELETE_WAITING</a>:
<a name="l00985"></a>00985         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Delete Requested&quot;</span>;
<a name="l00986"></a>00986       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a80492cc1dd3c32171d1e16236fd2080a">TASK_STATUS_DELETE_ULTIMATE_REQUESTED</a>:
<a name="l00987"></a>00987       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a4503d7e858a22c8975a037296e449319">TASK_STATUS_DELETE_ULTIMATE_WAITING</a>:
<a name="l00988"></a>00988         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Ultimate Delete Requested&quot;</span>;
<a name="l00989"></a>00989       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65aa6d0f9ed77c21c50a5dbda15be0cfda5">TASK_STATUS_DONE</a>:             <span class="keywordflow">return</span> <span class="stringliteral">&quot;Done&quot;</span>;
<a name="l00990"></a>00990       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a06c1917e071cda8248578dc6488a9e26">TASK_STATUS_NEW</a>:              <span class="keywordflow">return</span> <span class="stringliteral">&quot;New&quot;</span>;
<a name="l00991"></a>00991 
<a name="l00992"></a>00992       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65ad734252ff7130810a12e395498625d8b">TASK_STATUS_PAUSE_REQUESTED</a>:
<a name="l00993"></a>00993       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a6d8209c267e3f776f199aa0447adeab7">TASK_STATUS_PAUSE_WAITING</a>:
<a name="l00994"></a>00994         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Pause Requested&quot;</span>;
<a name="l00995"></a>00995 
<a name="l00996"></a>00996       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0b77333c1d4ae0d0eabc67464554f400">TASK_STATUS_PAUSED</a>:           <span class="keywordflow">return</span> <span class="stringliteral">&quot;Paused&quot;</span>;
<a name="l00997"></a>00997       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0a268852134eeb744236e9196514e460">TASK_STATUS_REQUESTED</a>:        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Requested&quot;</span>;
<a name="l00998"></a>00998 
<a name="l00999"></a>00999       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65aab2e7d18cbd9530b261a6293ddef8317">TASK_STATUS_RESUME_REQUESTED</a>:
<a name="l01000"></a>01000       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a1cef794b3f767afb7167f45ed87fcc4e">TASK_STATUS_RESUME_WAITING</a>:
<a name="l01001"></a>01001         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Resume Requested&quot;</span>;
<a name="l01002"></a>01002 
<a name="l01003"></a>01003       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a71652716ef97001ba2420436c93e0d96">TASK_STATUS_RUNNING</a>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;Running&quot;</span>;
<a name="l01004"></a>01004 
<a name="l01005"></a>01005       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a67a4fe195a744d41d307949fe2cceb01">TASK_STATUS_STOP_REQUESTED_GIVEUP</a>:
<a name="l01006"></a>01006       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a9c59cae3c178975e67fd644c321dd7c9">TASK_STATUS_STOP_REQUESTED</a>:
<a name="l01007"></a>01007       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0b0e0633d24f7f6be77b1606ea31c624">TASK_STATUS_STOP_WAITING</a>:
<a name="l01008"></a>01008         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Stop Requested&quot;</span>;
<a name="l01009"></a>01009 
<a name="l01010"></a>01010       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65afd9ce62ed6527ce4538d459aef435175">TASK_STATUS_STOPPED</a>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;Stopped&quot;</span>;
<a name="l01011"></a>01011       <span class="keywordflow">default</span>:                           <span class="keywordflow">return</span> <span class="stringliteral">&quot;Internal Error&quot;</span>;
<a name="l01012"></a>01012     }
<a name="l01013"></a>01013 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a7aa3fd189aa1f5d634dff8fd4ed526d6"></a><!-- doxytag: member="manage.c::run_status_name_internal" ref="a7aa3fd189aa1f5d634dff8fd4ed526d6" args="(task_status_t status)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* run_status_name_internal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65">task_status_t</a>&nbsp;</td>
          <td class="paramname"> <em>status</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the unique name of a run status. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>status</em>&nbsp;</td><td>Run status.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The name of the status (for example, "Done" or "Running"). </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l01023">1023</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00167">TASK_STATUS_DELETE_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00181">TASK_STATUS_DELETE_ULTIMATE_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00184">TASK_STATUS_DELETE_ULTIMATE_WAITING</a>, <a class="el" href="manage_8h_source.html#l00183">TASK_STATUS_DELETE_WAITING</a>, <a class="el" href="manage_8h_source.html#l00168">TASK_STATUS_DONE</a>, <a class="el" href="manage_8h_source.html#l00169">TASK_STATUS_NEW</a>, <a class="el" href="manage_8h_source.html#l00172">TASK_STATUS_PAUSE_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00173">TASK_STATUS_PAUSE_WAITING</a>, <a class="el" href="manage_8h_source.html#l00174">TASK_STATUS_PAUSED</a>, <a class="el" href="manage_8h_source.html#l00170">TASK_STATUS_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00175">TASK_STATUS_RESUME_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00176">TASK_STATUS_RESUME_WAITING</a>, <a class="el" href="manage_8h_source.html#l00171">TASK_STATUS_RUNNING</a>, <a class="el" href="manage_8h_source.html#l00177">TASK_STATUS_STOP_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00182">TASK_STATUS_STOP_REQUESTED_GIVEUP</a>, <a class="el" href="manage_8h_source.html#l00178">TASK_STATUS_STOP_WAITING</a>, and <a class="el" href="manage_8h_source.html#l00179">TASK_STATUS_STOPPED</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01024"></a>01024 {
<a name="l01025"></a>01025   <span class="keywordflow">switch</span> (status)
<a name="l01026"></a>01026     {
<a name="l01027"></a>01027       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65aeb14e9b0d17875aea2e578740ea73511">TASK_STATUS_DELETE_REQUESTED</a>: <span class="keywordflow">return</span> <span class="stringliteral">&quot;Delete Requested&quot;</span>;
<a name="l01028"></a>01028       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a80492cc1dd3c32171d1e16236fd2080a">TASK_STATUS_DELETE_ULTIMATE_REQUESTED</a>:
<a name="l01029"></a>01029         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Ultimate Delete Requested&quot;</span>;
<a name="l01030"></a>01030       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a4503d7e858a22c8975a037296e449319">TASK_STATUS_DELETE_ULTIMATE_WAITING</a>:
<a name="l01031"></a>01031         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Ultimate Delete Waiting&quot;</span>;
<a name="l01032"></a>01032       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a6b6345e4c6f5777b557bba05babe38e1">TASK_STATUS_DELETE_WAITING</a>:   <span class="keywordflow">return</span> <span class="stringliteral">&quot;Delete Waiting&quot;</span>;
<a name="l01033"></a>01033       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65aa6d0f9ed77c21c50a5dbda15be0cfda5">TASK_STATUS_DONE</a>:             <span class="keywordflow">return</span> <span class="stringliteral">&quot;Done&quot;</span>;
<a name="l01034"></a>01034       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a06c1917e071cda8248578dc6488a9e26">TASK_STATUS_NEW</a>:              <span class="keywordflow">return</span> <span class="stringliteral">&quot;New&quot;</span>;
<a name="l01035"></a>01035 
<a name="l01036"></a>01036       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65ad734252ff7130810a12e395498625d8b">TASK_STATUS_PAUSE_REQUESTED</a>:
<a name="l01037"></a>01037         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Pause Requested&quot;</span>;
<a name="l01038"></a>01038 
<a name="l01039"></a>01039       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a6d8209c267e3f776f199aa0447adeab7">TASK_STATUS_PAUSE_WAITING</a>:
<a name="l01040"></a>01040         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Pause Waiting&quot;</span>;
<a name="l01041"></a>01041 
<a name="l01042"></a>01042       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0b77333c1d4ae0d0eabc67464554f400">TASK_STATUS_PAUSED</a>:           <span class="keywordflow">return</span> <span class="stringliteral">&quot;Paused&quot;</span>;
<a name="l01043"></a>01043       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0a268852134eeb744236e9196514e460">TASK_STATUS_REQUESTED</a>:        <span class="keywordflow">return</span> <span class="stringliteral">&quot;Requested&quot;</span>;
<a name="l01044"></a>01044 
<a name="l01045"></a>01045       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65aab2e7d18cbd9530b261a6293ddef8317">TASK_STATUS_RESUME_REQUESTED</a>:
<a name="l01046"></a>01046         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Resume Requested&quot;</span>;
<a name="l01047"></a>01047 
<a name="l01048"></a>01048       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a1cef794b3f767afb7167f45ed87fcc4e">TASK_STATUS_RESUME_WAITING</a>:
<a name="l01049"></a>01049         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Resume Waiting&quot;</span>;
<a name="l01050"></a>01050 
<a name="l01051"></a>01051       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a71652716ef97001ba2420436c93e0d96">TASK_STATUS_RUNNING</a>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;Running&quot;</span>;
<a name="l01052"></a>01052 
<a name="l01053"></a>01053       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a67a4fe195a744d41d307949fe2cceb01">TASK_STATUS_STOP_REQUESTED_GIVEUP</a>:
<a name="l01054"></a>01054       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a9c59cae3c178975e67fd644c321dd7c9">TASK_STATUS_STOP_REQUESTED</a>:
<a name="l01055"></a>01055         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Stop Requested&quot;</span>;
<a name="l01056"></a>01056 
<a name="l01057"></a>01057       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0b0e0633d24f7f6be77b1606ea31c624">TASK_STATUS_STOP_WAITING</a>:
<a name="l01058"></a>01058         <span class="keywordflow">return</span> <span class="stringliteral">&quot;Stop Waiting&quot;</span>;
<a name="l01059"></a>01059 
<a name="l01060"></a>01060       <span class="keywordflow">case</span> <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65afd9ce62ed6527ce4538d459aef435175">TASK_STATUS_STOPPED</a>:          <span class="keywordflow">return</span> <span class="stringliteral">&quot;Stopped&quot;</span>;
<a name="l01061"></a>01061       <span class="keywordflow">default</span>:                           <span class="keywordflow">return</span> <span class="stringliteral">&quot;Internal Error&quot;</span>;
<a name="l01062"></a>01062     }
<a name="l01063"></a>01063 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a867d27509c4c78a259fd4bbf4dc49804"></a><!-- doxytag: member="manage.c::set_scheduled_user_uuid" ref="a867d27509c4c78a259fd4bbf4dc49804" args="(gchar *user_uuid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_scheduled_user_uuid </td>
          <td>(</td>
          <td class="paramtype">gchar *&nbsp;</td>
          <td class="paramname"> <em>user_uuid</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Set UUID of user that scheduled the current task. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>user_uuid</em>&nbsp;</td><td>UUID of user that scheduled the current task. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04429">4429</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l04430"></a>04430 {
<a name="l04431"></a>04431   <a class="code" href="manage_8c.html#ac5399296de033331b1694de7bdc03584" title="UUID of user whose scheduled task is to be started (in connection with authenticate_allow_all)...">schedule_user_uuid</a> = <a class="code" href="manage_8h.html#ad8245297abbff02ac339167568cfa78f" title="Return the UUID of a user.">user_uuid</a>;
<a name="l04432"></a>04432 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6e9c4ce80d279c9c1166456a28f70f10"></a><!-- doxytag: member="manage.c::severity_data_add" ref="a6e9c4ce80d279c9c1166456a28f70f10" args="(severity_data_t *severity_data, double severity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void severity_data_add </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structseverity__data__t.html">severity_data_t</a> *&nbsp;</td>
          <td class="paramname"> <em>severity_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>severity</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a severity occurence to the counts of a <a class="el" href="structseverity__data__t.html">severity_data_t</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>severity_data</em>&nbsp;</td><td>The severity count struct to add to. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>severity</em>&nbsp;</td><td>The severity to add. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00622">622</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00808">severity_data_t::counts</a>, <a class="el" href="manage_8h_source.html#l00810">severity_data_t::max</a>, <a class="el" href="manage_8c_source.html#l00551">severity_data_index()</a>, and <a class="el" href="manage_8h_source.html#l00809">severity_data_t::total</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l18517">report_severity_data()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00623"></a>00623 {
<a name="l00624"></a>00624   (severity_data-&gt;<a class="code" href="structseverity__data__t.html#a0117bda2dbab5a7423fe42785415835d">counts</a>)[<a class="code" href="manage_8c.html#ac77914453335560ec3ce361eea01aaba" title="Convert a severity value into an index in the counts array.">severity_data_index</a> (severity)]++;
<a name="l00625"></a>00625 
<a name="l00626"></a>00626   <span class="keywordflow">if</span> (severity_data-&gt;<a class="code" href="structseverity__data__t.html#a5ccb9b2b55cc5b505b4a93f333ba9a91">total</a> == 0 || severity_data-&gt;<a class="code" href="structseverity__data__t.html#aef1e27cfd8b253e334fa8d2f868a2353">max</a> &lt;= severity)
<a name="l00627"></a>00627     severity_data-&gt;<a class="code" href="structseverity__data__t.html#aef1e27cfd8b253e334fa8d2f868a2353">max</a> = severity;
<a name="l00628"></a>00628 
<a name="l00629"></a>00629   (severity_data-&gt;<a class="code" href="structseverity__data__t.html#a5ccb9b2b55cc5b505b4a93f333ba9a91">total</a>)++;
<a name="l00630"></a>00630 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="adcf0703cc28d8a982332adf6f0f1b206"></a><!-- doxytag: member="manage.c::severity_data_add_count" ref="adcf0703cc28d8a982332adf6f0f1b206" args="(severity_data_t *severity_data, double severity, int count)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void severity_data_add_count </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structseverity__data__t.html">severity_data_t</a> *&nbsp;</td>
          <td class="paramname"> <em>severity_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>count</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Add a multiple severity occurences to the counts of a <a class="el" href="structseverity__data__t.html">severity_data_t</a>. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>severity_data</em>&nbsp;</td><td>The severity count struct to add to. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>severity</em>&nbsp;</td><td>The severity to add. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>count</em>&nbsp;</td><td>The number of occurences to add. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00640">640</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00808">severity_data_t::counts</a>, <a class="el" href="manage_8h_source.html#l00810">severity_data_t::max</a>, <a class="el" href="manage_8c_source.html#l00551">severity_data_index()</a>, and <a class="el" href="manage_8h_source.html#l00809">severity_data_t::total</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00642"></a>00642 {
<a name="l00643"></a>00643   (severity_data-&gt;<a class="code" href="structseverity__data__t.html#a0117bda2dbab5a7423fe42785415835d">counts</a>)[<a class="code" href="manage_8c.html#ac77914453335560ec3ce361eea01aaba" title="Convert a severity value into an index in the counts array.">severity_data_index</a> (severity)] += count;
<a name="l00644"></a>00644 
<a name="l00645"></a>00645   <span class="keywordflow">if</span> (severity_data-&gt;<a class="code" href="structseverity__data__t.html#a5ccb9b2b55cc5b505b4a93f333ba9a91">total</a> == 0 || severity_data-&gt;<a class="code" href="structseverity__data__t.html#aef1e27cfd8b253e334fa8d2f868a2353">max</a> &lt;= severity)
<a name="l00646"></a>00646     severity_data-&gt;<a class="code" href="structseverity__data__t.html#aef1e27cfd8b253e334fa8d2f868a2353">max</a> = severity;
<a name="l00647"></a>00647 
<a name="l00648"></a>00648   (severity_data-&gt;<a class="code" href="structseverity__data__t.html#a5ccb9b2b55cc5b505b4a93f333ba9a91">total</a>) += count;
<a name="l00649"></a>00649 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ac77914453335560ec3ce361eea01aaba"></a><!-- doxytag: member="manage.c::severity_data_index" ref="ac77914453335560ec3ce361eea01aaba" args="(double severity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int severity_data_index </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>severity</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Convert a severity value into an index in the counts array. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>severity</em>&nbsp;</td><td>Severity value.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The index, 0 for invalid severity scores. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00551">551</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00773">SEVERITY_DEBUG</a>, <a class="el" href="manage_8h_source.html#l00775">SEVERITY_ERROR</a>, <a class="el" href="manage_8h_source.html#l00771">SEVERITY_FP</a>, <a class="el" href="manage_8h_source.html#l00783">SEVERITY_SUBDIVISIONS</a>, and <a class="el" href="manage_8c_source.html#l00541">ZERO_SEVERITY_INDEX</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l00622">severity_data_add()</a>, <a class="el" href="manage_8c_source.html#l00640">severity_data_add_count()</a>, and <a class="el" href="manage_8c_source.html#l00661">severity_data_range_count()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00552"></a>00552 {
<a name="l00553"></a>00553   <span class="keywordtype">int</span> ret;
<a name="l00554"></a>00554   <span class="keywordflow">if</span> (severity &gt;= 0.0)
<a name="l00555"></a>00555     ret = (int)(round (severity * <a class="code" href="manage_8h.html#a79c5e57509c07123c77a8a5a1a4bc31d">SEVERITY_SUBDIVISIONS</a>)) + <a class="code" href="manage_8c.html#a7c415f3910ecba64f28a551e5063de6b">ZERO_SEVERITY_INDEX</a>;
<a name="l00556"></a>00556   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (severity == <a class="code" href="manage_8h.html#a278856677dc1ea57b047dbfc213a7a0b">SEVERITY_FP</a> || severity == <a class="code" href="manage_8h.html#a16c5fb5a2e4e400fd8caabc41ed98396">SEVERITY_DEBUG</a>
<a name="l00557"></a>00557            || severity == <a class="code" href="manage_8h.html#a90b2e06a02b5b39bc00210a97f61ce97">SEVERITY_ERROR</a>)
<a name="l00558"></a>00558     ret = (int)(round (severity)) + <a class="code" href="manage_8c.html#a7c415f3910ecba64f28a551e5063de6b">ZERO_SEVERITY_INDEX</a>;
<a name="l00559"></a>00559   <span class="keywordflow">else</span>
<a name="l00560"></a>00560     ret = 0;
<a name="l00561"></a>00561 
<a name="l00562"></a>00562   <span class="keywordflow">return</span> ret;
<a name="l00563"></a>00563 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a5eed77b72694d0371fa8f6480ad0a6f0"></a><!-- doxytag: member="manage.c::severity_data_level_counts" ref="a5eed77b72694d0371fa8f6480ad0a6f0" args="(const severity_data_t *severity_data, const gchar *severity_class, int *errors, int *debugs, int *false_positives, int *logs, int *lows, int *mediums, int *highs)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void severity_data_level_counts </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structseverity__data__t.html">severity_data_t</a> *&nbsp;</td>
          <td class="paramname"> <em>severity_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>severity_class</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>errors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>debugs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>false_positives</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>logs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>lows</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>mediums</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&nbsp;</td>
          <td class="paramname"> <em>highs</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Count the occurrences of severities in the levels. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>severity_data</em>&nbsp;</td><td>The severity counts data to evaluate. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>severity_class</em>&nbsp;</td><td>The severity class setting to use. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>errors</em>&nbsp;</td><td>The number of error messages. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>debugs</em>&nbsp;</td><td>The number of debug messages. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>false_positives</em>&nbsp;</td><td>The number of False Positives. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>logs</em>&nbsp;</td><td>The number of Log messages. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>lows</em>&nbsp;</td><td>The number of Low severity results. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>mediums</em>&nbsp;</td><td>The number of Medium severity results. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>highs</em>&nbsp;</td><td>The number of High severity results. </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00692">692</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8c_source.html#l00309">level_max_severity()</a>, <a class="el" href="manage_8c_source.html#l00258">level_min_severity()</a>, and <a class="el" href="manage_8c_source.html#l00661">severity_data_range_count()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00696"></a>00696 {
<a name="l00697"></a>00697   <span class="keywordflow">if</span> (errors)
<a name="l00698"></a>00698     *errors
<a name="l00699"></a>00699       = <a class="code" href="manage_8c.html#a7cdfefbfa5c806c959d26a8b87c13c66" title="Calculate the total of severity counts in a range.">severity_data_range_count</a> (severity_data,
<a name="l00700"></a>00700                                    <a class="code" href="manage_8c.html#ab10de498a6cf575c242ac2e96b8c3cc5" title="Get the minimum severity for a severity level and class.">level_min_severity</a> (<span class="stringliteral">&quot;Error&quot;</span>,
<a name="l00701"></a>00701                                                        severity_class),
<a name="l00702"></a>00702                                    <a class="code" href="manage_8c.html#a944bb9ece423240e59690aa700f35845" title="Get the minimum severity for a severity level and class.">level_max_severity</a> (<span class="stringliteral">&quot;Error&quot;</span>,
<a name="l00703"></a>00703                                                        severity_class));
<a name="l00704"></a>00704 
<a name="l00705"></a>00705   <span class="keywordflow">if</span> (debugs)
<a name="l00706"></a>00706     *debugs
<a name="l00707"></a>00707       = <a class="code" href="manage_8c.html#a7cdfefbfa5c806c959d26a8b87c13c66" title="Calculate the total of severity counts in a range.">severity_data_range_count</a> (severity_data,
<a name="l00708"></a>00708                                    <a class="code" href="manage_8c.html#ab10de498a6cf575c242ac2e96b8c3cc5" title="Get the minimum severity for a severity level and class.">level_min_severity</a> (<span class="stringliteral">&quot;Debug&quot;</span>,
<a name="l00709"></a>00709                                                        severity_class),
<a name="l00710"></a>00710                                    <a class="code" href="manage_8c.html#a944bb9ece423240e59690aa700f35845" title="Get the minimum severity for a severity level and class.">level_max_severity</a> (<span class="stringliteral">&quot;Debug&quot;</span>,
<a name="l00711"></a>00711                                                        severity_class));
<a name="l00712"></a>00712 
<a name="l00713"></a>00713   <span class="keywordflow">if</span> (false_positives)
<a name="l00714"></a>00714     *false_positives
<a name="l00715"></a>00715       = <a class="code" href="manage_8c.html#a7cdfefbfa5c806c959d26a8b87c13c66" title="Calculate the total of severity counts in a range.">severity_data_range_count</a> (severity_data,
<a name="l00716"></a>00716                                    <a class="code" href="manage_8c.html#ab10de498a6cf575c242ac2e96b8c3cc5" title="Get the minimum severity for a severity level and class.">level_min_severity</a> (<span class="stringliteral">&quot;False Positive&quot;</span>,
<a name="l00717"></a>00717                                                        severity_class),
<a name="l00718"></a>00718                                    <a class="code" href="manage_8c.html#a944bb9ece423240e59690aa700f35845" title="Get the minimum severity for a severity level and class.">level_max_severity</a> (<span class="stringliteral">&quot;False Positive&quot;</span>,
<a name="l00719"></a>00719                                                        severity_class));
<a name="l00720"></a>00720 
<a name="l00721"></a>00721   <span class="keywordflow">if</span> (logs)
<a name="l00722"></a>00722     *logs
<a name="l00723"></a>00723       = <a class="code" href="manage_8c.html#a7cdfefbfa5c806c959d26a8b87c13c66" title="Calculate the total of severity counts in a range.">severity_data_range_count</a> (severity_data,
<a name="l00724"></a>00724                                    <a class="code" href="manage_8c.html#ab10de498a6cf575c242ac2e96b8c3cc5" title="Get the minimum severity for a severity level and class.">level_min_severity</a> (<span class="stringliteral">&quot;Log&quot;</span>,
<a name="l00725"></a>00725                                                        severity_class),
<a name="l00726"></a>00726                                    <a class="code" href="manage_8c.html#a944bb9ece423240e59690aa700f35845" title="Get the minimum severity for a severity level and class.">level_max_severity</a> (<span class="stringliteral">&quot;Log&quot;</span>,
<a name="l00727"></a>00727                                                        severity_class));
<a name="l00728"></a>00728 
<a name="l00729"></a>00729   <span class="keywordflow">if</span> (lows)
<a name="l00730"></a>00730     *lows
<a name="l00731"></a>00731       = <a class="code" href="manage_8c.html#a7cdfefbfa5c806c959d26a8b87c13c66" title="Calculate the total of severity counts in a range.">severity_data_range_count</a> (severity_data,
<a name="l00732"></a>00732                                    <a class="code" href="manage_8c.html#ab10de498a6cf575c242ac2e96b8c3cc5" title="Get the minimum severity for a severity level and class.">level_min_severity</a> (<span class="stringliteral">&quot;low&quot;</span>,
<a name="l00733"></a>00733                                                        severity_class),
<a name="l00734"></a>00734                                    <a class="code" href="manage_8c.html#a944bb9ece423240e59690aa700f35845" title="Get the minimum severity for a severity level and class.">level_max_severity</a> (<span class="stringliteral">&quot;low&quot;</span>,
<a name="l00735"></a>00735                                                        severity_class));
<a name="l00736"></a>00736 
<a name="l00737"></a>00737   <span class="keywordflow">if</span> (mediums)
<a name="l00738"></a>00738     *mediums
<a name="l00739"></a>00739       = <a class="code" href="manage_8c.html#a7cdfefbfa5c806c959d26a8b87c13c66" title="Calculate the total of severity counts in a range.">severity_data_range_count</a> (severity_data,
<a name="l00740"></a>00740                                    <a class="code" href="manage_8c.html#ab10de498a6cf575c242ac2e96b8c3cc5" title="Get the minimum severity for a severity level and class.">level_min_severity</a> (<span class="stringliteral">&quot;medium&quot;</span>,
<a name="l00741"></a>00741                                                        severity_class),
<a name="l00742"></a>00742                                    <a class="code" href="manage_8c.html#a944bb9ece423240e59690aa700f35845" title="Get the minimum severity for a severity level and class.">level_max_severity</a> (<span class="stringliteral">&quot;medium&quot;</span>,
<a name="l00743"></a>00743                                                        severity_class));
<a name="l00744"></a>00744 
<a name="l00745"></a>00745   <span class="keywordflow">if</span> (highs)
<a name="l00746"></a>00746     *highs
<a name="l00747"></a>00747       = <a class="code" href="manage_8c.html#a7cdfefbfa5c806c959d26a8b87c13c66" title="Calculate the total of severity counts in a range.">severity_data_range_count</a> (severity_data,
<a name="l00748"></a>00748                                    <a class="code" href="manage_8c.html#ab10de498a6cf575c242ac2e96b8c3cc5" title="Get the minimum severity for a severity level and class.">level_min_severity</a> (<span class="stringliteral">&quot;high&quot;</span>,
<a name="l00749"></a>00749                                                        severity_class),
<a name="l00750"></a>00750                                    <a class="code" href="manage_8c.html#a944bb9ece423240e59690aa700f35845" title="Get the minimum severity for a severity level and class.">level_max_severity</a> (<span class="stringliteral">&quot;high&quot;</span>,
<a name="l00751"></a>00751                                                        severity_class));
<a name="l00752"></a>00752 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a7cdfefbfa5c806c959d26a8b87c13c66"></a><!-- doxytag: member="manage.c::severity_data_range_count" ref="a7cdfefbfa5c806c959d26a8b87c13c66" args="(const severity_data_t *severity_data, double min_severity, double max_severity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int severity_data_range_count </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="structseverity__data__t.html">severity_data_t</a> *&nbsp;</td>
          <td class="paramname"> <em>severity_data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>min_severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>max_severity</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Calculate the total of severity counts in a range. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>severity_data</em>&nbsp;</td><td>The severity data struct to get counts from. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>min_severity</em>&nbsp;</td><td>The minimum severity included in the range. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>max_severity</em>&nbsp;</td><td>The maximum severity included in the range.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The total of severity counts in the specified range. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00661">661</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00808">severity_data_t::counts</a>, and <a class="el" href="manage_8c_source.html#l00551">severity_data_index()</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l00692">severity_data_level_counts()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00663"></a>00663 {
<a name="l00664"></a>00664   <span class="keywordtype">int</span> i, i_max, count;
<a name="l00665"></a>00665 
<a name="l00666"></a>00666   i_max = <a class="code" href="manage_8c.html#ac77914453335560ec3ce361eea01aaba" title="Convert a severity value into an index in the counts array.">severity_data_index</a> (max_severity);
<a name="l00667"></a>00667   count = 0;
<a name="l00668"></a>00668 
<a name="l00669"></a>00669   <span class="keywordflow">for</span> (i = <a class="code" href="manage_8c.html#ac77914453335560ec3ce361eea01aaba" title="Convert a severity value into an index in the counts array.">severity_data_index</a> (min_severity);
<a name="l00670"></a>00670        i &lt;= i_max;
<a name="l00671"></a>00671        i++)
<a name="l00672"></a>00672     {
<a name="l00673"></a>00673       count += (severity_data-&gt;<a class="code" href="structseverity__data__t.html#a0117bda2dbab5a7423fe42785415835d">counts</a>)[i];
<a name="l00674"></a>00674     }
<a name="l00675"></a>00675   <span class="keywordflow">return</span> count;
<a name="l00676"></a>00676 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a30a93f1f17b47c6d2607c35b34fc5093"></a><!-- doxytag: member="manage.c::severity_data_value" ref="a30a93f1f17b47c6d2607c35b34fc5093" args="(int index)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double severity_data_value </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>index</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Convert an index in the counts array to a severity value. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>index</em>&nbsp;</td><td>Index in the counts array.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The corresponding severity value. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00573">573</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00781">SEVERITY_MAX</a>, <a class="el" href="manage_8h_source.html#l00777">SEVERITY_MISSING</a>, <a class="el" href="manage_8h_source.html#l00783">SEVERITY_SUBDIVISIONS</a>, and <a class="el" href="manage_8c_source.html#l00541">ZERO_SEVERITY_INDEX</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00574"></a>00574 {
<a name="l00575"></a>00575   <span class="keywordtype">double</span> ret;
<a name="l00576"></a>00576   <span class="keywordflow">if</span> (index &lt;= ZERO_SEVERITY_INDEX &amp;&amp; index &gt; 0)
<a name="l00577"></a>00577     ret = ((double) index) - <a class="code" href="manage_8c.html#a7c415f3910ecba64f28a551e5063de6b">ZERO_SEVERITY_INDEX</a>;
<a name="l00578"></a>00578   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (index &lt;= (<a class="code" href="manage_8c.html#a7c415f3910ecba64f28a551e5063de6b">ZERO_SEVERITY_INDEX</a>
<a name="l00579"></a>00579                      + (<a class="code" href="manage_8h.html#a79c5e57509c07123c77a8a5a1a4bc31d">SEVERITY_SUBDIVISIONS</a> * <a class="code" href="manage_8h.html#a6f8c43fbdd8da04c1a554cc5dfc09674">SEVERITY_MAX</a>)))
<a name="l00580"></a>00580     ret = (((double) (index - <a class="code" href="manage_8c.html#a7c415f3910ecba64f28a551e5063de6b">ZERO_SEVERITY_INDEX</a>)) / <a class="code" href="manage_8h.html#a79c5e57509c07123c77a8a5a1a4bc31d">SEVERITY_SUBDIVISIONS</a>);
<a name="l00581"></a>00581   <span class="keywordflow">else</span>
<a name="l00582"></a>00582     ret = <a class="code" href="manage_8h.html#a0092499ecda0b1be8668de33c0206bdf">SEVERITY_MISSING</a>;
<a name="l00583"></a>00583 
<a name="l00584"></a>00584   <span class="keywordflow">return</span> ret;
<a name="l00585"></a>00585 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a866a1eadfc6d61cbec217a99bcf59a8c"></a><!-- doxytag: member="manage.c::severity_in_level" ref="a866a1eadfc6d61cbec217a99bcf59a8c" args="(double severity, const char *level)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int severity_in_level </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>level</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check whether a severity falls within a threat level. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>severity</em>&nbsp;</td><td>Severity. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>level</em>&nbsp;</td><td>Threat level.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 if in level, else 0. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00206">206</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage__sql_8c_source.html#l48277">setting_severity()</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l00360">severity_matches_type()</a>, <a class="el" href="manage_8c_source.html#l00422">severity_to_level()</a>, and <a class="el" href="sql_8c_source.html#l01986">sql_severity_in_level()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00207"></a>00207 {
<a name="l00208"></a>00208   <span class="keyword">const</span> <span class="keywordtype">char</span> *<span class="keyword">class</span>;
<a name="l00209"></a>00209 
<a name="l00210"></a>00210   <span class="keyword">class </span>= <a class="code" href="manage_8h.html#a71f993197e557fa8fa5161aebc1eca2d" title="Return the Severity Class user setting.">setting_severity</a> ();
<a name="l00211"></a>00211   <span class="keywordflow">if</span> (strcmp (<span class="keyword">class</span>, <span class="stringliteral">&quot;classic&quot;</span>) == 0)
<a name="l00212"></a>00212     {
<a name="l00213"></a>00213       <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;high&quot;</span>) == 0)
<a name="l00214"></a>00214         <span class="keywordflow">return</span> severity &gt; 5 &amp;&amp; severity &lt;= 10;
<a name="l00215"></a>00215       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;medium&quot;</span>) == 0)
<a name="l00216"></a>00216         <span class="keywordflow">return</span> severity &gt; 2 &amp;&amp; severity &lt;= 5;
<a name="l00217"></a>00217       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;low&quot;</span>) == 0)
<a name="l00218"></a>00218         <span class="keywordflow">return</span> severity &gt; 0 &amp;&amp; severity &lt;= 2;
<a name="l00219"></a>00219       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;none&quot;</span>) == 0)
<a name="l00220"></a>00220         <span class="keywordflow">return</span> severity == 0;
<a name="l00221"></a>00221       <span class="keywordflow">else</span>
<a name="l00222"></a>00222         <span class="keywordflow">return</span> 0;
<a name="l00223"></a>00223     }
<a name="l00224"></a>00224   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (<span class="keyword">class</span>, <span class="stringliteral">&quot;pci-dss&quot;</span>) == 0)
<a name="l00225"></a>00225     {
<a name="l00226"></a>00226       <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;high&quot;</span>) == 0)
<a name="l00227"></a>00227         <span class="keywordflow">return</span> severity &gt;= 4.3;
<a name="l00228"></a>00228       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;none&quot;</span>) == 0)
<a name="l00229"></a>00229         <span class="keywordflow">return</span> severity == 0;
<a name="l00230"></a>00230       <span class="keywordflow">else</span>
<a name="l00231"></a>00231         <span class="keywordflow">return</span> 0;
<a name="l00232"></a>00232     }
<a name="l00233"></a>00233   <span class="keywordflow">else</span>
<a name="l00234"></a>00234     {
<a name="l00235"></a>00235       <span class="comment">/* NIST/BSI. */</span>
<a name="l00236"></a>00236       <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;high&quot;</span>) == 0)
<a name="l00237"></a>00237         <span class="keywordflow">return</span> severity &gt;= 7 &amp;&amp; severity &lt;= 10;
<a name="l00238"></a>00238       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;medium&quot;</span>) == 0)
<a name="l00239"></a>00239         <span class="keywordflow">return</span> severity &gt;= 4 &amp;&amp; severity &lt; 7;
<a name="l00240"></a>00240       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;low&quot;</span>) == 0)
<a name="l00241"></a>00241         <span class="keywordflow">return</span> severity &gt; 0 &amp;&amp; severity &lt; 4;
<a name="l00242"></a>00242       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strcmp (level, <span class="stringliteral">&quot;none&quot;</span>) == 0)
<a name="l00243"></a>00243         <span class="keywordflow">return</span> severity == 0;
<a name="l00244"></a>00244       <span class="keywordflow">else</span>
<a name="l00245"></a>00245         <span class="keywordflow">return</span> 0;
<a name="l00246"></a>00246     }
<a name="l00247"></a>00247 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a1bebf56dccfcb24db071cee1ce6616fc"></a><!-- doxytag: member="manage.c::severity_matches_ov" ref="a1bebf56dccfcb24db071cee1ce6616fc" args="(double severity, double ov_severity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int severity_matches_ov </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>ov_severity</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check whether a severity matches an override's severity. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>severity</em>&nbsp;</td><td>severity score </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ov_severity</em>&nbsp;</td><td>override severity score to match</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 if matches, else 0. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00405">405</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="sql_8c_source.html#l01706">sql_severity_matches_ov()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00406"></a>00406 {
<a name="l00407"></a>00407   <span class="keywordflow">if</span> (ov_severity &lt;= 0.0)
<a name="l00408"></a>00408     <span class="keywordflow">return</span> severity == ov_severity;
<a name="l00409"></a>00409   <span class="keywordflow">else</span>
<a name="l00410"></a>00410     <span class="keywordflow">return</span> severity &gt;= ov_severity;
<a name="l00411"></a>00411 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a54b9ae46bf85a6d47ffd7da4a970ac79"></a><!-- doxytag: member="manage.c::severity_matches_type" ref="a54b9ae46bf85a6d47ffd7da4a970ac79" args="(double severity, const char *type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int severity_matches_type </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>type</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check whether a severity matches a message type. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>severity</em>&nbsp;</td><td>severity score </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>type</em>&nbsp;</td><td>message type</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 if matches, else 0. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00360">360</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00773">SEVERITY_DEBUG</a>, <a class="el" href="manage_8h_source.html#l00775">SEVERITY_ERROR</a>, <a class="el" href="manage_8h_source.html#l00771">SEVERITY_FP</a>, <a class="el" href="manage_8c_source.html#l00206">severity_in_level()</a>, and <a class="el" href="manage_8h_source.html#l00769">SEVERITY_LOG</a>.</p>

<p>Referenced by <a class="el" href="sql_8c_source.html#l01680">sql_severity_matches_type()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00361"></a>00361 {
<a name="l00362"></a>00362   <span class="keywordflow">if</span> (type == NULL)
<a name="l00363"></a>00363     {
<a name="l00364"></a>00364       g_warning (<span class="stringliteral">&quot;%s: type is NULL&quot;</span>, __FUNCTION__);
<a name="l00365"></a>00365       <span class="keywordflow">return</span> 0;
<a name="l00366"></a>00366     }
<a name="l00367"></a>00367   <span class="keywordflow">if</span> (severity == <a class="code" href="manage_8h.html#a9d33ec420648fd2dc6ab5d32e22c783a">SEVERITY_LOG</a>)
<a name="l00368"></a>00368     <span class="keywordflow">return</span> strcmp (<span class="stringliteral">&quot;Log Message&quot;</span>, type) == 0;
<a name="l00369"></a>00369   <span class="keywordflow">if</span> (severity == <a class="code" href="manage_8h.html#a278856677dc1ea57b047dbfc213a7a0b">SEVERITY_FP</a>)
<a name="l00370"></a>00370     <span class="keywordflow">return</span> strcmp (<span class="stringliteral">&quot;False Positive&quot;</span>, type) == 0;
<a name="l00371"></a>00371   <span class="keywordflow">if</span> (severity == <a class="code" href="manage_8h.html#a16c5fb5a2e4e400fd8caabc41ed98396">SEVERITY_DEBUG</a>)
<a name="l00372"></a>00372     <span class="keywordflow">return</span> strcmp (<span class="stringliteral">&quot;Debug Message&quot;</span>, type) == 0;
<a name="l00373"></a>00373   <span class="keywordflow">if</span> (severity == <a class="code" href="manage_8h.html#a90b2e06a02b5b39bc00210a97f61ce97">SEVERITY_ERROR</a>)
<a name="l00374"></a>00374     <span class="keywordflow">return</span> strcmp (<span class="stringliteral">&quot;Error Message&quot;</span>, type) == 0;
<a name="l00375"></a>00375   <span class="keywordflow">if</span> (severity &gt; 0.0 &amp;&amp; severity &lt;= 10.0)
<a name="l00376"></a>00376     {
<a name="l00377"></a>00377       <span class="keywordflow">if</span> (strcmp (<span class="stringliteral">&quot;Alarm&quot;</span>, type) == 0)
<a name="l00378"></a>00378         <span class="keywordflow">return</span> 1;
<a name="l00379"></a>00379       <span class="keywordflow">if</span> ((strcmp (<span class="stringliteral">&quot;high&quot;</span>, type) == 0)
<a name="l00380"></a>00380                || (strcmp (<span class="stringliteral">&quot;medium&quot;</span>, type) == 0)
<a name="l00381"></a>00381                || (strcmp (<span class="stringliteral">&quot;low&quot;</span>, type) == 0))
<a name="l00382"></a>00382         <span class="keywordflow">return</span> <a class="code" href="manage_8c.html#a866a1eadfc6d61cbec217a99bcf59a8c" title="Check whether a severity falls within a threat level.">severity_in_level</a> (severity, type);
<a name="l00383"></a>00383       <span class="keywordflow">if</span> (strcmp (<span class="stringliteral">&quot;Security Hole&quot;</span>, type) == 0)
<a name="l00384"></a>00384         <span class="keywordflow">return</span> <a class="code" href="manage_8c.html#a866a1eadfc6d61cbec217a99bcf59a8c" title="Check whether a severity falls within a threat level.">severity_in_level</a> (severity, <span class="stringliteral">&quot;high&quot;</span>);
<a name="l00385"></a>00385       <span class="keywordflow">if</span> (strcmp (<span class="stringliteral">&quot;Security Warning&quot;</span>, type) == 0)
<a name="l00386"></a>00386         <span class="keywordflow">return</span> <a class="code" href="manage_8c.html#a866a1eadfc6d61cbec217a99bcf59a8c" title="Check whether a severity falls within a threat level.">severity_in_level</a> (severity, <span class="stringliteral">&quot;medium&quot;</span>);
<a name="l00387"></a>00387       <span class="keywordflow">if</span> (strcmp (<span class="stringliteral">&quot;Security Note&quot;</span>, <span class="stringliteral">&quot;type&quot;</span>) == 0)
<a name="l00388"></a>00388         <span class="keywordflow">return</span> <a class="code" href="manage_8c.html#a866a1eadfc6d61cbec217a99bcf59a8c" title="Check whether a severity falls within a threat level.">severity_in_level</a> (severity, <span class="stringliteral">&quot;low&quot;</span>);
<a name="l00389"></a>00389       <span class="keywordflow">return</span> 0;
<a name="l00390"></a>00390     }
<a name="l00391"></a>00391   g_warning (<span class="stringliteral">&quot;%s: Invalid severity score given: %f&quot;</span>,
<a name="l00392"></a>00392              __FUNCTION__, severity);
<a name="l00393"></a>00393   <span class="keywordflow">return</span> 0;
<a name="l00394"></a>00394 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a9d6184775d3a4c03153ff143c3dd92fc"></a><!-- doxytag: member="manage.c::severity_to_level" ref="a9d6184775d3a4c03153ff143c3dd92fc" args="(double severity, int mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* severity_to_level </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>severity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>mode</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the threat level matching a severity score. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>severity</em>&nbsp;</td><td>severity score </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mode</em>&nbsp;</td><td>0 for normal levels, 1 to use "Alarm" for severity &gt; 0.0</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the level as a static string </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00422">422</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00773">SEVERITY_DEBUG</a>, <a class="el" href="manage_8h_source.html#l00775">SEVERITY_ERROR</a>, <a class="el" href="manage_8h_source.html#l00771">SEVERITY_FP</a>, <a class="el" href="manage_8c_source.html#l00206">severity_in_level()</a>, and <a class="el" href="manage_8h_source.html#l00769">SEVERITY_LOG</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l17089">result_iterator_level()</a>, <a class="el" href="manage__sql_8c_source.html#l17060">result_iterator_original_level()</a>, <a class="el" href="sql_8c_source.html#l01748">sql_severity_to_level()</a>, <a class="el" href="sql_8c_source.html#l01432">sql_threat_level()</a>, and <a class="el" href="manage__sql_8c_source.html#l13721">task_threat_level()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00423"></a>00423 {
<a name="l00424"></a>00424   <span class="keywordflow">if</span> (severity == <a class="code" href="manage_8h.html#a9d33ec420648fd2dc6ab5d32e22c783a">SEVERITY_LOG</a>)
<a name="l00425"></a>00425     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Log&quot;</span>;
<a name="l00426"></a>00426   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (severity == <a class="code" href="manage_8h.html#a278856677dc1ea57b047dbfc213a7a0b">SEVERITY_FP</a>)
<a name="l00427"></a>00427     <span class="keywordflow">return</span> <span class="stringliteral">&quot;False Positive&quot;</span>;
<a name="l00428"></a>00428   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (severity == <a class="code" href="manage_8h.html#a16c5fb5a2e4e400fd8caabc41ed98396">SEVERITY_DEBUG</a>)
<a name="l00429"></a>00429     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Debug&quot;</span>;
<a name="l00430"></a>00430   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (severity == <a class="code" href="manage_8h.html#a90b2e06a02b5b39bc00210a97f61ce97">SEVERITY_ERROR</a>)
<a name="l00431"></a>00431     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Error&quot;</span>;
<a name="l00432"></a>00432   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (severity &gt; 0.0 &amp;&amp; severity &lt;= 10.0)
<a name="l00433"></a>00433     {
<a name="l00434"></a>00434       <span class="keywordflow">if</span> (mode == 1)
<a name="l00435"></a>00435         <span class="keywordflow">return</span> (<span class="stringliteral">&quot;Alarm&quot;</span>);
<a name="l00436"></a>00436       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="manage_8c.html#a866a1eadfc6d61cbec217a99bcf59a8c" title="Check whether a severity falls within a threat level.">severity_in_level</a> (severity, <span class="stringliteral">&quot;high&quot;</span>))
<a name="l00437"></a>00437         <span class="keywordflow">return</span> (<span class="stringliteral">&quot;High&quot;</span>);
<a name="l00438"></a>00438       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="manage_8c.html#a866a1eadfc6d61cbec217a99bcf59a8c" title="Check whether a severity falls within a threat level.">severity_in_level</a> (severity, <span class="stringliteral">&quot;medium&quot;</span>))
<a name="l00439"></a>00439         <span class="keywordflow">return</span> (<span class="stringliteral">&quot;Medium&quot;</span>);
<a name="l00440"></a>00440       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="manage_8c.html#a866a1eadfc6d61cbec217a99bcf59a8c" title="Check whether a severity falls within a threat level.">severity_in_level</a> (severity, <span class="stringliteral">&quot;low&quot;</span>))
<a name="l00441"></a>00441         <span class="keywordflow">return</span> (<span class="stringliteral">&quot;Low&quot;</span>);
<a name="l00442"></a>00442       <span class="keywordflow">else</span>
<a name="l00443"></a>00443         <span class="keywordflow">return</span> (<span class="stringliteral">&quot;Log&quot;</span>);
<a name="l00444"></a>00444     }
<a name="l00445"></a>00445   <span class="keywordflow">else</span>
<a name="l00446"></a>00446     {
<a name="l00447"></a>00447       g_warning (<span class="stringliteral">&quot;%s: Invalid severity score given: %f&quot;</span>,
<a name="l00448"></a>00448                  __FUNCTION__, severity);
<a name="l00449"></a>00449       <span class="keywordflow">return</span> (NULL);
<a name="l00450"></a>00450     }
<a name="l00451"></a>00451 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ad88f5b1cdc66952af48fb4f3d43260f9"></a><!-- doxytag: member="manage.c::severity_to_type" ref="ad88f5b1cdc66952af48fb4f3d43260f9" args="(double severity)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* severity_to_type </td>
          <td>(</td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>severity</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the message type matching a severity score. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>severity</em>&nbsp;</td><td>severity score</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the message type as a static string </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00461">461</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8h_source.html#l00773">SEVERITY_DEBUG</a>, <a class="el" href="manage_8h_source.html#l00775">SEVERITY_ERROR</a>, <a class="el" href="manage_8h_source.html#l00771">SEVERITY_FP</a>, and <a class="el" href="manage_8h_source.html#l00769">SEVERITY_LOG</a>.</p>

<p>Referenced by <a class="el" href="sql_8c_source.html#l01783">sql_severity_to_type()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00462"></a>00462 {
<a name="l00463"></a>00463   <span class="keywordflow">if</span> (severity == <a class="code" href="manage_8h.html#a9d33ec420648fd2dc6ab5d32e22c783a">SEVERITY_LOG</a>)
<a name="l00464"></a>00464     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Log Message&quot;</span>;
<a name="l00465"></a>00465   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (severity == <a class="code" href="manage_8h.html#a278856677dc1ea57b047dbfc213a7a0b">SEVERITY_FP</a>)
<a name="l00466"></a>00466     <span class="keywordflow">return</span> <span class="stringliteral">&quot;False Positive&quot;</span>;
<a name="l00467"></a>00467   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (severity == <a class="code" href="manage_8h.html#a16c5fb5a2e4e400fd8caabc41ed98396">SEVERITY_DEBUG</a>)
<a name="l00468"></a>00468     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Debug Message&quot;</span>;
<a name="l00469"></a>00469   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (severity == <a class="code" href="manage_8h.html#a90b2e06a02b5b39bc00210a97f61ce97">SEVERITY_ERROR</a>)
<a name="l00470"></a>00470     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Error Message&quot;</span>;
<a name="l00471"></a>00471   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (severity &gt; 0.0 &amp;&amp; severity &lt;= 10.0)
<a name="l00472"></a>00472     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Alarm&quot;</span>;
<a name="l00473"></a>00473   <span class="keywordflow">else</span>
<a name="l00474"></a>00474     {
<a name="l00475"></a>00475       g_warning (<span class="stringliteral">&quot;%s: Invalid severity score given: %f&quot;</span>,
<a name="l00476"></a>00476                  __FUNCTION__, severity);
<a name="l00477"></a>00477       <span class="keywordflow">return</span> (NULL);
<a name="l00478"></a>00478     }
<a name="l00479"></a>00479 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a08629059dbccb26c5e10d44ef08e9b58"></a><!-- doxytag: member="manage.c::slave_authenticate" ref="a08629059dbccb26c5e10d44ef08e9b58" args="(gnutls_session_t *session, slave_t slave)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int slave_authenticate </td>
          <td>(</td>
          <td class="paramtype">gnutls_session_t *&nbsp;</td>
          <td class="paramname"> <em>session</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="manage_8h.html#a0a96f61bb2eb4c7ea77e2a88dc34fec5">slave_t</a>&nbsp;</td>
          <td class="paramname"> <em>slave</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Authenticate with a slave. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>session</em>&nbsp;</td><td>GNUTLS session. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>slave</em>&nbsp;</td><td>Slave.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 success, -1 error. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l01817">1817</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage__sql_8c_source.html#l41974">slave_login()</a>, and <a class="el" href="manage__sql_8c_source.html#l41989">slave_password()</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l05190">delete_slave_task()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01818"></a>01818 {
<a name="l01819"></a>01819   <span class="keywordtype">int</span> ret;
<a name="l01820"></a>01820   gchar *login, *password;
<a name="l01821"></a>01821 
<a name="l01822"></a>01822   login = <a class="code" href="manage_8h.html#a7e926a95a812f33b2c16f41a47ce1171" title="Return the login associated with a slave.">slave_login</a> (slave);
<a name="l01823"></a>01823   <span class="keywordflow">if</span> (login == NULL)
<a name="l01824"></a>01824     <span class="keywordflow">return</span> -1;
<a name="l01825"></a>01825 
<a name="l01826"></a>01826   password = <a class="code" href="manage_8h.html#a3d344c3260ef8d3b7ea8d37ea1177266" title="Return the password associated with a slave.">slave_password</a> (slave);
<a name="l01827"></a>01827   <span class="keywordflow">if</span> (password == NULL)
<a name="l01828"></a>01828     {
<a name="l01829"></a>01829       g_free (login);
<a name="l01830"></a>01830       <span class="keywordflow">return</span> -1;
<a name="l01831"></a>01831     }
<a name="l01832"></a>01832 
<a name="l01833"></a>01833   ret = omp_authenticate (session, login, password);
<a name="l01834"></a>01834   g_free (login);
<a name="l01835"></a>01835   g_free (password);
<a name="l01836"></a>01836   <span class="keywordflow">if</span> (ret)
<a name="l01837"></a>01837     <span class="keywordflow">return</span> -1;
<a name="l01838"></a>01838   <span class="keywordflow">return</span> 0;
<a name="l01839"></a>01839 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ad162ca53e5660127a25bf3d01fed8f62"></a><!-- doxytag: member="manage.c::slist_free" ref="ad162ca53e5660127a25bf3d01fed8f62" args="(GSList *list)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void slist_free </td>
          <td>(</td>
          <td class="paramtype">GSList *&nbsp;</td>
          <td class="paramname"> <em>list</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Free an slist of pointers, including the pointers. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000007">Todo:</a></b></dt><dd>g_convert back to ISO-8559-1 for scanner? </dd></dl>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>list</em>&nbsp;</td><td>The list. </td></tr>
  </table>
  </dd>
</dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000008">Todo:</a></b></dt><dd>Duplicate in openvas_string module (openvas_string_list_free) . Find proper module to place this function. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l01769">1769</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01770"></a>01770 {
<a name="l01771"></a>01771   GSList *head = list;
<a name="l01772"></a>01772   <span class="keywordflow">while</span> (list)
<a name="l01773"></a>01773     {
<a name="l01774"></a>01774       g_free (list-&gt;data);
<a name="l01775"></a>01775       list = g_slist_next (list);
<a name="l01776"></a>01776     }
<a name="l01777"></a>01777   g_slist_free (head);
<a name="l01778"></a>01778 }
</pre></div></p>

</div>
</div>
<a class="anchor" id="a6d207b7a94d8a3346afd34a4ba99a5d0"></a><!-- doxytag: member="manage.c::start_task" ref="a6d207b7a94d8a3346afd34a4ba99a5d0" args="(const char *task_id, char **report_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int start_task </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>task_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&nbsp;</td>
          <td class="paramname"> <em>report_id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Start a task. </p>
<p>Use <a class="el" href="ovas-mngr-comm_8h.html#a4190e998fca6ff7f6566f520b9fe4000">send_to_server</a> to queue the task start sequence in the scanner output buffer.</p>
<p>Only one task can run at a time in a process.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>task_id</em>&nbsp;</td><td>The task ID. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>report_id</em>&nbsp;</td><td>The report ID.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Before forking: 1 task is active already, 3 failed to find task, 99 permission denied, -1 internal error, -2 task is missing a target, -3 creating the report failed, -4 target missing hosts, -6 already a task running in this process, -9 fork failed. After forking: 0 success (parent), 2 success (child), -10 error (child). </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l03531">3531</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage__acl_8c_source.html#l00050">user_may()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03532"></a>03532 {
<a name="l03533"></a>03533   <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#abe056c751dd156a61be8677666039d29" title="Test whether a user may perform an operation.">user_may</a> (<span class="stringliteral">&quot;start_task&quot;</span>) == 0)
<a name="l03534"></a>03534     <span class="keywordflow">return</span> 99;
<a name="l03535"></a>03535 
<a name="l03536"></a>03536   <span class="keywordflow">return</span> run_task (<a class="code" href="manage_8h.html#ac91862710d5a515ab542fe0229f1c6dc" title="Return the identifier of a task.">task_id</a>, report_id, 0, <span class="stringliteral">&quot;start_task&quot;</span>);
<a name="l03537"></a>03537 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a4662ba38f27cc9cd636ec67dda59e256"></a><!-- doxytag: member="manage.c::stop_task" ref="a4662ba38f27cc9cd636ec67dda59e256" args="(const char *task_id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stop_task </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>task_id</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initiate stopping a task. </p>
<p>Use <a class="el" href="ovas-mngr-comm_8h.html#a4190e998fca6ff7f6566f520b9fe4000">send_to_server</a> to queue the task stop sequence in the scanner output buffer.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>task_id</em>&nbsp;</td><td>Task UUID.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, 1 if stop requested, 3 failed to find task, 99 permission denied, -1 if out of space in scanner output buffer, -5 scanner down. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l03604">3604</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage__sql_8c_source.html#l26206">find_task_with_permission()</a>, <a class="el" href="manage_8c_source.html#l03551">stop_task_internal()</a>, and <a class="el" href="manage__acl_8c_source.html#l00050">user_may()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03605"></a>03605 {
<a name="l03606"></a>03606   <a class="code" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a> task;
<a name="l03607"></a>03607 
<a name="l03608"></a>03608   <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#abe056c751dd156a61be8677666039d29" title="Test whether a user may perform an operation.">user_may</a> (<span class="stringliteral">&quot;stop_task&quot;</span>) == 0)
<a name="l03609"></a>03609     <span class="keywordflow">return</span> 99;
<a name="l03610"></a>03610 
<a name="l03611"></a>03611   task = 0;
<a name="l03612"></a>03612   <span class="keywordflow">if</span> (<a class="code" href="manage_8h.html#a6d78c3b661d76fd8c51d81bb15d0ad9f" title="Find a task for a specific permission, given a UUID.">find_task_with_permission</a> (<a class="code" href="manage_8h.html#ac91862710d5a515ab542fe0229f1c6dc" title="Return the identifier of a task.">task_id</a>, &amp;task, <span class="stringliteral">&quot;stop_task&quot;</span>))
<a name="l03613"></a>03613     <span class="keywordflow">return</span> -1;
<a name="l03614"></a>03614   <span class="keywordflow">if</span> (task == 0)
<a name="l03615"></a>03615     <span class="keywordflow">return</span> 3;
<a name="l03616"></a>03616 
<a name="l03617"></a>03617   <span class="keywordflow">return</span> <a class="code" href="manage_8c.html#aa652f44f6165e1ecbaa2aef72aec3842" title="Initiate stopping a task.">stop_task_internal</a> (task);
<a name="l03618"></a>03618 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="aa652f44f6165e1ecbaa2aef72aec3842"></a><!-- doxytag: member="manage.c::stop_task_internal" ref="aa652f44f6165e1ecbaa2aef72aec3842" args="(task_t task)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int stop_task_internal </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a>&nbsp;</td>
          <td class="paramname"> <em>task</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Initiate stopping a task. </p>
<p>Use <a class="el" href="ovas-mngr-comm_8h.html#a4190e998fca6ff7f6566f520b9fe4000">send_to_server</a> to queue the task stop sequence in the scanner output buffer.</p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>task</em>&nbsp;</td><td>Task.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 on success, 1 if stop requested, -1 if out of space in scanner output buffer, -5 scanner down. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l03551">3551</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8c_source.html#l00775">current_scanner_task</a>, <a class="el" href="manage_8c_source.html#l00760">scanner_up</a>, <a class="el" href="ovas-mngr-comm_8c_source.html#l00155">send_to_server()</a>, <a class="el" href="manage__sql_8c_source.html#l13141">set_task_run_status()</a>, <a class="el" href="manage__sql_8c_source.html#l13127">task_run_status()</a>, <a class="el" href="manage__sql_8c_source.html#l13036">task_slave()</a>, <a class="el" href="manage_8h_source.html#l00167">TASK_STATUS_DELETE_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00181">TASK_STATUS_DELETE_ULTIMATE_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00184">TASK_STATUS_DELETE_ULTIMATE_WAITING</a>, <a class="el" href="manage_8h_source.html#l00183">TASK_STATUS_DELETE_WAITING</a>, <a class="el" href="manage_8h_source.html#l00172">TASK_STATUS_PAUSE_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00173">TASK_STATUS_PAUSE_WAITING</a>, <a class="el" href="manage_8h_source.html#l00174">TASK_STATUS_PAUSED</a>, <a class="el" href="manage_8h_source.html#l00170">TASK_STATUS_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00175">TASK_STATUS_RESUME_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00176">TASK_STATUS_RESUME_WAITING</a>, <a class="el" href="manage_8h_source.html#l00171">TASK_STATUS_RUNNING</a>, <a class="el" href="manage_8h_source.html#l00177">TASK_STATUS_STOP_REQUESTED</a>, <a class="el" href="manage_8h_source.html#l00182">TASK_STATUS_STOP_REQUESTED_GIVEUP</a>, and <a class="el" href="manage_8h_source.html#l00178">TASK_STATUS_STOP_WAITING</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l25775">request_delete_task()</a>, <a class="el" href="manage__sql_8c_source.html#l25833">request_delete_task_uuid()</a>, <a class="el" href="manage__sql_8c_source.html#l13671">set_task_schedule()</a>, and <a class="el" href="manage_8c_source.html#l03604">stop_task()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l03552"></a>03552 {
<a name="l03553"></a>03553   <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65" title="Task statuses, also used as scan/report statuses.">task_status_t</a> run_status;
<a name="l03554"></a>03554 
<a name="l03555"></a>03555   run_status = <a class="code" href="manage_8h.html#a6ee81446351e254b95a54483210f1ada" title="Return the run state of a task.">task_run_status</a> (task);
<a name="l03556"></a>03556   <span class="keywordflow">if</span> (run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65ad734252ff7130810a12e395498625d8b">TASK_STATUS_PAUSE_REQUESTED</a>
<a name="l03557"></a>03557       || run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a6d8209c267e3f776f199aa0447adeab7">TASK_STATUS_PAUSE_WAITING</a>
<a name="l03558"></a>03558       || run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0b77333c1d4ae0d0eabc67464554f400">TASK_STATUS_PAUSED</a>
<a name="l03559"></a>03559       || run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65aab2e7d18cbd9530b261a6293ddef8317">TASK_STATUS_RESUME_REQUESTED</a>
<a name="l03560"></a>03560       || run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a1cef794b3f767afb7167f45ed87fcc4e">TASK_STATUS_RESUME_WAITING</a>
<a name="l03561"></a>03561       || run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0a268852134eeb744236e9196514e460">TASK_STATUS_REQUESTED</a>
<a name="l03562"></a>03562       || run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a71652716ef97001ba2420436c93e0d96">TASK_STATUS_RUNNING</a>)
<a name="l03563"></a>03563     {
<a name="l03564"></a>03564       <span class="keywordflow">if</span> (<a class="code" href="manage_8c.html#a448b7803b3f0a72e88d11cece0fc8aa6" title="The task currently running on the scanner.">current_scanner_task</a> == task)
<a name="l03565"></a>03565         {
<a name="l03566"></a>03566           <span class="keywordflow">if</span> (<a class="code" href="manage_8c.html#afa812d6ddd8794083a9964ae2293b2d3" title="Scanner available flag.">scanner_up</a> == 0)
<a name="l03567"></a>03567             <span class="keywordflow">return</span> -5;
<a name="l03568"></a>03568           <span class="keywordflow">if</span> (<a class="code" href="ovas-mngr-comm_8c.html#a5e8ebd680f5948035731df580f52bbab" title="Send a message to the server.">send_to_server</a> (<span class="stringliteral">&quot;CLIENT &lt;|&gt; STOP_WHOLE_TEST &lt;|&gt; CLIENT\n&quot;</span>))
<a name="l03569"></a>03569             <span class="keywordflow">return</span> -1;
<a name="l03570"></a>03570         }
<a name="l03571"></a>03571       <a class="code" href="manage_8h.html#a8607acfa50914954cc41f17d045775e6" title="Set the run state of a task.">set_task_run_status</a> (task, <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a9c59cae3c178975e67fd644c321dd7c9">TASK_STATUS_STOP_REQUESTED</a>);
<a name="l03572"></a>03572       <span class="keywordflow">return</span> 1;
<a name="l03573"></a>03573     }
<a name="l03574"></a>03574   <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65aeb14e9b0d17875aea2e578740ea73511">TASK_STATUS_DELETE_REQUESTED</a>
<a name="l03575"></a>03575             || run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a6b6345e4c6f5777b557bba05babe38e1">TASK_STATUS_DELETE_WAITING</a>
<a name="l03576"></a>03576             || run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a80492cc1dd3c32171d1e16236fd2080a">TASK_STATUS_DELETE_ULTIMATE_REQUESTED</a>
<a name="l03577"></a>03577             || run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a4503d7e858a22c8975a037296e449319">TASK_STATUS_DELETE_ULTIMATE_WAITING</a>
<a name="l03578"></a>03578             || run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a9c59cae3c178975e67fd644c321dd7c9">TASK_STATUS_STOP_REQUESTED</a>
<a name="l03579"></a>03579             || run_status == <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a0b0e0633d24f7f6be77b1606ea31c624">TASK_STATUS_STOP_WAITING</a>)
<a name="l03580"></a>03580            &amp;&amp; <a class="code" href="manage_8h.html#a0b79ecf3268de5bb8ce97a805f3b5c51" title="Return the slave of a task.">task_slave</a> (task))
<a name="l03581"></a>03581     {
<a name="l03582"></a>03582       <span class="comment">/* A special request from the user to get the task out of a requested</span>
<a name="l03583"></a>03583 <span class="comment">       * state when contact with the slave is lost. */</span>
<a name="l03584"></a>03584       <a class="code" href="manage_8h.html#a8607acfa50914954cc41f17d045775e6" title="Set the run state of a task.">set_task_run_status</a> (task, <a class="code" href="manage_8h.html#ae9866cb4c502caeeb100919f6391df65a67a4fe195a744d41d307949fe2cceb01">TASK_STATUS_STOP_REQUESTED_GIVEUP</a>);
<a name="l03585"></a>03585       <span class="keywordflow">return</span> 1;
<a name="l03586"></a>03586     }
<a name="l03587"></a>03587 
<a name="l03588"></a>03588   <span class="keywordflow">return</span> 0;
<a name="l03589"></a>03589 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ae6f33f854d5742a72848fca30dc68ed7"></a><!-- doxytag: member="manage.c::task_run_status_name" ref="ae6f33f854d5742a72848fca30dc68ed7" args="(task_t task)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* task_run_status_name </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a>&nbsp;</td>
          <td class="paramname"> <em>task</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the name of the status of a task. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>task</em>&nbsp;</td><td>The task.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The name of the status of the given task (for example, "Done" or "Running"). </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l01074">1074</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8c_source.html#l00979">run_status_name()</a>, and <a class="el" href="manage__sql_8c_source.html#l13127">task_run_status()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01075"></a>01075 {
<a name="l01076"></a>01076   <span class="keywordflow">return</span> <a class="code" href="manage_8c.html#a8fd61b9a4fc00435cccfc0a13dba3378" title="Get the name of a run status.">run_status_name</a> (<a class="code" href="manage_8h.html#a6ee81446351e254b95a54483210f1ada" title="Return the run state of a task.">task_run_status</a> (task));
<a name="l01077"></a>01077 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a3025e3f96eee294cc832e2be0629cb86"></a><!-- doxytag: member="manage.c::threat_message_type" ref="a3025e3f96eee294cc832e2be0629cb86" args="(const char *threat)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char* threat_message_type </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>threat</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Get the message type of a threat. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>threat</em>&nbsp;</td><td>Threat.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Static message type name if threat names a threat, else NULL. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00153">153</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l15075">create_report()</a>, and <a class="el" href="manage__sql_8c_source.html#l42127">update_from_slave()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l00154"></a>00154 {
<a name="l00155"></a>00155   <span class="keywordflow">if</span> (strcasecmp (threat, <span class="stringliteral">&quot;High&quot;</span>) == 0)
<a name="l00156"></a>00156     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Alarm&quot;</span>;
<a name="l00157"></a>00157   <span class="keywordflow">if</span> (strcasecmp (threat, <span class="stringliteral">&quot;Medium&quot;</span>) == 0)
<a name="l00158"></a>00158     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Alarm&quot;</span>;
<a name="l00159"></a>00159   <span class="keywordflow">if</span> (strcasecmp (threat, <span class="stringliteral">&quot;Low&quot;</span>) == 0)
<a name="l00160"></a>00160     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Alarm&quot;</span>;
<a name="l00161"></a>00161   <span class="keywordflow">if</span> (strcasecmp (threat, <span class="stringliteral">&quot;Log&quot;</span>) == 0)
<a name="l00162"></a>00162     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Log Message&quot;</span>;
<a name="l00163"></a>00163   <span class="keywordflow">if</span> (strcasecmp (threat, <span class="stringliteral">&quot;Debug&quot;</span>) == 0)
<a name="l00164"></a>00164     <span class="keywordflow">return</span> <span class="stringliteral">&quot;Debug Message&quot;</span>;
<a name="l00165"></a>00165   <span class="keywordflow">if</span> (strcasecmp (threat, <span class="stringliteral">&quot;False Positive&quot;</span>) == 0)
<a name="l00166"></a>00166     <span class="keywordflow">return</span> <span class="stringliteral">&quot;False Positive&quot;</span>;
<a name="l00167"></a>00167   <span class="keywordflow">return</span> NULL;
<a name="l00168"></a>00168 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="ada9c01647f06bfa0d9c95fff5cb3cc7b"></a><!-- doxytag: member="manage.c::update_slave_progress" ref="ada9c01647f06bfa0d9c95fff5cb3cc7b" args="(entity_t get_tasks)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_slave_progress </td>
          <td>(</td>
          <td class="paramtype">entity_t&nbsp;</td>
          <td class="paramname"> <em>get_tasks</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Update the locally cached task progress from the slave. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>get_tasks</em>&nbsp;</td><td>Slave GET_TASKS response.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 success, -1 error. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l01788">1788</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>References <a class="el" href="manage_8c_source.html#l00780">current_report</a>, and <a class="el" href="manage__sql_8c_source.html#l19701">set_report_slave_progress()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l01789"></a>01789 {
<a name="l01790"></a>01790   entity_t entity;
<a name="l01791"></a>01791 
<a name="l01792"></a>01792   entity = entity_child (get_tasks, <span class="stringliteral">&quot;task&quot;</span>);
<a name="l01793"></a>01793   <span class="keywordflow">if</span> (entity == NULL)
<a name="l01794"></a>01794     <span class="keywordflow">return</span> -1;
<a name="l01795"></a>01795   entity = entity_child (entity, <span class="stringliteral">&quot;progress&quot;</span>);
<a name="l01796"></a>01796   <span class="keywordflow">if</span> (entity == NULL)
<a name="l01797"></a>01797     <span class="keywordflow">return</span> -1;
<a name="l01798"></a>01798 
<a name="l01799"></a>01799   <span class="keywordflow">if</span> (<a class="code" href="manage_8c.html#ae77b32701fcfee18e020fa799bc8f026" title="The report of the current task.">current_report</a> == 0)
<a name="l01800"></a>01800     <span class="keywordflow">return</span> -1;
<a name="l01801"></a>01801 
<a name="l01802"></a>01802   <a class="code" href="manage__sql_8c.html#a80caaa3b756320c8854ccb48c8e2a0af" title="Set slave progress of a report.">set_report_slave_progress</a> (<a class="code" href="manage_8c.html#ae77b32701fcfee18e020fa799bc8f026" title="The report of the current task.">current_report</a>,
<a name="l01803"></a>01803                              atoi (entity_text (entity)));
<a name="l01804"></a>01804 
<a name="l01805"></a>01805   <span class="keywordflow">return</span> 0;
<a name="l01806"></a>01806 }
</pre></div></p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="af1ac2781e324e32407594cd91d4c8350"></a><!-- doxytag: member="manage.c::valid_db_resource_type" ref="af1ac2781e324e32407594cd91d4c8350" args="(const char *type)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int valid_db_resource_type </td>
          <td>(</td>
          <td class="paramtype">const char *&nbsp;</td>
          <td class="paramname"> <em>type</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Check whether a resource type table name is valid. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>type</em>&nbsp;</td><td>Type of resource.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>1 yes, 0 no. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05316">5316</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l51179">create_tag()</a>, <a class="el" href="manage__sql_8c_source.html#l51386">modify_tag()</a>, <a class="el" href="manage__sql_8c_source.html#l03779">resource_exists()</a>, <a class="el" href="manage__sql_8c_source.html#l03807">resource_name()</a>, and <a class="el" href="sql_8c_source.html#l01881">sql_resource_exists()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05317"></a>05317 {
<a name="l05318"></a>05318   <span class="keywordflow">if</span> (type == NULL)
<a name="l05319"></a>05319     <span class="keywordflow">return</span> 0;
<a name="l05320"></a>05320 
<a name="l05321"></a>05321   <span class="keywordflow">return</span> (strcasecmp (type, <span class="stringliteral">&quot;agent&quot;</span>) == 0)
<a name="l05322"></a>05322          || (strcasecmp (type, <span class="stringliteral">&quot;alert&quot;</span>) == 0)
<a name="l05323"></a>05323          || (strcasecmp (type, <span class="stringliteral">&quot;config&quot;</span>) == 0)
<a name="l05324"></a>05324          || (strcasecmp (type, <span class="stringliteral">&quot;cpe&quot;</span>) == 0)
<a name="l05325"></a>05325          || (strcasecmp (type, <span class="stringliteral">&quot;cve&quot;</span>) == 0)
<a name="l05326"></a>05326          || (strcasecmp (type, <span class="stringliteral">&quot;lsc_credential&quot;</span>) == 0)
<a name="l05327"></a>05327          || (strcasecmp (type, <span class="stringliteral">&quot;dfn_cert_adv&quot;</span>) == 0)
<a name="l05328"></a>05328          || (strcasecmp (type, <span class="stringliteral">&quot;filter&quot;</span>) == 0)
<a name="l05329"></a>05329          || (strcasecmp (type, <span class="stringliteral">&quot;group&quot;</span>) == 0)
<a name="l05330"></a>05330          || (strcasecmp (type, <span class="stringliteral">&quot;note&quot;</span>) == 0)
<a name="l05331"></a>05331          || (strcasecmp (type, <span class="stringliteral">&quot;nvt&quot;</span>) == 0)
<a name="l05332"></a>05332          || (strcasecmp (type, <span class="stringliteral">&quot;ovaldef&quot;</span>) == 0)
<a name="l05333"></a>05333          || (strcasecmp (type, <span class="stringliteral">&quot;override&quot;</span>) == 0)
<a name="l05334"></a>05334          || (strcasecmp (type, <span class="stringliteral">&quot;port_list&quot;</span>) == 0)
<a name="l05335"></a>05335          || (strcasecmp (type, <span class="stringliteral">&quot;permission&quot;</span>) == 0)
<a name="l05336"></a>05336          || (strcasecmp (type, <span class="stringliteral">&quot;report&quot;</span>) == 0)
<a name="l05337"></a>05337          || (strcasecmp (type, <span class="stringliteral">&quot;report_format&quot;</span>) == 0)
<a name="l05338"></a>05338          || (strcasecmp (type, <span class="stringliteral">&quot;result&quot;</span>) == 0)
<a name="l05339"></a>05339          || (strcasecmp (type, <span class="stringliteral">&quot;role&quot;</span>) == 0)
<a name="l05340"></a>05340          || (strcasecmp (type, <span class="stringliteral">&quot;schedule&quot;</span>) == 0)
<a name="l05341"></a>05341          || (strcasecmp (type, <span class="stringliteral">&quot;slave&quot;</span>) == 0)
<a name="l05342"></a>05342          || (strcasecmp (type, <span class="stringliteral">&quot;tag&quot;</span>) == 0)
<a name="l05343"></a>05343          || (strcasecmp (type, <span class="stringliteral">&quot;target&quot;</span>) == 0)
<a name="l05344"></a>05344          || (strcasecmp (type, <span class="stringliteral">&quot;task&quot;</span>) == 0)
<a name="l05345"></a>05345          || (strcasecmp (type, <span class="stringliteral">&quot;user&quot;</span>) == 0);
<a name="l05346"></a>05346 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="a8ef3b399e7a5cc5c05675b02e24df018"></a><!-- doxytag: member="manage.c::validate_username" ref="a8ef3b399e7a5cc5c05675b02e24df018" args="(const gchar *name)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int validate_username </td>
          <td>(</td>
          <td class="paramtype">const gchar *&nbsp;</td>
          <td class="paramname"> <em>name</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Validates a username. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>name</em>&nbsp;</td><td>The name.</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if the username is valid, 1 if not. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05943">5943</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l50074">create_user()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05944"></a>05944 {
<a name="l05945"></a>05945   <span class="keywordflow">if</span> (g_regex_match_simple (<span class="stringliteral">&quot;^[[:alnum:]-_]+$&quot;</span>, name, 0, 0))
<a name="l05946"></a>05946     <span class="keywordflow">return</span> 0;
<a name="l05947"></a>05947   <span class="keywordflow">else</span>
<a name="l05948"></a>05948     <span class="keywordflow">return</span> 1;
<a name="l05949"></a>05949 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<a class="anchor" id="af59809e7b86df3c35af37cb4bad3d7a1"></a><!-- doxytag: member="manage.c::xsl_transform" ref="af59809e7b86df3c35af37cb4bad3d7a1" args="(gchar *stylesheet, gchar *xmlfile, gchar **param_names, gchar **param_values)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gchar* xsl_transform </td>
          <td>(</td>
          <td class="paramtype">gchar *&nbsp;</td>
          <td class="paramname"> <em>stylesheet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar *&nbsp;</td>
          <td class="paramname"> <em>xmlfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar **&nbsp;</td>
          <td class="paramname"> <em>param_names</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">gchar **&nbsp;</td>
          <td class="paramname"> <em>param_values</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Run xsltproc in an external process. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>stylesheet</em>&nbsp;</td><td>XSL stylesheet to use. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>xmlfile</em>&nbsp;</td><td>XML file to process. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>param_names</em>&nbsp;</td><td>NULL terminated array of stringparam names (can be NULL). </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>param_values</em>&nbsp;</td><td>NULL terminated array of stringparam values (can be NULL).</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>A dynamically allocated (to be g_free'd) string containing the result of the operation of NULL on failure. </dd></dl>

<p>Definition at line <a class="el" href="manage_8c_source.html#l05443">5443</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l05778">manage_read_info()</a>, and <a class="el" href="manage_8c_source.html#l06858">manage_run_wizard()</a>.</p>

<p><div class="fragment"><pre class="fragment"><a name="l05445"></a>05445 {
<a name="l05446"></a>05446   <span class="keywordtype">int</span> i, param_idx;
<a name="l05447"></a>05447   gchar **cmd, *cmd_full;
<a name="l05448"></a>05448   gint exit_status;
<a name="l05449"></a>05449   gboolean success;
<a name="l05450"></a>05450   gchar *standard_out = NULL, *standard_err = NULL;
<a name="l05451"></a>05451 
<a name="l05452"></a>05452   param_idx = 0;
<a name="l05453"></a>05453   <span class="keywordflow">if</span> (param_names &amp;&amp; param_values)
<a name="l05454"></a>05454     <span class="keywordflow">while</span> (param_names[param_idx] &amp;&amp; param_values[param_idx])
<a name="l05455"></a>05455       param_idx++;
<a name="l05456"></a>05456 
<a name="l05457"></a>05457   cmd = (gchar **)g_malloc ((4 + param_idx * 3) * <span class="keyword">sizeof</span> (gchar *));
<a name="l05458"></a>05458 
<a name="l05459"></a>05459   i = 0;
<a name="l05460"></a>05460   cmd[i++] = <span class="stringliteral">&quot;xsltproc&quot;</span>;
<a name="l05461"></a>05461   <span class="keywordflow">if</span> (param_idx)
<a name="l05462"></a>05462     {
<a name="l05463"></a>05463       <span class="keywordtype">int</span> j;
<a name="l05464"></a>05464 
<a name="l05465"></a>05465       <span class="keywordflow">for</span> (j = 0; j &lt; param_idx; j++)
<a name="l05466"></a>05466         {
<a name="l05467"></a>05467           cmd[i++] = <span class="stringliteral">&quot;--stringparam&quot;</span>;
<a name="l05468"></a>05468           cmd[i++] = param_names[j];
<a name="l05469"></a>05469           cmd[i++] = param_values[j];
<a name="l05470"></a>05470         }
<a name="l05471"></a>05471     }
<a name="l05472"></a>05472   cmd[i++] = stylesheet;
<a name="l05473"></a>05473   cmd[i++] = xmlfile;
<a name="l05474"></a>05474   cmd[i] = NULL;
<a name="l05475"></a>05475 
<a name="l05476"></a>05476 
<a name="l05477"></a>05477   <span class="comment">/* DEBUG: display the final command line. */</span>
<a name="l05478"></a>05478   cmd_full = g_strjoinv (<span class="stringliteral">&quot; &quot;</span>, cmd);
<a name="l05479"></a>05479   g_debug (<span class="stringliteral">&quot;%s: Spawning in parent dir: %s\n&quot;</span>,
<a name="l05480"></a>05480            __FUNCTION__, cmd_full);
<a name="l05481"></a>05481   g_free (cmd_full);
<a name="l05482"></a>05482   <span class="comment">/* --- */</span>
<a name="l05483"></a>05483 
<a name="l05484"></a>05484   <span class="keywordflow">if</span> ((g_spawn_sync (NULL,
<a name="l05485"></a>05485                      cmd,
<a name="l05486"></a>05486                      NULL,                  <span class="comment">/* Environment. */</span>
<a name="l05487"></a>05487                      G_SPAWN_SEARCH_PATH,
<a name="l05488"></a>05488                      NULL,                  <span class="comment">/* Setup function. */</span>
<a name="l05489"></a>05489                      NULL,
<a name="l05490"></a>05490                      &amp;standard_out,
<a name="l05491"></a>05491                      &amp;standard_err,
<a name="l05492"></a>05492                      &amp;exit_status,
<a name="l05493"></a>05493                      NULL)
<a name="l05494"></a>05494        == FALSE)
<a name="l05495"></a>05495       || (WIFEXITED (exit_status) == 0)
<a name="l05496"></a>05496       || WEXITSTATUS (exit_status))
<a name="l05497"></a>05497     {
<a name="l05498"></a>05498       g_debug (<span class="stringliteral">&quot;%s: failed to transform the xml: %d (WIF %i, WEX %i)&quot;</span>,
<a name="l05499"></a>05499                __FUNCTION__,
<a name="l05500"></a>05500                exit_status,
<a name="l05501"></a>05501                WIFEXITED (exit_status),
<a name="l05502"></a>05502                WEXITSTATUS (exit_status));
<a name="l05503"></a>05503       g_debug (<span class="stringliteral">&quot;%s: stderr: %s\n&quot;</span>, __FUNCTION__, standard_err);
<a name="l05504"></a>05504       g_debug (<span class="stringliteral">&quot;%s: stdout: %s\n&quot;</span>, __FUNCTION__, standard_out);
<a name="l05505"></a>05505       success = FALSE;
<a name="l05506"></a>05506     }
<a name="l05507"></a>05507   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (strlen (standard_out) == 0)
<a name="l05508"></a>05508     success = FALSE; <span class="comment">/* execution succeeded but nothing was found */</span>
<a name="l05509"></a>05509   <span class="keywordflow">else</span>
<a name="l05510"></a>05510     success = TRUE; <span class="comment">/* execution succeeded and we have a result */</span>
<a name="l05511"></a>05511 
<a name="l05512"></a>05512   <span class="comment">/* Cleanup. */</span>
<a name="l05513"></a>05513   g_free (cmd);
<a name="l05514"></a>05514   g_free (standard_err);
<a name="l05515"></a>05515 
<a name="l05516"></a>05516   <span class="keywordflow">if</span> (success)
<a name="l05517"></a>05517     <span class="keywordflow">return</span> standard_out;
<a name="l05518"></a>05518 
<a name="l05519"></a>05519   g_free (standard_out);
<a name="l05520"></a>05520   <span class="keywordflow">return</span> NULL;
<a name="l05521"></a>05521 }
</pre></div></p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dynsection">
</div>
</p>

</div>
</div>
<hr/><h2>Variable Documentation</h2>
<a class="anchor" id="afc6df99003007ef239148d7a96457ed0"></a><!-- doxytag: member="manage.c::authenticate_allow_all" ref="afc6df99003007ef239148d7a96457ed0" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="manage__sql_8c.html#afc6df99003007ef239148d7a96457ed0">authenticate_allow_all</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Flag for manage_auth_allow_all. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04360">4360</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l12494">authenticate()</a>.</p>

</div>
</div>
<a class="anchor" id="a9478db576484bc00cfe65a5bed1961ab"></a><!-- doxytag: member="manage.c::current_credentials" ref="a9478db576484bc00cfe65a5bed1961ab" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">credentials_t <a class="el" href="manage_8h.html#a9478db576484bc00cfe65a5bed1961ab">current_credentials</a></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Current credentials during any OMP command. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00487">487</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l11018">check_db()</a>, <a class="el" href="manage__sql_8c_source.html#l05717">copy_alert()</a>, <a class="el" href="manage__sql_8c_source.html#l29284">copy_config()</a>, <a class="el" href="manage__sql_8c_source.html#l39510">copy_report_format()</a>, <a class="el" href="manage__sql_8c_source.html#l03748">copy_resource()</a>, <a class="el" href="manage__sql_8c_source.html#l25687">copy_task()</a>, <a class="el" href="manage__sql_8c_source.html#l34578">create_agent()</a>, <a class="el" href="manage__sql_8c_source.html#l05529">create_alert()</a>, <a class="el" href="manage__sql_8c_source.html#l28580">create_config()</a>, <a class="el" href="manage__sql_8c_source.html#l29180">create_config_rc()</a>, <a class="el" href="manage__sql_8c_source.html#l46211">create_filter()</a>, <a class="el" href="manage__sql_8c_source.html#l42438">create_group()</a>, <a class="el" href="manage__sql_8c_source.html#l33148">create_lsc_credential()</a>, <a class="el" href="manage__sql_8c_source.html#l35677">create_note()</a>, <a class="el" href="manage__sql_8c_source.html#l36547">create_override()</a>, <a class="el" href="manage__sql_8c_source.html#l42982">create_permission()</a>, <a class="el" href="manage__sql_8c_source.html#l44355">create_port_list()</a>, <a class="el" href="manage__sql_8c_source.html#l44229">create_port_list_lock()</a>, <a class="el" href="manage__sql_8c_source.html#l44292">create_port_list_unique()</a>, <a class="el" href="manage__sql_8c_source.html#l38915">create_report_format()</a>, <a class="el" href="manage__sql_8c_source.html#l45553">create_role()</a>, <a class="el" href="manage__sql_8c_source.html#l37563">create_schedule()</a>, <a class="el" href="manage__sql_8c_source.html#l41364">create_slave()</a>, <a class="el" href="manage__sql_8c_source.html#l51179">create_tag()</a>, <a class="el" href="manage__sql_8c_source.html#l26775">create_target()</a>, <a class="el" href="manage__sql_8c_source.html#l39797">delete_report_format()</a>, <a class="el" href="manage__sql_8c_source.html#l25963">delete_task()</a>, <a class="el" href="manage__sql_8c_source.html#l26038">delete_task_lock()</a>, <a class="el" href="manage__sql_8c_source.html#l50339">delete_user()</a>, <a class="el" href="manage__sql_8c_source.html#l44093">find_port_range_with_permission()</a>, <a class="el" href="manage__sql_8c_source.html#l38761">find_report_format()</a>, <a class="el" href="manage__sql_8c_source.html#l08536">init_alert_task_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l30488">init_config_task_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l46613">init_filter_alert_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l36234">init_note_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l37216">init_override_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l45440">init_port_list_target_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l45292">init_port_range_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l41099">init_report_format_alert_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l16289">init_result_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l38539">init_schedule_task_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l48321">init_setting_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l42059">init_slave_task_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l28373">init_target_task_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l06622">init_task_alert_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l08752">init_task_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l29545">init_user_config_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l33896">init_user_lsc_credential_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l27637">init_user_target_iterator()</a>, <a class="el" href="manage__sql_8c_source.html#l38827">lookup_report_format()</a>, <a class="el" href="manage__sql_8c_source.html#l25410">make_task()</a>, <a class="el" href="manage__sql_8c_source.html#l49754">manage_create_user()</a>, <a class="el" href="manage__sql_8c_source.html#l49841">manage_delete_user()</a>, <a class="el" href="manage__sql_8c_source.html#l24186">manage_report()</a>, <a class="el" href="manage__sql_8c_source.html#l46986">manage_restore()</a>, <a class="el" href="manage__sql_8c_source.html#l24663">manage_send_report()</a>, <a class="el" href="manage__sql_8c_source.html#l30150">manage_set_config_name()</a>, <a class="el" href="manage__sql_8c_source.html#l30186">manage_set_config_name_comment()</a>, <a class="el" href="manage__sql_8c_source.html#l34963">modify_agent()</a>, <a class="el" href="manage__sql_8c_source.html#l05786">modify_alert()</a>, <a class="el" href="manage__sql_8c_source.html#l46662">modify_filter()</a>, <a class="el" href="manage__sql_8c_source.html#l42772">modify_group()</a>, <a class="el" href="manage__sql_8c_source.html#l33470">modify_lsc_credential()</a>, <a class="el" href="manage__sql_8c_source.html#l43760">modify_permission()</a>, <a class="el" href="manage__sql_8c_source.html#l44572">modify_port_list()</a>, <a class="el" href="manage__sql_8c_source.html#l19580">modify_report()</a>, <a class="el" href="manage__sql_8c_source.html#l39728">modify_report_format()</a>, <a class="el" href="manage__sql_8c_source.html#l45900">modify_role()</a>, <a class="el" href="manage__sql_8c_source.html#l38592">modify_schedule()</a>, <a class="el" href="manage__sql_8c_source.html#l48483">modify_setting()</a>, <a class="el" href="manage__sql_8c_source.html#l41480">modify_slave()</a>, <a class="el" href="manage__sql_8c_source.html#l51386">modify_tag()</a>, <a class="el" href="manage__sql_8c_source.html#l27193">modify_target()</a>, <a class="el" href="manage__sql_8c_source.html#l36103">note_count()</a>, <a class="el" href="manage__sql_8c_source.html#l37084">override_count()</a>, <a class="el" href="manage__sql_8c_source.html#l15523">report_add_result()</a>, <a class="el" href="manage__sql_8c_source.html#l18201">report_scan_result_count()</a>, <a class="el" href="manage__sql_8c_source.html#l18517">report_severity_data()</a>, <a class="el" href="manage__sql_8c_source.html#l25775">request_delete_task()</a>, <a class="el" href="manage__sql_8c_source.html#l25833">request_delete_task_uuid()</a>, <a class="el" href="ompd_8c_source.html#l00702">serve_omp()</a>, <a class="el" href="manage__sql_8c_source.html#l13601">set_task_groups()</a>, <a class="el" href="manage__sql_8c_source.html#l13966">set_task_observers()</a>, <a class="el" href="manage__sql_8c_source.html#l48219">setting_count()</a>, <a class="el" href="manage__sql_8c_source.html#l48291">setting_dynamic_severity_int()</a>, <a class="el" href="manage__sql_8c_source.html#l48259">setting_filter()</a>, <a class="el" href="manage__sql_8c_source.html#l48277">setting_severity()</a>, <a class="el" href="manage__sql_8c_source.html#l48302">setting_timezone()</a>, <a class="el" href="manage__sql_8c_source.html#l48427">setting_value_int()</a>, <a class="el" href="manage__sql_8c_source.html#l11915">stop_active_tasks()</a>, <a class="el" href="manage__sql_8c_source.html#l13846">task_severity()</a>, <a class="el" href="manage__sql_8c_source.html#l25314">task_trend()</a>, <a class="el" href="manage__sql_8c_source.html#l12311">user_ensure_in_db()</a>, <a class="el" href="manage__acl_8c_source.html#l00276">user_has_access_uuid()</a>, <a class="el" href="manage__acl_8c_source.html#l00050">user_may()</a>, <a class="el" href="manage__acl_8c_source.html#l00204">user_owns_result()</a>, <a class="el" href="manage__acl_8c_source.html#l00233">user_owns_uuid()</a>, and <a class="el" href="manage__acl_8c_source.html#l00473">where_owned()</a>.</p>

</div>
</div>
<a class="anchor" id="ae77b32701fcfee18e020fa799bc8f026"></a><!-- doxytag: member="manage.c::current_report" ref="ae77b32701fcfee18e020fa799bc8f026" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="manage_8h.html#a46acf9d556c9f1756609957571bc90f3">report_t</a> <a class="el" href="manage_8h.html#ae77b32701fcfee18e020fa799bc8f026">current_report</a> = (<a class="el" href="manage_8h.html#a46acf9d556c9f1756609957571bc90f3">report_t</a>) 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The report of the current task. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00780">780</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l15016">create_current_report()</a>, <a class="el" href="manage__sql_8c_source.html#l15075">create_report()</a>, <a class="el" href="otp_8c_source.html#l00784">process_otp_scanner_input()</a>, <a class="el" href="manage__sql_8c_source.html#l13141">set_task_run_status()</a>, <a class="el" href="manage__sql_8c_source.html#l19752">trim_report()</a>, <a class="el" href="manage__sql_8c_source.html#l42127">update_from_slave()</a>, and <a class="el" href="manage_8c_source.html#l01788">update_slave_progress()</a>.</p>

</div>
</div>
<a class="anchor" id="a448b7803b3f0a72e88d11cece0fc8aa6"></a><!-- doxytag: member="manage.c::current_scanner_task" ref="a448b7803b3f0a72e88d11cece0fc8aa6" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a> <a class="el" href="manage_8h.html#a448b7803b3f0a72e88d11cece0fc8aa6">current_scanner_task</a> = (<a class="el" href="manage_8h.html#a4a9852f3cf6eae4da1a6d1409253f274">task_t</a>) 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>The task currently running on the scanner. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00775">775</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l12210">cleanup_manage_process()</a>, <a class="el" href="manage__sql_8c_source.html#l15075">create_report()</a>, <a class="el" href="manage_8c_source.html#l03794">manage_check_current_task()</a>, <a class="el" href="manage__sql_8c_source.html#l12244">manage_cleanup_process_error()</a>, <a class="el" href="manage_8c_source.html#l03633">pause_task()</a>, <a class="el" href="otp_8c_source.html#l00784">process_otp_scanner_input()</a>, <a class="el" href="manage_8c_source.html#l03677">resume_paused_task()</a>, <a class="el" href="manage__sql_8c_source.html#l13141">set_task_run_status()</a>, <a class="el" href="manage_8c_source.html#l03551">stop_task_internal()</a>, and <a class="el" href="manage__sql_8c_source.html#l42127">update_from_slave()</a>.</p>

</div>
</div>
<a class="anchor" id="af56db24d7b4cc9e627147fa20fac296d"></a><!-- doxytag: member="manage.c::scanner_active" ref="af56db24d7b4cc9e627147fa20fac296d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short <a class="el" href="manage_8h.html#af56db24d7b4cc9e627147fa20fac296d">scanner_active</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Scanner active flag. </p>
<p>This indicates whether the scanner is doing something that the manager must wait for. Set, for example, by <a class="el" href="manage_8h.html#a4888afaab633caedfcd9c2e9526b1e12">start_task</a>. If this variable is true then the manager keeps the management process alive until the scanner closes its connection, even if the client closes its connection. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00770">770</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="otp_8c_source.html#l00784">process_otp_scanner_input()</a>, and <a class="el" href="omp_8c_source.html#l26250">scanner_is_active()</a>.</p>

</div>
</div>
<a class="anchor" id="afa812d6ddd8794083a9964ae2293b2d3"></a><!-- doxytag: member="manage.c::scanner_up" ref="afa812d6ddd8794083a9964ae2293b2d3" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">short <a class="el" href="manage_8h.html#afa812d6ddd8794083a9964ae2293b2d3">scanner_up</a> = 1</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Scanner available flag. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l00760">760</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage_8c_source.html#l03633">pause_task()</a>, <a class="el" href="manage_8c_source.html#l03677">resume_paused_task()</a>, <a class="el" href="omp_8c_source.html#l26238">scanner_is_up()</a>, <a class="el" href="ompd_8c_source.html#l00702">serve_omp()</a>, and <a class="el" href="manage_8c_source.html#l03551">stop_task_internal()</a>.</p>

</div>
</div>
<a class="anchor" id="ac5399296de033331b1694de7bdc03584"></a><!-- doxytag: member="manage.c::schedule_user_uuid" ref="ac5399296de033331b1694de7bdc03584" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gchar* <a class="el" href="manage_8c.html#ac5399296de033331b1694de7bdc03584">schedule_user_uuid</a> = 0</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>UUID of user whose scheduled task is to be started (in connection with authenticate_allow_all). </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l04366">4366</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="a722e123d1e29a7e306809e3e18c0dc4d"></a><!-- doxytag: member="manage.c::slave_config_uuid" ref="a722e123d1e29a7e306809e3e18c0dc4d" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gchar* <a class="el" href="manage_8c.html#a722e123d1e29a7e306809e3e18c0dc4d">slave_config_uuid</a> = NULL</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Slave config UUID. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l02038">2038</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="ae7596549ddadfa2d0a201d030507df86"></a><!-- doxytag: member="manage.c::slave_report_uuid" ref="ae7596549ddadfa2d0a201d030507df86" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gchar* <a class="el" href="manage_8c.html#ae7596549ddadfa2d0a201d030507df86">slave_report_uuid</a> = NULL</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Slave report UUID. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l02048">2048</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="a493639b270d5f76c41eae92cca6eb55f"></a><!-- doxytag: member="manage.c::slave_session" ref="a493639b270d5f76c41eae92cca6eb55f" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gnutls_session_t* <a class="el" href="manage_8c.html#a493639b270d5f76c41eae92cca6eb55f">slave_session</a> = NULL</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Slave session. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l02053">2053</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="ac9f9744f84e363505692836c77e960ac"></a><!-- doxytag: member="manage.c::slave_smb_credential_uuid" ref="ac9f9744f84e363505692836c77e960ac" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gchar* <a class="el" href="manage_8c.html#ac9f9744f84e363505692836c77e960ac">slave_smb_credential_uuid</a> = NULL</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Slave credential UUID. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l02028">2028</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="a6d2317e3891c679166b479fcc2e285cf"></a><!-- doxytag: member="manage.c::slave_socket" ref="a6d2317e3891c679166b479fcc2e285cf" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int* <a class="el" href="manage_8c.html#a6d2317e3891c679166b479fcc2e285cf">slave_socket</a> = NULL</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Slave socket. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l02058">2058</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="aca34079d27544a760cb51adfcdc47190"></a><!-- doxytag: member="manage.c::slave_ssh_credential_uuid" ref="aca34079d27544a760cb51adfcdc47190" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gchar* <a class="el" href="manage_8c.html#aca34079d27544a760cb51adfcdc47190">slave_ssh_credential_uuid</a> = NULL</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Slave credential UUID. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l02023">2023</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="a2c994225ecd6576517c5efaefc8bec18"></a><!-- doxytag: member="manage.c::slave_target_uuid" ref="a2c994225ecd6576517c5efaefc8bec18" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gchar* <a class="el" href="manage_8c.html#a2c994225ecd6576517c5efaefc8bec18">slave_target_uuid</a> = NULL</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Slave target UUID. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l02033">2033</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8d6c21512d60b5170ea6483bc993f197"></a><!-- doxytag: member="manage.c::slave_task_uuid" ref="a8d6c21512d60b5170ea6483bc993f197" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">gchar* <a class="el" href="manage_8c.html#a8d6c21512d60b5170ea6483bc993f197">slave_task_uuid</a> = NULL</td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Slave task UUID. </p>

<p>Definition at line <a class="el" href="manage_8c_source.html#l02043">2043</a> of file <a class="el" href="manage_8c_source.html">manage.c</a>.</p>

<p>Referenced by <a class="el" href="manage__sql_8c_source.html#l19450">delete_report_internal()</a>.</p>

</div>
</div>
</div>
<hr size="1"/><address style="text-align: right;"><small>Generated on 23 Oct 2015 for OpenVAS Manager by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.6.1 </small></address>
</body>
</html>
